---
layout:     post
title:      ã€PythonåŸºç¡€ã€‘ç¬¬åå…­è¯¾ï¼šé‡å¡‘èµ„æ–™
subtitle:   è™šæ‹Ÿå˜é‡ï¼ˆDummy Variableï¼‰ï¼Œå»ºç«‹é€è§†è¡¨ï¼ˆpivot_tableï¼‰ï¼Œé•¿å®½è¡¨æ ¼è½¬æ¢ï¼ˆstack&unstackï¼‰
date:       2020-09-25
author:     x-jeff
header-img: blogimg/20200925.jpg
catalog: true
tags:
    - Python Series
---
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.è™šæ‹Ÿå˜é‡ï¼ˆDummy Variableï¼‰

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹[æ•°æ®](https://github.com/x-jeff/Python_Code_Demo/blob/master/Demo14/house_price.csv)ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x1.png)

ğŸ‘‰å»ºç«‹è™šæ‹Ÿå˜é‡

```python
pandas.get_dummies(df["æœå‘"])
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x2.png)

ğŸ‘‰åˆå¹¶è™šæ‹Ÿå˜é‡ä¸åŸDataFrame

```python
df = pandas.concat([df, pd.get_dummies(df["æœå‘"])], axis=1)
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x3.png)

ğŸ‘‰èˆå¼ƒåŸæœ‰å­—æ®µ

```python
df = df.drop("æœå‘", axis=1)
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x4.png)

# 2.å»ºç«‹é€è§†è¡¨ï¼ˆpivot_tableï¼‰

```python
df2 = df.pivot_table(index="æ—¥æœŸ", columns="æˆ·å‹", values="æ€»ä»·", aggfunc='sum')
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x5.png)

è¿˜å¯ä»¥å¯¹`df2`åšè½¬ç½®`df2.T`ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x6.png)

æŠŠ`df2`ä¸­çš„`NaN`æ”¹ä¸º0ï¼Œä½¿ç”¨`fill_value`ï¼š

```python
df2 = df.pivot_table(index="æ—¥æœŸ", columns="æˆ·å‹", values="æ€»ä»·", aggfunc='sum', fill_value=0)
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x7.png)

`aggfunc`å¯èƒ½çš„å–å€¼ï¼š`'mean'`ã€`'sum'`ã€`'count'`ã€‚

# 3.é•¿å®½è¡¨æ ¼è½¬æ¢ï¼ˆstack&unstackï¼‰

ğŸ‘‰å»ºç«‹å¤šç´¢å¼•çš„é€è§†è¡¨

```python
df_multi_idx = df.pivot_table(index=["æ ‡é¢˜", "å»ºç­‘é¢ç§¯"], columns="æˆ·å‹", values="æ€»ä»·", aggfunc='sum')
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x8.png)

ğŸ‘‰è½¬æ¢ä¸ºå®½è¡¨æ ¼

```python
df_wide = df_multi_idx.unstack()
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x9.png)

ğŸ‘‰è½¬æ¢ä¸ºé•¿è¡¨æ ¼

```python
df_long = df_wide.stack()
```

![](https://github.com/x-jeff/BlogImage/raw/master/PythonSeries/Lesson16/16x10.png)

# 4.ä»£ç åœ°å€

1. [é‡å¡‘èµ„æ–™](https://github.com/x-jeff/Python_Code_Demo/tree/master/Demo16)