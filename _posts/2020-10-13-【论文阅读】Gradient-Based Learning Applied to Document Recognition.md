---
layout:     post
title:      ã€è®ºæ–‡é˜…è¯»ã€‘Gradient-Based Learning Applied to Document Recognition
subtitle:   å·ç§¯ç¥ç»ç½‘ç»œå¼€å±±ä¹‹ä½œï¼šLeNet-5
date:       2020-10-13
author:     x-jeff
header-img: blogimg/20201013.jpg
catalog: true
tags:
    - AI Papers
---  
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.INTRODUCTION

ä¼ ç»Ÿçš„æ¨¡å¼è¯†åˆ«ï¼ˆtraditional pattern recognitionï¼‰é€šå¸¸åˆ†ä¸ºä¸¤æ­¥ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/LeNet5/1.png)

å³ï¼š1ï¼‰ä»åŸå§‹æ•°æ®ä¸­æå–ç‰¹å¾ï¼›2ï¼‰ç”¨æå–çš„ç‰¹å¾è®­ç»ƒåˆ†ç±»å™¨ã€‚

åœ¨LeNet-5å‘è¡¨çš„é‚£ä¸ªå¹´ä»£ï¼Œæå–ç‰¹å¾éœ€è¦å¤§é‡çš„å…ˆéªŒçŸ¥è¯†ï¼Œå¹¶ä¸”éœ€è¦äººä¸ºè®¾è®¡ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶è€—åŠ›çš„å·¥ä½œã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåˆ†ç±»å™¨çš„ç²¾åº¦ä¹Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ°æ‰€æå–çš„ç‰¹å¾çš„å½±å“ã€‚å› æ­¤ï¼Œé‚£ä¸ªæ—¶å€™çš„è®ºæ–‡å¤§éƒ½åœ¨è®¨è®ºä¸åŒç‰¹å¾é›†ä¹‹é—´çš„ä¼˜åŠ£ã€‚

éšç€æ—¶ä»£çš„å‘å±•ï¼Œå› ä¸ºæ•°æ®é‡çš„å¢å¤šå’Œæœºå™¨å­¦ä¹ æŠ€æœ¯çš„è¿›æ­¥ç­‰åŸå› ï¼Œä½¿å¾—å¤šå±‚ç¥ç»ç½‘ç»œå¯ä»¥ç”¨æ¥è§£å†³æ¨¡å¼è¯†åˆ«é—®é¢˜ï¼Œä¾‹å¦‚è¯­éŸ³æˆ–æ‰‹å†™æ–‡å­—çš„è¯†åˆ«ã€‚è¿™æ ·å°±é¿å…äº†äººä¸ºé€‰æ‹©ç‰¹å¾è¿™ä¸€ç¹ççš„å·¥ä½œï¼Œç‰¹å¾çš„é€‰æ‹©ç”±ç½‘ç»œè‡ªè¡Œå®Œæˆï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å°†åŸå§‹æ•°æ®ï¼ˆæˆ–ç¨åšç®€å•å¤„ç†ï¼‰ç›´æ¥ä½œä¸ºç½‘ç»œçš„è¾“å…¥ã€‚

å› æ­¤è¯¥è®ºæ–‡æå‡ºäº†ä¸€ç§åŸºäºå¤šå±‚ç¥ç»ç½‘ç»œçš„æ‰‹å†™æ•°å­—è¯†åˆ«æ¨¡å‹ï¼ˆè§æœ¬åšå®¢ç¬¬2éƒ¨åˆ†ï¼‰ã€‚

>æœ¬åšå®¢ä¸»è¦ä»‹ç»æ–‡ç« çš„I,II.Béƒ¨åˆ†ï¼Œå…¶ä¸­II.Béƒ¨åˆ†æœ€ä¸ºé‡è¦ï¼Œè¯¦ç»†æè¿°äº†LeNet-5çš„å®ç°ã€‚æ–‡ç« çš„åå‡ éƒ¨åˆ†å±äºè¿›ä¸€æ­¥çš„å»¶ä¼¸å†…å®¹ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œé˜…è¯»åŸæ–‡ï¼ˆåŸæ–‡é“¾æ¥è§æœ¬æ–‡æœ«å°¾ï¼‰ï¼Œæœ¬åšå®¢ä¸å†èµ˜è¿°ã€‚
>
>æ­¤å¤–ï¼Œè®ºæ–‡ä¸­å«æœ‰å¤§é‡å¯¹åŸºç¡€æ¦‚å¿µçš„è§£é‡Šï¼Œä¾‹å¦‚loss functionã€æ¢¯åº¦ã€å·ç§¯ç­‰ï¼Œåœ¨æ­¤ä¹Ÿä¸å†èµ˜è¿°ã€‚æœ‰ä¸äº†è§£çš„å¯åœ¨æœ¬ç«™é˜…è¯»ã€æ·±åº¦å­¦ä¹ åŸºç¡€ã€‘ç³»åˆ—åšå®¢ã€‚

# 2.LeNet-5

## 2.1.è¯¦ç»†ç»“æ„

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/LeNet5/2.png)

LeNet-5ä¸ç®—è¾“å…¥å±‚ï¼Œä¸€å…±æœ‰7å±‚ã€‚å·ç§¯å±‚ç”¨$C_x$è¡¨ç¤ºï¼Œä¸‹é‡‡æ ·å±‚ç”¨$S_x$è¡¨ç¤ºï¼Œå…¨è¿æ¥å±‚ç”¨$F_x$è¡¨ç¤ºï¼Œå…¶ä¸­$x$ä¸ºå±‚æ•°ã€‚

>ä½†æ˜¯ä¸‹é‡‡æ ·å±‚é€šå¸¸ä¸ç®—åœ¨å†…ï¼Œå› æ­¤ä¸€å…±æ˜¯æœ‰5å±‚ï¼Œæ‰€ä»¥ç§°ä¸ºLeNet-5ã€‚
>
>ç¥ç»ç½‘ç»œå±‚æ•°çš„è®¡ç®—ï¼š[ã€æ·±åº¦å­¦ä¹ åŸºç¡€ã€‘ç¬¬å…­è¯¾ï¼šæµ…å±‚ç¥ç»ç½‘ç»œ](http://shichaoxin.com/2019/12/03/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬å…­è¯¾-æµ…å±‚ç¥ç»ç½‘ç»œ/#1ç¥ç»ç½‘ç»œè¡¨ç¤º)ã€‚

ğŸ‘‰ã€INPUTã€‘

è¾“å…¥å¤§å°ä¸º$32 \times 32 \times 1$çš„ç°åº¦å›¾åƒï¼Œå¯¹è¾“å…¥åšæ ‡å‡†åŒ–ï¼ˆnormalizedï¼‰å¤„ç†ï¼Œå°†åƒç´ å€¼æ ‡å‡†åŒ–è‡³$[-1,1.175]$ï¼Œä½¿å¾—åƒç´ å€¼çš„å‡å€¼å¤§çº¦ä¸º0ï¼Œæ–¹å·®å¤§çº¦ä¸º1ï¼Œè¿™æ ·å¯ä»¥åŠ é€Ÿå­¦ä¹ ã€‚

ğŸ‘‰ã€$C_1$ã€‘

ä½¿ç”¨çš„å·ç§¯æ ¸å¤§å°ä¸º$5 \times 5 \times 1$ï¼Œæ•°é‡ä¸º6ï¼Œæ­¥é•¿ä¸º1ï¼ˆLeNet-5è¢«åˆ›ä½œçš„é‚£ä¸ªå¹´ä»£ï¼Œäººä»¬ä¸ä½¿ç”¨paddingï¼‰ã€‚å¾—åˆ°çš„feature mapçš„ç»´åº¦ä¸º$28\times 28$ï¼Œfeature mapçš„æ•°é‡ä¸º6ã€‚æœ¬å±‚å…±åŒ…å«156ä¸ªå‚æ•°ï¼š$5\times 5\times 1\times 6+6=156$ã€‚æœ¬å±‚å…±æœ‰122304æ¬¡è¿æ¥ï¼ˆconnectionï¼‰ï¼š$5\times 5\times 28\times 28\times 6+28\times 28\times 6=122304$ã€‚

ğŸ‘‰ã€$S_2$ã€‘

è¿™é‡Œçš„ä¸‹é‡‡æ ·å±‚ç±»ä¼¼äºæˆ‘ä»¬ç°åœ¨çš„poolingå±‚ï¼Œä½†æ˜¯åšæ³•ç¨æœ‰ä¸åŒã€‚æœ¬å±‚æ‰€ç”¨çš„æ ¸å¤§å°ä¸º$2\times 2$ï¼ˆæ­¥é•¿ä¸º2ï¼‰ï¼Œå› æ­¤å¾—åˆ°çš„feature mapä¸º$14\times 14\times 6$ã€‚å¸¸è§çš„poolingå±‚æ˜¯ç›´æ¥å–æœ€å¤§å€¼æˆ–è€…å¹³å‡ï¼Œè€Œè¿™é‡Œçš„$S_2$æ˜¯å…ˆå°†å››ä¸ªæ ¼å­ï¼ˆ$2\times 2$ï¼‰çš„è¾“å…¥æ±‚å’Œï¼ˆzï¼‰ï¼Œç„¶åä¹˜ä¸Šä¸€ä¸ªç³»æ•°ï¼ˆwï¼‰ï¼Œå†åŠ ä¸Šä¸€ä¸ªåç½®å€¼ï¼ˆbï¼‰ï¼Œæœ€åé€šè¿‡sigmoidå‡½æ•°ï¼ˆå³$sigmoid(wz+b)$ï¼‰ã€‚å³ç›¸å½“äºaverage poolingï¼ˆåªä¸è¿‡è¿™é‡Œæ˜¯åŠ æƒå¹³å‡ï¼‰ä¹‹åé€šè¿‡ä¸€ä¸ªsigmoidæ¿€æ´»å‡½æ•°ã€‚æœ¬å±‚ä¸€å…±æœ‰12ä¸ªå‚æ•°ï¼š6ä¸ª$2\times 2$çš„æ ¸ï¼Œæ¯ä¸ªæ ¸æœ‰2ä¸ªå‚æ•°ï¼ˆw,bï¼‰ï¼Œæ‰€ä»¥æœ‰$6\times 2=12$ã€‚æœ¬å±‚ä¸€å…±æœ‰5880æ¬¡è¿æ¥ï¼š$14\times 14\times 5\times 6=5880$ã€‚è§£é‡Šä¸‹å¼å­é‡Œçš„5ï¼Œå‡è®¾å››ä¸ªæ ¼å­é‡Œçš„å€¼åˆ†åˆ«ä¸º$x_1,x_2,x_3,x_4$ï¼Œä¸€æ¬¡ä¸‹é‡‡æ ·ä¸º$w\times (x_1+x_2+x_3+x_4)+b$ï¼Œåˆšå¥½æ˜¯5æ¬¡è¿æ¥ã€‚

ğŸ‘‰ã€$C_3$ã€‘

ä½¿ç”¨çš„å·ç§¯æ ¸æ•°é‡ä¸º16ã€‚å¦‚æœæƒ³è¦å¾—åˆ°$10\times 10\times 16$çš„feature mapï¼ŒæŒ‰ç…§ç°åœ¨æ™®éçš„åšæ³•ï¼Œæ¯ä¸ªå·ç§¯æ ¸çš„å¤§å°åº”è¯¥ä¸º$5\times 5\times 6$ï¼ˆæ­¥é•¿ä¸º1ï¼‰ï¼Œä½†æ˜¯LeNet-5å¹¶ä¸æ˜¯è¿™ä¹ˆåšçš„ã€‚åœ¨LeNet-5ä¸­ï¼Œæ¯ä¸ªå·ç§¯æ ¸çš„å¤§å°å¹¶ä¸å®Œå…¨ä¸€æ ·ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/LeNet5/3.png)

ä¸Šå›¾ä¸­ï¼Œæ¯ä¸€åˆ—å¯ä»¥çœ‹æˆæ¯ä¸€ä¸ªå·ç§¯æ ¸ï¼ˆä¸€å…±16ä¸ªï¼‰ï¼Œæ¯ä¸€è¡Œä¸º$S_2$å±‚çš„æ¯ä¸€ä¸ªfeature mapï¼ˆä¸€å…±6ä¸ªï¼‰ã€‚ä»¥ç¬¬0åˆ—ä¸ºä¾‹ï¼šç¬¬0ä¸ªå·ç§¯æ ¸åªå’Œ$S_2$å±‚çš„å‰3ä¸ªfeature mapè¿›è¡Œäº†å·ç§¯è¿ç®—ï¼Œå› æ­¤è¯¥å·ç§¯æ ¸å¤§å°åº”è¯¥ä¸º$5\times 5\times 3$ã€‚å› æ­¤è¯¥å±‚çš„å‚æ•°æ•°é‡ä¸ºï¼š$5\times 5\times 3\times 6+5\times 5\times 4\times 9+5\times 5\times 6\times 1+16=1516$ã€‚

æ€»çš„è¿æ¥æ•°ï¼ˆ$150000+6000=156000$ï¼‰ï¼š

* å·ç§¯éƒ¨åˆ†ï¼š$5\times 5\times 3\times 6\times 10\times 10+5\times 5\times 4\times 9\times 10\times 10+5\times 5\times 6\times 1\times 10\times 10=150000$
* åç½®é¡¹éƒ¨åˆ†ï¼š$3\times 6\times 10\times 10+4\times 9\times 10\times 10+6\times 1\times 10\times 10=6000$ï¼ˆä¸€ä¸ª$5\times 5\times 3$çš„å·ç§¯æ ¸è¿›è¡Œä¸€æ¬¡å·ç§¯è¿ç®—ï¼Œä¼šè¿›è¡Œ3æ¬¡åç½®é¡¹çš„åŠ æ³•è¿ç®—ï¼Œä½†æ˜¯è¿™ä¸‰æ¬¡åŠ æ³•è¿ç®—ä½¿ç”¨çš„åç½®é¡¹æ˜¯åŒä¸€ä¸ªï¼‰

è¯¥å±‚æœ€ç»ˆå¾—åˆ°$10\times 10\times 16$çš„feature mapã€‚

ğŸ‘‰ã€$S_4$ã€‘

å’Œ$S_2$å±‚ä¸€æ ·ã€‚ä½¿ç”¨$2\times 2\times 16$çš„æ ¸ï¼ˆæ­¥é•¿ä¸º2ï¼‰ï¼Œå¾—åˆ°çš„feature mapä¸º$5\times 5\times 16$ã€‚å¯è®­ç»ƒçš„å‚æ•°æ•°é‡ä¸ºï¼š$2\times 16=32$ã€‚æ€»çš„è¿æ¥æ•°ä¸ºï¼š$5\times 5\times 5\times 16=2000$ã€‚

ğŸ‘‰ã€$C_5$ã€‘

å·ç§¯æ ¸å…±120ä¸ªï¼Œå¤§å°ä¸º$5\times 5\times 16$ã€‚å¾—åˆ°çš„feature mapä¸º$1\times 1\times 120$ã€‚å‚æ•°æ•°é‡ï¼š$5\times 5\times 16\times 120+120=48120$ã€‚è¿™ä¸€å±‚ç›¸å½“äºå°±æ˜¯$S_4$å’Œ$C_5$ä¹‹é—´çš„å…¨è¿æ¥ã€‚ä¹‹æ‰€ä»¥æ²¡æœ‰æŠŠ$C_5$å‘½åä¸ºå…¨è¿æ¥å±‚$F_5$ï¼Œæ˜¯å› ä¸ºå¦‚æœå…¶ä»–æ¡ä»¶éƒ½ä¸å˜ï¼Œåªæ˜¯å¢å¤§è¾“å…¥çš„ç»´åº¦ï¼Œé‚£ä¹ˆ$C_5$å¾—åˆ°çš„feature mapçš„ç»´åº¦ä¼šå¤§äº$1\times 1$ã€‚

ğŸ‘‰ã€$F_6$ã€‘

å«æœ‰84ä¸ªç¥ç»å…ƒçš„å…¨è¿æ¥å±‚ã€‚å‚æ•°æ•°é‡ï¼š$84\times 120+84=10164$ã€‚$
F_6$å±‚åŠä¹‹å‰å±‚çš„æ¿€æ´»å‡½æ•°ä¸ºtanhå‡½æ•°ï¼Œè¯¦ç»†å½¢å¼è§ä¸‹ï¼š

$$f(a)=A tanh(Sa)$$

æ­¤å¤„å¤šäº†ä¸¤ä¸ªè¶…å‚æ•°ï¼šAå’ŒSã€‚Aæ§åˆ¶tanhå‡½æ•°çš„æŒ¯å¹…ï¼Œå³f(a)çš„å–å€¼èŒƒå›´åœ¨-Aåˆ°+Aä¹‹é—´ã€‚è®ºæ–‡ä¸­è®¾A=1.7159ã€‚Sæ§åˆ¶tanhå‡½æ•°åœ¨åŸç‚¹å¤„çš„æ–œç‡ï¼ˆå€¾æ–œç¨‹åº¦ï¼‰ï¼Œè®ºæ–‡ä¸­è®¾S=2/3ã€‚

å°†$F_6$å±‚è®¾ç½®ä¸º84ä¸ªç¥ç»å…ƒçš„åŸå› ï¼šæ ‡å‡†çš„å­—ç¬¦æ¯”ç‰¹å›¾ï¼ˆbitmapï¼‰æ˜¯$7\times 12$åƒç´ çš„ï¼Œå…±æœ‰$16\times 6$ä¸ªæ ‡å‡†çš„å­—ç¬¦æ¯”ç‰¹å›¾ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/LeNet5/4.png)

$F_6$å±‚ä¸­84ä¸ªç¥ç»å…ƒçš„å€¼åªæœ‰-1ï¼ˆç™½è‰²ï¼‰æˆ–+1ï¼ˆé»‘è‰²ï¼‰ä¸¤ç§é€‰æ‹©ï¼Œå› æ­¤è¿™84ä¸ªç¥ç»å…ƒä¾¿å¯çœ‹ä½œä¸€ä¸ª$7\times 12$åƒç´ çš„æ¯”ç‰¹å›¾ï¼Œç„¶åè®¡ç®—è¯¥æ¯”ç‰¹å›¾å’Œä¸Šå›¾ä¸­æ ‡å‡†çš„å­—ç¬¦æ¯”ç‰¹å›¾çš„æ¥è¿‘ç¨‹åº¦ï¼Œæœ€æ¥è¿‘å“ªä¸ªå­—ç¬¦æ¯”ç‰¹å›¾ï¼Œé¢„æµ‹ç»“æœä¾¿å¯åˆ¤å®šä¸ºè¯¥å­—ç¬¦ã€‚

>å› æ­¤LeNet-5ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹è¾“å‡ºå±‚ä½¿å…¶å¯ä»¥é¢„æµ‹æ‰€æœ‰çš„ä¸Šè¿°å­—ç¬¦ï¼Œè€Œä¸ä»…ä»…åªæ˜¯é¢„æµ‹æ•°å­—ã€‚

ğŸ‘‰ã€OUTPUTã€‘

è¾“å‡ºå±‚å…±æœ‰10ä¸ªç¥ç»å…ƒï¼Œåˆ†åˆ«è¡¨ç¤ºæ•°å­—0~9ã€‚ä½¿ç”¨å¾„å‘åŸºå‡½æ•° (Radial Basis Function ç®€ç§° RBF)ã€‚æ¯ä¸ªç¥ç»å…ƒçš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š

$$y_i=\sum_j(x_j-w_{ij})^2$$

å…¬å¼å«ä¹‰å›¾è§£è§ä¸‹ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/LeNet5/5.png)

æƒé‡çŸ©é˜µå¤§å°ä¸º$84 \times 10$ï¼Œæ¯ä¸€è¡Œä¸ºä¸€ä¸ªå­—ç¬¦æ¯”ç‰¹å›¾ï¼Œå…±10è¡Œï¼ˆ0-9ï¼‰ã€‚ä¸Šå¼çš„æ„ä¹‰å…¶å®å°±æ˜¯ç›¸å½“äºå°†$F_6$å±‚é¢„æµ‹å‡ºæ¥çš„$7 \times 12 =84$åƒç´ çš„æ¯”ç‰¹å›¾ä¸æ ‡å‡†çš„0-9å­—ç¬¦æ¯”ç‰¹å›¾åšæ¯”è¾ƒï¼Œæ±‚å…¶å¯¹åº”ä½ç½®ä¸Šåƒç´ å€¼çš„å‡æ–¹è¯¯å·®ã€‚

## 2.2.é¢„æµ‹æµç¨‹

LeNet-5å®Œæ•´çš„é¢„æµ‹æµç¨‹ï¼ˆä»¥æ•°å­—â€œ3â€ä¸ºä¾‹ï¼Œè¾“å‡ºå±‚vectorä¸º1110111111ï¼‰ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/LeNet5/6.png)

## 2.3.loss function

ä½¿ç”¨å‡æ–¹è¯¯å·®æˆ–è€…äº¤å‰ç†µæŸå¤±å‡½æ•°å‡å¯ã€‚

# 3.åŸæ–‡é“¾æ¥

ğŸ‘½[Gradient-Based Learning Applied to Document](https://github.com/x-jeff/AI_Papers/blob/master/Gradient-Based%20Learning%20Applied%20to%20Document.pdf)

# 4.å‚è€ƒèµ„æ–™

1. [æ·±åº¦å­¦ä¹  --- å·ç§¯ç¥ç»ç½‘ç»œCNNï¼ˆLeNet-5ç½‘ç»œè¯¦è§£ï¼‰](https://blog.csdn.net/weixin_42398658/article/details/84392845)
