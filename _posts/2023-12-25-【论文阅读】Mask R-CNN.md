---
layout:     post
title:      ã€è®ºæ–‡é˜…è¯»ã€‘Mask R-CNN
subtitle:   Mask R-CNN
date:       2023-12-25
author:     x-jeff
header-img: blogimg/20200520.jpg
catalog: true
tags:
    - AI Papers
---  
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.Introduction

æˆ‘ä»¬æå‡ºçš„ç”¨äºå®ä¾‹åˆ†å‰²çš„æ–¹æ³•å«åšMask R-CNNï¼Œå…¶é€šè¿‡åœ¨[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)ä¸Šæ–°æ·»åŠ ä¸€ä¸ªä¸ç±»åˆ«åˆ†æ”¯å’Œbounding boxå›å½’åˆ†æ”¯å¹³è¡Œçš„ä¸€ä¸ªmaskåˆ†æ”¯ï¼Œç”¨äºåœ¨æ¯ä¸ªRoIä¸Šé¢„æµ‹åˆ†å‰²maskï¼Œè§Fig1ã€‚maskåˆ†æ”¯æ˜¯åº”ç”¨åœ¨æ¯ä¸ªRoIä¸Šçš„ä¸€ä¸ªå°å‹[FCN](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/)ï¼Œé€šè¿‡pixel-to-pixelçš„æ–¹å¼é¢„æµ‹åˆ†å‰²maskã€‚æ­¤å¤–ï¼Œmaskåˆ†æ”¯åªå¢åŠ äº†å¾ˆå°çš„è®¡ç®—å¼€é”€ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/1.png)

æ­£ç¡®æ„å»ºmaskåˆ†æ”¯å¯¹äºè·å¾—è‰¯å¥½ç»“æœè‡³å…³é‡è¦ã€‚å› ä¸º[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)è®¾è®¡çš„åˆè¡·å¹¶æ²¡æœ‰è€ƒè™‘è¾“å…¥å’Œè¾“å‡ºåœ¨pixel-to-pixelçº§åˆ«ä¸Šçš„å¯¹é½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æå‡ºäº†RoIAlignç”¨äºè·å–ç²¾ç¡®çš„ç©ºé—´ä½ç½®ã€‚å°½ç®¡RoIAlignåªæ˜¯ä¸€ä¸ªå¾®å°çš„æ”¹å˜ï¼Œä½†å…¶æœ‰ç€å·¨å¤§çš„å½±å“ï¼šå…¶å°†maskç²¾åº¦æé«˜äº†10%-50%ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å‘ç°å°†maské¢„æµ‹å’Œç±»åˆ«é¢„æµ‹è§£è€¦æ˜¯éå¸¸é‡è¦çš„ã€‚

åœ¨COCOå®ä¾‹åˆ†å‰²ä»»åŠ¡ä¸Šï¼ŒMask R-CNNè¶…è¿‡äº†ä»¥å‰æ‰€æœ‰çš„SOTAæ¨¡å‹ã€‚æ­¤å¤–ï¼ŒMask R-CNNä¹Ÿæ“…é•¿COCOç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥åœ¨GPUä¸Šä»¥æ¯å¸§200msçš„é€Ÿåº¦è¿è¡Œï¼Œä½¿ç”¨8å—GPUåœ¨COCOæ•°æ®é›†ä¸Šè®­ç»ƒéœ€è¦ä¸€åˆ°ä¸¤å¤©çš„æ—¶é—´ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜åœ¨COCOå…³é”®ç‚¹æ£€æµ‹ä»»åŠ¡ä¸Šå±•ç¤ºäº†æˆ‘ä»¬æ¡†æ¶çš„é€šç”¨æ€§ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/2.png)

# 2.Related Work

ä¸å†è¯¦è¿°ã€‚

# 3.Mask R-CNN

[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)å¯¹æ¯ä¸ªå€™é€‰ç›®æ ‡æœ‰ä¸¤ä¸ªè¾“å‡ºï¼šä¸€ä¸ªç±»åˆ«æ ‡ç­¾å’Œä¸€ä¸ªbounding box offsetï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬æ·»åŠ äº†ç¬¬ä¸‰ä¸ªåˆ†æ”¯ï¼Œç”¨äºè¾“å‡ºç›®æ ‡maskã€‚

ğŸ‘‰**Faster R-CNN:**

å‚è§ï¼š[Faster R-CNNï¼šTowards Real-Time Object Detection with Region Proposal Networks](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)ã€‚

ğŸ‘‰**Mask R-CNN:**

Mask R-CNNåŒæ ·ä¹Ÿæ˜¯two-stageï¼Œç¬¬ä¸€ä¸ªstageä¹Ÿæ˜¯RPNã€‚åœ¨ç¬¬äºŒä¸ªstageï¼Œå¹³è¡Œäºé¢„æµ‹ç±»åˆ«å’Œbox offsetçš„åˆ†æ”¯ï¼ŒMask R-CNNå¯¹æ¯ä¸ªRoIå¤šè¾“å‡ºäº†ä¸€ä¸ªäºŒå€¼maskã€‚è€Œè®¸å¤šä¸»æµçš„ç®—æ³•ï¼Œåˆ†ç±»éœ€è¦å–å†³äºmaskçš„é¢„æµ‹ç»“æœã€‚

åœ¨è®­ç»ƒé˜¶æ®µï¼Œå¯¹æ¯ä¸ªRoIï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¤šä»»åŠ¡lossï¼š$L = L_{cls} + L_{box} + L_{mask}$ã€‚å…¶ä¸­ï¼Œ$L_{cls}$å’Œ$L_{box}$çš„å®šä¹‰å’Œ[Fast R-CNN](http://shichaoxin.com/2022/03/07/è®ºæ–‡é˜…è¯»-Fast-R-CNN/#23fine-tuning-for-detection)ä¸­ä¸€æ ·ã€‚maskåˆ†æ”¯å¯¹æ¯ä¸ªRoIè¾“å‡ºçš„ç»´åº¦ä¸º$Km^2$ï¼Œå³$K$ä¸ªåˆ†è¾¨ç‡ä¸º$m \times m$çš„äºŒå€¼maskï¼Œ$K$è¡¨ç¤ºç±»åˆ«æ•°ã€‚$L_{mask}$æ˜¯åƒç´ çº§åˆ«çš„[äº¤å‰ç†µæŸå¤±å‡½æ•°](http://shichaoxin.com/2019/09/04/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬äºŒè¯¾-softmaxåˆ†ç±»å™¨å’Œäº¤å‰ç†µæŸå¤±å‡½æ•°/#3äº¤å‰ç†µæŸå¤±å‡½æ•°)ã€‚å‡è®¾RoIçš„çœŸå®ç±»åˆ«æ˜¯$k$ï¼Œé‚£ä¹ˆ$L_{mask}$å°±åªå®šä¹‰ä¸º$k$ç±»åˆ«çš„maskï¼ˆå…¶ä»–ç±»åˆ«çš„è¾“å‡ºå¯¹lossä¸èµ·ä½œç”¨ï¼‰ã€‚

æˆ‘ä»¬è§£è€¦äº†maské¢„æµ‹å’Œç±»åˆ«é¢„æµ‹ï¼ˆåœ¨ä¸¤ä¸ªä¸åŒçš„åˆ†æ”¯ï¼‰ï¼Œè¿™æœ‰åŠ©äºè·å¾—è‰¯å¥½çš„å®ä¾‹åˆ†å‰²ç»“æœã€‚

ğŸ‘‰**Mask Representation:**

æˆ‘ä»¬ä½¿ç”¨[FCN](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/)ä»æ¯ä¸ªRoIé¢„æµ‹ä¸€ä¸ª$m \times m$çš„maskã€‚

ğŸ‘‰**RoIAlign:**

åœ¨[Fast R-CNN](http://shichaoxin.com/2022/03/07/è®ºæ–‡é˜…è¯»-Fast-R-CNN/#21the-roi-pooling-layer)ä¸­ï¼Œé’ˆå¯¹æ¯ä¸ªRoIï¼Œä½¿ç”¨RoIPoolå°†RoIæå–ä¸ºä¸€ä¸ªå°çš„feature mapï¼ˆæ¯”å¦‚$7\times 7$ï¼‰ã€‚RoIPoolé€šå¸¸æ˜¯å°†RoIç»†åˆ†ä¸ºå¤šä¸ªspatial binï¼ˆæ¯”å¦‚åˆ†æˆ$7 \times 7$ä¸ªbinï¼‰ï¼Œç„¶åå¯¹æ¯ä¸ªbinè¿›è¡Œç‰¹å¾å€¼çš„èšåˆï¼ˆæ¯”å¦‚é€šè¿‡max poolingçš„æ–¹å¼èšåˆï¼‰ã€‚è¿™ç§é‡åŒ–å¯¼è‡´äº†RoIå’Œæå–åˆ°çš„ç‰¹å¾ä¹‹é—´æ²¡æœ‰å¯¹é½ã€‚è™½ç„¶è¿™å¯¹åˆ†ç±»æ¥è¯´å¯èƒ½å½±å“ä¸å¤§ï¼Œä½†å®ƒå¯¹é¢„æµ‹maskæœ‰å¾ˆå¤§çš„è´Ÿé¢å½±å“ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†RoIAlignå±‚ï¼Œè§Fig3ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/3.png)

Fig3ä¸­ï¼Œè™šçº¿ç½‘æ ¼è¡¨ç¤ºfeature mapï¼Œå®çº¿è¡¨ç¤ºRoIï¼ˆæœ¬ä¾‹ä¸­ä¸º$2 \times 2$ä¸ªbinï¼‰ï¼Œæ¯ä¸ªbinå†…æœ‰4ä¸ªé‡‡æ ·ç‚¹ï¼Œæ¯ä¸ªé‡‡æ ·ç‚¹çš„å€¼å¯ä»¥é€šè¿‡åŒçº¿æ€§æ’å€¼ä»feature mapä¸Šçš„é™„è¿‘ç½‘æ ¼ç‚¹è®¡ç®—å¾—åˆ°ï¼Œç„¶åå†å¯¹è¿™äº›é‡‡æ ·ç‚¹è¿›è¡Œèšåˆï¼ˆä½¿ç”¨æœ€å¤§å€¼æˆ–å¹³å‡å€¼ï¼‰ã€‚è¿™æ ·å°±é¿å…äº†é‡åŒ–ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåªè¦ä¸è¿›è¡Œé‡åŒ–ï¼Œæœ€ç»ˆç»“æœå¯¹é‡‡æ ·ç‚¹çš„ä½ç½®å’Œæ•°é‡å¹¶ä¸æ•æ„Ÿã€‚

ğŸ‘‰**Network Architecture:**

å°†Mask R-CNNä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š(i)backboneï¼Œç”¨äºåœ¨æ•´ä¸ªå›¾åƒä¸Šæå–ç‰¹å¾ï¼›(ii)headï¼Œå¯¹æ¯ä¸ªRoIè¿›è¡Œç±»åˆ«é¢„æµ‹ã€bounding boxå›å½’ä»¥åŠmaské¢„æµ‹ã€‚

backboneçš„å‘½åæ–¹å¼ä¸ºnetwork-depth-featuresï¼Œæ¯”å¦‚åŸå§‹çš„[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)çš„backboneä¸ºResNet-50-C4ï¼ŒC4è¡¨ç¤ºbackboneæå–åˆ°çš„ç‰¹å¾æ¥è‡ªResNet-50çš„ç¬¬å››ä¸ªstageã€‚æˆ‘ä»¬æµ‹è¯•äº†[ResNet](http://shichaoxin.com/2022/01/07/è®ºæ–‡é˜…è¯»-Deep-Residual-Learning-for-Image-Recognition/)å’Œ[ResNeXt](http://shichaoxin.com/2023/12/11/è®ºæ–‡é˜…è¯»-Aggregated-Residual-Transformations-for-Deep-Neural-Networks/)ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°è¯•äº†ä½¿ç”¨[ResNet-FPN](http://shichaoxin.com/2023/12/19/è®ºæ–‡é˜…è¯»-Feature-Pyramid-Networks-for-Object-Detection/)ä½œä¸ºbackboneï¼Œåœ¨ç²¾åº¦å’Œé€Ÿåº¦æ–¹é¢éƒ½å¾—åˆ°äº†å¤§å¹…æé«˜ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/4.png)

headçš„ç»“æ„è§Fig4ã€‚Fig4å·¦çš„backboneæ˜¯ResNet C4ï¼ŒFig4å³çš„backboneæ˜¯FPNï¼ˆå·²ç»åŒ…å«"res5"ï¼‰ã€‚æ•°å­—è¡¨ç¤ºçš„æ˜¯ç©ºé—´åˆ†è¾¨ç‡å’Œé€šé“æ•°ã€‚ç®­å¤´è¡¨ç¤ºå·ç§¯å±‚ã€åå·ç§¯å±‚æˆ–FCå±‚ã€‚è¾“å‡ºå±‚çš„å·ç§¯æ ¸å¤§å°ä¸º$1\times 1$ï¼Œå…¶ä½™å·ç§¯å±‚çš„å·ç§¯æ ¸å¤§å°éƒ½ä¸º$3 \times 3$ï¼Œåå·ç§¯å±‚çš„æ ¸å¤§å°ä¸º$2 \times 2$ï¼ˆæ­¥é•¿ä¸º2ï¼‰ï¼Œåœ¨éšè—å±‚ä¸­æˆ‘ä»¬ä½¿ç”¨ReLUå‡½æ•°ã€‚Fig4å·¦çš„"res5"è¡¨ç¤ºResNetçš„ç¬¬5ä¸ªstageã€‚Fig4å³çš„"x4"è¡¨ç¤ºè¿ç»­4ä¸ªå·ç§¯å±‚ã€‚

## 3.1.Implementation Details

æˆ‘ä»¬å¯¹è¶…å‚æ•°çš„è®¾ç½®éµå¾ª[Fast R-CNN](http://shichaoxin.com/2022/03/07/è®ºæ–‡é˜…è¯»-Fast-R-CNN/)å’Œ[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)ã€‚å°½ç®¡è¿™äº›è¶…å‚æ•°åœ¨åŸè®ºæ–‡ä¸­éƒ½æ˜¯ä¸ºç›®æ ‡æ£€æµ‹ä»»åŠ¡è®¾ç½®çš„ï¼Œä½†æˆ‘ä»¬å‘ç°å…¶å¯¹å®ä¾‹åˆ†å‰²ä»»åŠ¡ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚

ğŸ‘‰**Training:**

å’Œ[Fast R-CNN](http://shichaoxin.com/2022/03/07/è®ºæ–‡é˜…è¯»-Fast-R-CNN/)ä¸€æ ·ï¼Œå¦‚æœRoIå’ŒGTçš„IoUè¶…è¿‡0.5ï¼Œåˆ™è§†ä¸ºæ­£æ ·æœ¬ï¼Œå¦åˆ™ä¸ºè´Ÿæ ·æœ¬ã€‚$L_{mask}$åªå®šä¹‰åœ¨æ­£æ ·æœ¬RoIä¸Šã€‚

è¾“å…¥å›¾åƒè¢«resizeåˆ°çŸ­è¾¹ä¸º800ä¸ªåƒç´ ã€‚æ¯å—GPUçš„æ¯ä¸ªmini-batchå†…æœ‰2å¼ å›¾åƒï¼Œæ¯å¼ å›¾åƒæœ‰$N$ä¸ªRoIï¼ŒRoIæ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹ä¸º$1:3$ã€‚å½“backboneä¸ºC4æ—¶ï¼Œ$N=64$ï¼›å½“backboneä¸º[FPN](http://shichaoxin.com/2023/12/19/è®ºæ–‡é˜…è¯»-Feature-Pyramid-Networks-for-Object-Detection/)æ—¶ï¼Œ$N=512$ã€‚æˆ‘ä»¬åœ¨8å—GPUï¼ˆç›¸å½“äºmini-batch size=16ï¼‰ä¸Šè®­ç»ƒäº†160kæ¬¡è¿­ä»£ï¼Œåˆå§‹å­¦ä¹ ç‡ä¸º0.02ï¼Œåœ¨ç¬¬120kæ¬¡è¿­ä»£æ—¶ï¼Œå­¦ä¹ ç‡ç¼©å°10å€ã€‚weight decay=0.0001ï¼Œmomentum=0.9ã€‚å½“ä½¿ç”¨[ResNeXt](http://shichaoxin.com/2023/12/11/è®ºæ–‡é˜…è¯»-Aggregated-Residual-Transformations-for-Deep-Neural-Networks/)æ—¶ï¼Œæ¯å—GPUè®­ç»ƒ1å¼ å›¾åƒï¼Œè¿­ä»£æ¬¡æ•°ä¸å˜ï¼Œåˆå§‹å­¦ä¹ ç‡ä¸º0.01ã€‚

å’Œ[FPN](http://shichaoxin.com/2023/12/19/è®ºæ–‡é˜…è¯»-Feature-Pyramid-Networks-for-Object-Detection/)ä¸­ä¸€æ ·ï¼ŒRPN anchoræœ‰5ç§å°ºåº¦å’Œ3ç§é•¿å®½æ¯”ã€‚ä¸ºäº†æ–¹ä¾¿è¿›è¡Œæ¶ˆèå®éªŒï¼ŒRPNæ˜¯å•ç‹¬è®­ç»ƒçš„ï¼Œä¸å’ŒMask R-CNNå…±äº«ç‰¹å¾ã€‚ä½†å…¶backboneéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ˜¯å¯ä»¥å…±äº«ç‰¹å¾çš„ã€‚

ğŸ‘‰**Inference:**

åœ¨æ¨ç†é˜¶æ®µï¼ŒC4 backboneçš„proposalæ•°é‡ä¸º300ï¼›[FPN](http://shichaoxin.com/2023/12/19/è®ºæ–‡é˜…è¯»-Feature-Pyramid-Networks-for-Object-Detection/) backboneçš„proposalæ•°é‡ä¸º1000ã€‚bounding boxåˆ†æ”¯åœ¨è¿™äº›proposalä¸Šè¿è¡Œï¼Œå¹¶ä½¿ç”¨äº†NMSã€‚maskåˆ†æ”¯åªè¿è¡Œåœ¨å¾—åˆ†æœ€é«˜çš„100ä¸ªboxä¸Šã€‚å°½ç®¡è¿™ä¸è®­ç»ƒä¸­ä½¿ç”¨çš„å¹¶è¡Œè®¡ç®—ä¸åŒï¼Œä½†å®ƒåŠ å¿«äº†æ¨ç†é€Ÿåº¦å¹¶æé«˜äº†ç²¾åº¦ï¼ˆå› ä¸ºä½¿ç”¨äº†æ›´å°‘ã€æ›´å‡†ç¡®çš„RoIï¼‰ã€‚å¯¹äºæ¯ä¸ªRoIï¼Œmaskåˆ†æ”¯éƒ½å¯ä»¥é¢„æµ‹å‡º$K$ä¸ªmaskï¼Œä½†æˆ‘ä»¬åªä½¿ç”¨ç¬¬$k$ä¸ªç±»åˆ«çš„maskï¼Œ$k$æ˜¯ç±»åˆ«åˆ†æ”¯é¢„æµ‹å¾—åˆ°çš„ç±»åˆ«ã€‚maskåˆ†æ”¯è¾“å‡ºçš„$m \times m$å¤§å°çš„maskä¼šè¢«resizeåˆ°RoIå¤§å°ï¼Œå¹¶åœ¨0.5çš„é˜ˆå€¼ä¸‹è¿›è¡ŒäºŒå€¼åŒ–ã€‚

å› ä¸ºæˆ‘ä»¬åœ¨å‰100ä¸ªboxä¸Šè®¡ç®—äº†maskï¼Œæ‰€ä»¥è®¡ç®—å¼€é”€ç›¸æ¯”[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/)æé«˜äº†çº¦20%ã€‚

# 4.Experiments: Instance Segmentation

æˆ‘ä»¬å°†Mask R-CNNå’Œç°æœ‰çš„SOTAæ–¹æ³•è¿›è¡Œäº†å½»åº•çš„æ¯”è¾ƒï¼Œå¹¶åœ¨COCOæ•°æ®é›†ä¸Šè¿›è¡Œäº†æ¶ˆèå®éªŒã€‚æˆ‘ä»¬åœ¨80kè®­ç»ƒå›¾åƒ+trainval35kçš„å¹¶é›†ä¸Šè¿›è¡Œäº†è®­ç»ƒï¼Œåœ¨minivalä¸Šè¿›è¡Œäº†æ¶ˆèå®éªŒï¼Œåœ¨test-devä¸Šæ±‡æŠ¥äº†ç»“æœã€‚

## 4.1.Main Results

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/5.png)

Mask R-CNNçš„ç»“æœå¯è§†åŒ–è§Fig2å’ŒFig5ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/6.png)

å’ŒFCIS+++çš„ç»“æœå¯¹æ¯”è§Fig6ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/7.png)

## 4.2.Ablation Experiments

æ¶ˆèå®éªŒçš„ç»“æœè§è¡¨2ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/8.png)

ğŸ‘‰**Architecture:**

Mask R-CNNä½¿ç”¨ä¸åŒbackboneçš„ç»“æœè§è¡¨2aã€‚

ğŸ‘‰**Multinomial vs. Independent Masks:**

æ˜¯å¦å°†ç±»åˆ«é¢„æµ‹å’Œmaské¢„æµ‹è§£è€¦çš„ç»“æœå¯¹æ¯”è§è¡¨2bã€‚

ğŸ‘‰**Class-Specific vs. Class-Agnostic Masks:**

æˆ‘ä»¬é»˜è®¤æ˜¯é¢„æµ‹class-specific masksï¼Œå³ä¸€ä¸ªç±»åˆ«å¯¹åº”ä¸€ä¸ª$m \times m$çš„maskã€‚å¦‚æœMask R-CNNé¢„æµ‹class-agnostic masksï¼Œå³åªé¢„æµ‹å¾—åˆ°ä¸€ä¸ª$m \times m$çš„maskï¼ˆä¸ç±»åˆ«æ— å…³ï¼‰ï¼Œåœ¨backboneä¸ºResNet-50-C4çš„æƒ…å†µä¸‹ï¼Œclass-agnostic masksçš„APä¸º29.7ï¼Œç¨å·®äºclass-specific masksçš„30.3ã€‚

ğŸ‘‰**RoIAlign:**

å¯¹RoIAlignçš„è¯„ä¼°è§è¡¨2cï¼Œbackboneä¸ºResNet-50-C4ï¼Œæ­¥é•¿ä¸º16ã€‚RoIAlignå¯¹max/average poolæ˜¯æ•æ„Ÿçš„ï¼Œåç»­æˆ‘ä»¬éƒ½ä½¿ç”¨averageã€‚

å½“backboneä¸ºResNet-50-C5ï¼Œæ­¥é•¿ä¸º32ä¸ªåƒç´ æ—¶ï¼Œå¯¹RoIAlignçš„è¯„ä¼°è§è¡¨2dã€‚æˆ‘ä»¬ä½¿ç”¨Fig4å³çš„headã€‚

ğŸ‘‰**Mask Branch:**

maskåˆ†æ”¯ä½¿ç”¨å…¨è¿æ¥MLPå’Œ[FCN](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/)çš„å¯¹æ¯”è§è¡¨2eã€‚

## 4.3.Bounding Box Detection Results

ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸Šçš„å¯¹æ¯”ç»“æœè§è¡¨3ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/9.png)

å®Œæ•´çš„Mask R-CNNæ¨¡å‹è¢«è®­ç»ƒï¼Œä½†åœ¨æ¨ç†é˜¶æ®µåªä½¿ç”¨äº†ç±»åˆ«å’Œboxè¾“å‡ºï¼ˆmaskè¾“å‡ºè¢«å¿½è§†ï¼‰ã€‚ä¸ºäº†è¿›ä¸€æ­¥çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬è®­ç»ƒäº†ä¸€ä¸ªæ²¡æœ‰maskåˆ†æ”¯çš„Mask R-CNNï¼Œè§è¡¨3ä¸­çš„"Faster R-CNN, RoIAlign"ã€‚

## 4.4.Timing

ğŸ‘‰**Inference:**

æˆ‘ä»¬è®­ç»ƒäº†ä¸€ä¸ªResNet-101-FPNæ¨¡å‹ï¼Œå…¶åœ¨RPNå’ŒMask R-CNNä¹‹é—´å…±äº«ç‰¹å¾ï¼Œéµå¾ª[Faster R-CNN](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/#32sharing-features-for-rpn-and-fast-r-cnn)çš„4æ­¥è®­ç»ƒæ³•ã€‚åœ¨Nvidia Tesla M40 GPUä¸Šå¤„ç†ä¸€å¼ å›¾åƒéœ€è¦195msï¼ˆåœ¨CPUä¸Šè¿˜éœ€è¦15msç”¨äºå°†è¾“å‡ºresizeåˆ°åŸå§‹åˆ†è¾¨ç‡ï¼‰ï¼Œå¯ä»¥è¾¾åˆ°ä¸å…±äº«ç‰¹å¾æ—¶çš„APã€‚å¦‚æœbackboneæ˜¯ResNet-101-C4ï¼Œåˆ™éœ€è¦400msã€‚

å°½ç®¡Mask R-CNNé€Ÿåº¦å¾ˆå¿«ï¼Œä½†æˆ‘ä»¬å¹¶æ²¡æœ‰é’ˆå¯¹é€Ÿåº¦è¿›è¡Œä¼˜åŒ–ã€‚

ğŸ‘‰**Training:**

Mask R-CNNè®­ç»ƒä¹Ÿå¾ˆå¿«ã€‚backboneä¸ºResNet-50-FPNï¼Œåœ¨COCO trainval35kä¸Šè®­ç»ƒäº†32ä¸ªå°æ—¶ï¼Œç”¨äº†8å—GPUã€‚å¦‚æœbackboneä¸ºResNet-101-FPNï¼Œåˆ™è®­ç»ƒéœ€è¦44ä¸ªå°æ—¶ã€‚

# 5.Mask R-CNN for Human Pose Estimation

æˆ‘ä»¬çš„æ¡†æ¶å¯ä»¥å¾ˆå®¹æ˜“çš„è¢«æ‰©å±•åˆ°äººä½“å§¿æ€ä¼°è®¡ã€‚Mask R-CNNè¿˜æ˜¯é¢„æµ‹$K$ä¸ªmaskï¼Œæ¯ä¸ªmaskå¯¹åº”ä¸€ä¸ªå…³é”®ç‚¹ã€‚

ğŸ‘‰**Implementation Details:**

è¾“å‡ºä¸€ä¸ªone-hotçš„$m \times m$å¤§å°çš„äºŒå€¼maskï¼Œåªæœ‰ä¸€ä¸ªåƒç´ è¢«æ ‡è®°ä¸ºå‰æ™¯ã€‚ä½¿ç”¨softmaxå‡½æ•°å’Œäº¤å‰ç†µæŸå¤±ã€‚å’Œå®ä¾‹åˆ†å‰²æ¨¡å‹ä¸€æ ·ï¼Œ$K$ä¸ªå…³é”®ç‚¹ä¹Ÿæ˜¯è¢«ç‹¬ç«‹å¤„ç†çš„ã€‚

ä½¿ç”¨ResNet-FPNä½œä¸ºbackboneï¼Œheadçš„ç»“æ„ç±»ä¼¼Fig4å³ã€‚å…³é”®ç‚¹æ¨¡å‹çš„headåŒ…å«8ä¸ª$3 \times 3$ 512-dçš„å·ç§¯å±‚ï¼Œç„¶åæ˜¯åå·ç§¯å±‚å’Œ2å€çš„åŒçº¿æ€§ä¸Šé‡‡æ ·ï¼Œæœ€ç»ˆçš„è¾“å‡ºåˆ†è¾¨ç‡ä¸º$56 \times 56$ã€‚æˆ‘ä»¬å‘ç°å…³é”®ç‚¹çš„ç²¾ç¡®å®šä½éœ€è¦ç›¸å¯¹è¾ƒé«˜çš„è¾“å‡ºåˆ†è¾¨ç‡ã€‚

åœ¨COCO trainval35kä¸Šè®­ç»ƒæ¨¡å‹ã€‚ç”±äºè¯¥è®­ç»ƒé›†è¾ƒå°ï¼Œä¸ºäº†å‡å°‘è¿‡æ‹Ÿåˆï¼Œæˆ‘ä»¬å°†å›¾åƒçš„çŸ­è¾¹éšæœºresizeåˆ°$[640,800]$ä¸ªåƒç´ ï¼Œæ¨ç†åˆ™æ˜¯åœ¨800ä¸ªåƒç´ çš„å°ºåº¦ä¸Šè¿›è¡Œçš„ã€‚ä¸€å…±è®­ç»ƒäº†90kæ¬¡è¿­ä»£ï¼Œåˆå§‹å­¦ä¹ ç‡ä¸º0.02ï¼Œåœ¨ç¬¬60kå’Œç¬¬80kæ¬¡è¿­ä»£æ—¶ï¼Œå­¦ä¹ ç‡ç¼©å°10å€ã€‚bounding box NMSçš„é˜ˆå€¼ä¸º0.5ã€‚å…¶ä»–ç»†èŠ‚å’Œç¬¬3.1éƒ¨åˆ†ä¸€æ ·ã€‚

ğŸ‘‰**Main Results and Ablations:**

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/10.png)

è¡¨4ä¸­ï¼Œæˆ‘ä»¬è¿˜å±•ç¤ºäº†ä¸€ä¸ªç»Ÿä¸€çš„æ¨¡å‹ï¼Œå¯ä»¥ä»¥5 fpsçš„é€Ÿåº¦åŒæ—¶é¢„æµ‹bounding boxã€åˆ†å‰²å’Œå…³é”®ç‚¹ï¼Œå¹¶ä¸”$AP^{kp}$è¾¾åˆ°äº†63.1ã€‚æ›´å¤šåœ¨minivalä¸Šå¤šä»»åŠ¡å­¦ä¹ çš„æ¶ˆèå®éªŒè§è¡¨5ã€‚å¤šä»»åŠ¡å­¦ä¹ çš„å¯è§†åŒ–ç»“æœè§Fig7ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/12.png)

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/11.png)

RoIAlignå¯¹å…³é”®ç‚¹æ£€æµ‹çš„å½±å“è§è¡¨6ã€‚

# 6.Appendix A: Experiments on Cityscapes

æˆ‘ä»¬è¿›ä¸€æ­¥æŠ¥å‘Šäº†åœ¨Cityscapesæ•°æ®é›†ä¸Šçš„å®ä¾‹åˆ†å‰²ç»“æœã€‚è¯¥æ•°æ®é›†æ ‡æ³¨çš„å¾ˆè¯¦ç»†ï¼ˆfine dataï¼‰ï¼Œè®­ç»ƒé›†æœ‰2975å¼ å›¾åƒï¼ŒéªŒè¯é›†æœ‰500å¼ å›¾åƒï¼Œæµ‹è¯•é›†æœ‰1525å¼ å›¾åƒã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æœ‰20kå¼ æ²¡æœ‰å®ä¾‹æ ‡æ³¨çš„è®­ç»ƒå›¾åƒï¼ˆcoarse dataï¼‰ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨è¿™äº›æ— æ ‡æ³¨çš„å›¾åƒã€‚æ‰€æœ‰å›¾åƒéƒ½æ˜¯$2048 \times 1024$å¤§å°çš„ã€‚å®ä¾‹åˆ†å‰²ä»»åŠ¡åŒ…æ‹¬8ä¸ªç›®æ ‡ç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«çš„å®ä¾‹æ•°é‡è§ä¸‹ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/13.png)

ğŸ‘‰**Implementation:**

Mask R-CNNçš„backboneä½¿ç”¨ResNet-FPN-50ã€‚ç”±äºæ•°æ®é›†å¤ªå°ï¼Œä½¿ç”¨101å±‚çš„backboneåŒºåˆ«ä¸å¤§ã€‚ä¸ºäº†å‡å°‘è¿‡æ‹Ÿåˆï¼Œæˆ‘ä»¬å°†è®­ç»ƒå›¾åƒçš„çŸ­è¾¹éšæœºresizeåˆ°$[800,1024]$ï¼›æ¨ç†åœ¨1024çš„å•å°ºåº¦ä¸Šè¿›è¡Œã€‚ä¸€å—GPUçš„mini-batch sizeä¸º1ï¼ˆ8å—GPUå°±æ˜¯8ï¼‰ï¼Œæ¨¡å‹ä¸€å…±è®­ç»ƒäº†24kæ¬¡è¿­ä»£ï¼Œåˆå§‹å­¦ä¹ ç‡ä¸º0.01ï¼Œåœ¨ç¬¬18kæ¬¡è¿­ä»£æ—¶ï¼Œå­¦ä¹ ç‡é™ä¸º0.001ã€‚ä¸€å…±è®­ç»ƒäº†4ä¸ªå°æ—¶ã€‚

ğŸ‘‰**Results:**

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/14.png)

åœ¨è¡¨7ä¸­ï¼Œæˆ‘ä»¬è¿˜æ±‡æŠ¥äº†ç»è¿‡COCOé¢„è®­ç»ƒåçš„Mask R-CNNçš„ç»“æœï¼Œfine-tuneäº†4kæ¬¡è¿­ä»£ï¼Œåœ¨ç¬¬3kæ¬¡è¿­ä»£æ—¶å­¦ä¹ ç‡ä¸‹é™ï¼Œåœ¨COCOä¸Šé¢„è®­ç»ƒç”¨äº†1ä¸ªå°æ—¶ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/15.png)

# 7.Appendix B: Enhanced Results on COCO

æœ¬é™„å½•ä»‹ç»ä¸€äº›æ”¹è¿›åŸå§‹ç»“æœçš„æŠ€æœ¯ã€‚

## 7.1.Instance Segmentation and Object Detection

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/16.png)

ğŸ‘‰*Updated baseline:*

æˆ‘ä»¬å°†è®­ç»ƒå»¶é•¿åˆ°180kæ¬¡è¿­ä»£ï¼Œåœ¨ç¬¬120kå’Œç¬¬160kæ¬¡è¿­ä»£æ—¶å­¦ä¹ ç‡ç¼©å°10å€ã€‚å°†NMSçš„é˜ˆå€¼ä»é»˜è®¤çš„0.3è°ƒæ•´ä¸º0.5ã€‚

ğŸ‘‰*End-to-end training:*

å°†[Faster R-CNNçš„4æ­¥è®­ç»ƒæ³•](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/#32sharing-features-for-rpn-and-fast-r-cnn)è°ƒæ•´ä¸º["Approximate joint training"](http://shichaoxin.com/2022/04/03/è®ºæ–‡é˜…è¯»-Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks/#32sharing-features-for-rpn-and-fast-r-cnn)çš„ç«¯åˆ°ç«¯è®­ç»ƒæ–¹å¼ã€‚

ğŸ‘‰*ImageNet-5k pre-training:*

åœ¨ImageNet-5kä¸Šè¿›è¡Œäº†é¢„è®­ç»ƒã€‚

ğŸ‘‰*Train-time augmentation:*

å¯¹å›¾åƒè¿›è¡Œä¸åŒæ¯”ä¾‹çš„ç¼©æ”¾è¿›ä¸€æ­¥æå‡äº†ç»“æœã€‚æˆ‘ä»¬å°†çŸ­è¾¹éšæœºresizeåˆ°$[640,800]$åŒºé—´ï¼Œå¹¶ä¸”æŠŠè¿­ä»£æ¬¡æ•°å¢åŠ è‡³260kï¼ˆåœ¨ç¬¬200kå’Œç¬¬240kçš„æ—¶å€™å­¦ä¹ ç‡è¡°å‡10å€ï¼‰ã€‚

ğŸ‘‰*Model architecture:*

æŠŠ101å±‚çš„[ResNeXt](http://shichaoxin.com/2023/12/11/è®ºæ–‡é˜…è¯»-Aggregated-Residual-Transformations-for-Deep-Neural-Networks/)å¢åŠ è‡³152å±‚ã€‚

ğŸ‘‰*Non-local:*

ä½¿ç”¨äº†non-localæ¨¡å‹ã€‚åœ¨ä¸ä½¿ç”¨test-time augmentationçš„æƒ…å†µä¸‹ï¼Œåœ¨Nvidia Tesla P100 GPUä¸Šå¯ä»¥è¾¾åˆ°3fpsçš„æ¨ç†é€Ÿåº¦ã€‚

>non-localæ¨¡å‹ï¼šX.Wang, R.Girshick, A.Gupta, and K.He. Non-local neural networks. arXiv:1711.07971, 2017.ã€‚

ğŸ‘‰*Test-time augmentation:*

æˆ‘ä»¬å°†æµ‹è¯•å›¾åƒçš„çŸ­è¾¹åˆ†åˆ«resizeåˆ°$[400,1200]$ï¼ˆé—´éš”100ï¼‰ï¼Œå¹¶è€ƒè™‘å…¶æ°´å¹³ç¿»è½¬å›¾åƒï¼Œå¾—åˆ°çš„ç»¼åˆé¢„æµ‹ç»“æœä½œä¸ºæœ€ç»ˆç»“æœã€‚

## 7.2.Keypoint Detection

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/MaskRCNN/17.png)

é’ˆå¯¹updated baselineï¼Œæˆ‘ä»¬å°†è¿­ä»£æ¬¡æ•°å¢åŠ è‡³130kï¼Œåœ¨ç¬¬100kå’Œç¬¬120kæ—¶å­¦ä¹ ç‡è¡°å‡10å€ã€‚

é€šè¿‡data distillationçš„æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨COCOæä¾›çš„é¢å¤–120kå¼ æœªæ ‡è®°å›¾åƒã€‚ç®€å•æ¥è¯´ï¼Œdata distillationæ˜¯ä¸€ç§è‡ªè®­ç»ƒç­–ç•¥ï¼ˆself-training strategyï¼‰ï¼Œå®ƒä½¿ç”¨åœ¨æ ‡è®°æ•°æ®ä¸Šè®­ç»ƒçš„æ¨¡å‹æ¥é¢„æµ‹æœªæ ‡è®°å›¾åƒçš„æ ‡ç­¾/æ ‡æ³¨ï¼Œç„¶åç”¨è¿™äº›æ–°çš„æ ‡ç­¾/æ ‡æ³¨æ¥æ›´æ–°æ¨¡å‹ã€‚

>data distillationï¼šI. Radosavovic, P. Dolla Ìr, R. Girshick, G. Gkioxari, and K. He. Data distillation: Towards omni-supervised learning. arXiv:1712.04440, 2017.ã€‚

# 8.åŸæ–‡é“¾æ¥

ğŸ‘½[Mask R-CNN](https://github.com/x-jeff/AI_Papers/blob/master/Mask%20R-CNN.pdf)