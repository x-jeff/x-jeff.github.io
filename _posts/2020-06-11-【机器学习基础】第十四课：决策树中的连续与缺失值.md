---
layout:     post
title:      ã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘ç¬¬åå››è¯¾ï¼šå†³ç­–æ ‘ä¸­çš„è¿ç»­ä¸ç¼ºå¤±å€¼
subtitle:   è¿ç»­å€¼å¤„ç†ï¼Œç¼ºå¤±å€¼å¤„ç†
date:       2020-06-11
author:     x-jeff
header-img: blogimg/20200611.jpg
catalog: true
tags:
    - Machine Learning Series
---
>ã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘ç³»åˆ—åšå®¢ä¸ºå‚è€ƒå‘¨å¿—åè€å¸ˆçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ä¸€ä¹¦ï¼Œè‡ªå·±æ‰€åšçš„è¯»ä¹¦ç¬”è®°ã€‚  
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.è¿ç»­å€¼å¤„ç†

åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ä»…è®¨è®ºäº†åŸºäºç¦»æ•£å±æ€§æ¥ç”Ÿæˆå†³ç­–æ ‘ã€‚æœ¬èŠ‚æˆ‘ä»¬æ¥è®¨è®ºåœ¨å†³ç­–æ ‘å­¦ä¹ ä¸­å¦‚ä½•ä½¿ç”¨è¿ç»­å±æ€§ã€‚

å¯å°†è¿ç»­å±æ€§ç¦»æ•£åŒ–ï¼Œæœ€ç®€å•çš„ç­–ç•¥æ˜¯**äºŒåˆ†æ³•**ï¼ˆC4.5å†³ç­–æ ‘ç®—æ³•ä¸­é‡‡ç”¨çš„æœºåˆ¶ï¼‰ã€‚

ç»™å®šæ ·æœ¬é›†Då’Œè¿ç»­å±æ€§aï¼Œå‡å®šaåœ¨Dä¸Šå‡ºç°äº†nä¸ªä¸åŒçš„å–å€¼ï¼Œå°†è¿™äº›å€¼ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œè®°ä¸º$\\{a^1,a^2,...,a^n \\}$ã€‚åŸºäºåˆ’åˆ†ç‚¹tå¯å°†Dåˆ†ä¸ºå­é›†$D_t^-$å’Œ$D_t^+$ï¼Œå…¶ä¸­$D_t^-$åŒ…å«é‚£äº›åœ¨å±æ€§aä¸Šå–å€¼ä¸å¤§äºtçš„æ ·æœ¬ï¼Œè€Œ$D_t^+$åˆ™åŒ…å«é‚£äº›åœ¨å±æ€§aä¸Šå–å€¼å¤§äºtçš„æ ·æœ¬ã€‚æ˜¾ç„¶ï¼Œå¯¹ç›¸é‚»çš„å±æ€§å–å€¼$a^i$ä¸$a^{i+1}$æ¥è¯´ï¼Œtåœ¨åŒºé—´$[a^i,a^{i+1})$ä¸­å–ä»»æ„å€¼æ‰€äº§ç”Ÿçš„åˆ’åˆ†ç»“æœç›¸åŒã€‚å› æ­¤ï¼Œå¯¹è¿ç»­å±æ€§aï¼Œæˆ‘ä»¬å¯è€ƒå¯ŸåŒ…å«n-1ä¸ªå…ƒç´ çš„å€™é€‰åˆ’åˆ†ç‚¹é›†åˆï¼š

$$T_a=\{ \frac{a^i+a^{i+1}}{2} | 1 \leqslant i \leqslant n-1 \} \tag{1.1}$$

å³æŠŠåŒºé—´$[a^i,a^{i+1})$çš„ä¸­ä½ç‚¹$\frac{a^i+a^{i+1}}{2}$ä½œä¸ºå€™é€‰åˆ’åˆ†ç‚¹ã€‚

å°†[ä¿¡æ¯å¢ç›Š](http://shichaoxin.com/2020/03/17/æœºå™¨å­¦ä¹ åŸºç¡€-ç¬¬åäºŒè¯¾-å†³ç­–æ ‘çš„åˆ’åˆ†é€‰æ‹©/)çš„å…¬å¼åŠ ä»¥æ”¹é€ ï¼š

$$\begin{align} Gain(D,a) &=\max \limits_{t\in T_a} Gain(D,a,t) \\&= \max \limits_{t\in T_a} Ent(D) - \sum \limits_{\lambda \in \{-,+\}} \frac{\mid D_t^{\lambda} \mid}{ \mid D \mid } Ent(D_t^{\lambda}) \end{align} \tag{1.2}$$

ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹è¥¿ç“œæ•°æ®é›†ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/MachineLearningSeries/Lesson14/14x1.png)

ä»¥è¿ç»­å±æ€§â€œå¯†åº¦â€ä¸ºä¾‹ï¼Œå°†17ä¸ªå±æ€§å€¼ä»å°åˆ°å¤§æ’åˆ—ï¼š0.243ã€0.245ã€0.343ã€0.360ã€0.403ã€0.437ã€0.481ã€0.556ã€0.593ã€0.608ã€0.634ã€0.639ã€0.657ã€0.666ã€0.697ã€0.719ã€0.774ã€‚æ ¹æ®å¼1.1ï¼Œå¾—åˆ°è¯¥å±æ€§çš„16ä¸ªå€™é€‰åˆ’åˆ†ç‚¹ï¼š0.244ã€0.294ã€0.351ã€0.381ã€0.420ã€0.459ã€0.518ã€0.574ã€0.600ã€0.621ã€0.636ã€0.648ã€0.661ã€0.681ã€0.708ã€0.746ã€‚è®¡ç®—æ¯ä¸ªå€™é€‰åˆ†å‰²ç‚¹çš„ä¿¡æ¯å¢ç›Šï¼š

|t|$D_t^-$|$D_t^+$|Gain|
|:-:|:-:|:-:|:-:|
|0.244|10|1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17|0.056|
|0.294|10,11|1,2,3,4,5,6,7,8,9,12,13,14,15,16,17|0.118|
|0.351|10,11,12|1,2,3,4,5,6,7,8,9,13,14,15,16,17|0.186|
|0.381|10,11,12,15|1,2,3,4,5,6,7,8,9,13,14,16,17|0.262|
|0.420|6,10,11,12,15|1,2,3,4,5,7,8,9,13,14,16,17|0.093|
|0.459|6,8,10,11,12,15|1,2,3,4,5,7,9,13,14,16,17|0.030|
|0.518|6,7,8,10,11,12,15|1,2,3,4,5,9,13,14,16,17|0.004|
|0.574|5,6,7,8,10,11,12,15|1,2,3,4,9,13,14,16,17|0.002|
|0.600|5,6,7,8,10,11,12,15,16|1,2,3,4,9,13,14,17|0.002|
|0.621|4,5,6,7,8,10,11,12,15,16|1,2,3,9,13,14,17|0.004|
|0.636|3,4,5,6,7,8,10,11,12,15,16|1,2,9,13,14,17|0.030|
|0.648|3,4,5,6,7,8,10,11,12,13,15,16|1,2,9,14,17|0.006|
|0.661|3,4,5,6,7,8,10,11,12,13,14,15,16|1,2,9,17|0.001|
|0.681|3,4,5,6,7,8,9,10,11,12,13,14,15,16|1,2,17|0.024|
|0.708|1,3,4,5,6,7,8,9,10,11,12,13,14,15,16|2,17|0.000|
|0.746|1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17|2|0.067|

æ ¹æ®å¼1.2å–ä¿¡æ¯å¢ç›Šçš„æœ€å¤§å€¼0.262ï¼Œå¯¹åº”äºåˆ’åˆ†ç‚¹0.381ã€‚åŒç†ï¼Œå¯å¾—è¿ç»­å±æ€§â€œå«ç³–ç‡â€çš„ä¿¡æ¯å¢ç›Šä¸º0.349ï¼Œå¯¹åº”äºåˆ’åˆ†ç‚¹0.126ã€‚

âš ï¸ä¸ç¦»æ•£å±æ€§ä¸åŒï¼Œè‹¥å½“å‰ç»“ç‚¹åˆ’åˆ†å±æ€§ä¸ºè¿ç»­å±æ€§ï¼Œè¯¥å±æ€§è¿˜å¯ä½œä¸ºå…¶åä»£ç»“ç‚¹çš„åˆ’åˆ†å±æ€§ã€‚ä¾‹å¦‚åœ¨çˆ¶ç»“ç‚¹ä¸Šä½¿ç”¨äº†â€œå¯†åº¦$\leqslant$0.381â€ï¼Œä¸ä¼šç¦æ­¢åœ¨å­ç»“ç‚¹ä¸Šä½¿ç”¨â€œå¯†åº¦$\leqslant$0.294â€ã€‚

# 2.ç¼ºå¤±å€¼å¤„ç†

å‡è®¾æˆ‘ä»¬æœ‰å«ç¼ºå¤±å€¼çš„è¥¿ç“œæ•°æ®é›†è§ä¸‹ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/MachineLearningSeries/Lesson14/14x2.png)

å¦‚æœç›´æ¥èˆå¼ƒå«æœ‰ç¼ºå¤±å€¼çš„æ•°æ®ï¼Œé‚£ä¹ˆä»…æœ‰4ã€7ã€14ã€16å››ä¸ªæ ·æœ¬å¯ç”¨ï¼Œæ˜¾ç„¶æ˜¯å¯¹æ•°æ®ä¿¡æ¯æå¤§çš„æµªè´¹ã€‚

æˆ‘ä»¬éœ€è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š

1. å¦‚ä½•åœ¨å±æ€§å€¼ç¼ºå¤±çš„æƒ…å†µä¸‹è¿›è¡Œåˆ’åˆ†å±æ€§é€‰æ‹©ï¼Ÿ
2. ç»™å®šåˆ’åˆ†å±æ€§ï¼Œè‹¥æ ·æœ¬åœ¨è¯¥å±æ€§ä¸Šçš„å€¼ç¼ºå¤±ï¼Œå¦‚ä½•å¯¹æ ·æœ¬è¿›è¡Œåˆ’åˆ†ï¼Ÿ

ğŸ‘‰è§£å†³é—®é¢˜1ï¼š

ç»™å®šè®­ç»ƒé›†Då’Œå±æ€§aï¼Œä»¤$\tilde{D}$è¡¨ç¤ºDä¸­åœ¨å±æ€§aä¸Šæ²¡æœ‰ç¼ºå¤±å€¼çš„æ ·æœ¬å­é›†ã€‚æˆ‘ä»¬å¯ä»…æ ¹æ®$\tilde{D}$æ¥åˆ¤æ–­å±æ€§açš„ä¼˜åŠ£ã€‚å‡å®šå±æ€§aæœ‰Vä¸ªå¯å–å€¼$\\{ a^1,a^2,...,a^V \\}$ï¼Œä»¤$\tilde{D}^v$è¡¨ç¤º$\tilde{D}$ä¸­åœ¨å±æ€§aä¸Šå–å€¼ä¸º$a^v$çš„æ ·æœ¬å­é›†ï¼Œ$\tilde{D}\_k$è¡¨ç¤º$\tilde{D}$ä¸­å±äºç¬¬kç±»$(k=1,2,...,\mid y \mid)$çš„æ ·æœ¬å­é›†ï¼Œåˆ™æ˜¾ç„¶æœ‰$\tilde{D}=\cup^{\mid y \mid}\_{k=1} \tilde{D}\_k$ï¼Œ$\tilde{D}=\cup^V\_{v=1} \tilde{D}^v$ã€‚å‡å®šæˆ‘ä»¬ä¸ºæ¯ä¸ªæ ·æœ¬xèµ‹äºˆä¸€ä¸ªæƒé‡$w\_x$ï¼Œå¹¶å®šä¹‰ï¼š

$$\rho=\frac{\sum_{x\in \tilde{D}} w_x}{\sum_{x\in D} w_x}$$

$$\tilde{p}_k=\frac{\sum_{x\in \tilde{D}_k} w_x}{\sum_{x\in \tilde{D}} w_x} (1\leqslant k \leqslant \mid y \mid)$$

$$\tilde{r}_v=\frac{\sum_{x\in \tilde{D}^v} w_x}{\sum_{x\in \tilde{D}} w_x} (1\leqslant v \leqslant V)$$

>åœ¨å†³ç­–æ ‘å­¦ä¹ å¼€å§‹é˜¶æ®µï¼Œæ ¹ç»“ç‚¹ä¸­å„æ ·æœ¬çš„æƒé‡åˆå§‹åŒ–ä¸º1ã€‚

ç›´è§‚åœ°çœ‹ï¼Œå¯¹å±æ€§aï¼Œ$\rho$è¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ï¼Œ$\tilde{p}\_k$è¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬ä¸­ç¬¬kç±»æ‰€å çš„æ¯”ä¾‹ï¼Œ$\tilde{r}\_v$åˆ™è¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬ä¸­åœ¨å±æ€§aä¸Šå–å€¼$a^v$çš„æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ã€‚æ˜¾ç„¶ï¼Œ$\sum^{\mid y \mid}\_{k=1} \tilde{p}\_k=1,\sum^V\_{v=1} \tilde{r}\_v=1$ã€‚

æ ¹æ®ä¸Šè¿°å®šä¹‰ï¼Œå°†ä¿¡æ¯å¢ç›Šæ¨å¹¿ä¸ºï¼š

$$\begin{align} Gain(D,a) &= \rho \times Gain(\tilde{D},a) \\&= \rho \times ( Ent(\tilde{D}) - \sum^V_{v=1} \tilde{r}_v Ent(\tilde{D}^v) ) \end{align}$$

å…¶ä¸­ï¼Œ

$$Ent(\tilde{D})=-\sum^{\mid y \mid}_{k=1} \tilde{p}_k \log_2 \tilde{p}_k$$

ğŸ‘‰è§£å†³é—®é¢˜2ï¼š

è‹¥æ ·æœ¬xåœ¨åˆ’åˆ†å±æ€§aä¸Šçš„å–å€¼å·²çŸ¥ï¼Œåˆ™å°†xåˆ’å…¥ä¸å…¶å–å€¼å¯¹åº”çš„å­ç»“ç‚¹ï¼Œä¸”æ ·æœ¬æƒå€¼åœ¨å­ç»“ç‚¹ä¸­ä¿æŒä¸º$w_x$ã€‚è‹¥æ ·æœ¬xåœ¨åˆ’åˆ†å±æ€§aä¸Šçš„å–å€¼æœªçŸ¥ï¼Œåˆ™å°†xåŒæ—¶åˆ’å…¥æ‰€æœ‰å­ç»“ç‚¹ï¼Œä¸”æ ·æœ¬æƒå€¼åœ¨ä¸å±æ€§å€¼$a^v$å¯¹åº”çš„å­ç»“ç‚¹ä¸­è°ƒæ•´ä¸º$\tilde{r}_v \cdot w_x$ã€‚

>C4.5ç®—æ³•ä½¿ç”¨äº†ä¸Šè¿°è§£å†³æ–¹æ¡ˆã€‚

ä»¥ä¸Šè¿°å«ç¼ºå¤±å€¼çš„è¥¿ç“œæ•°æ®é›†ä¸ºä¾‹ã€‚è¯¥æ•°æ®é›†ä¸€å…±åŒ…å«17ä¸ªæ ·ä¾‹ï¼Œå„æ ·ä¾‹çš„æƒå€¼å‡ä¸º1ã€‚ä»¥å±æ€§â€œè‰²æ³½â€ä¸ºä¾‹ï¼Œæœ‰14ä¸ªæ ·ä¾‹æ— ç¼ºå¤±å€¼ï¼Œ$\tilde{D}$çš„ä¿¡æ¯ç†µä¸ºï¼š

$$\begin{align} Ent(\tilde{D}) &= -\sum^2_{k=1} \tilde{p}_k \log_2 \tilde{p}_k \\&= -(\frac{6}{14}\log_2 \frac{6}{14} + \frac{8}{14}\log_2 \frac{8}{14} ) =0.985 \end{align}$$

ä»¤$\tilde{D}^1,\tilde{D}^2,\tilde{D}^3$åˆ†åˆ«è¡¨ç¤ºåœ¨å±æ€§â€œè‰²æ³½â€ä¸Šå–å€¼ä¸ºâ€œé’ç»¿â€â€œä¹Œé»‘â€ä»¥åŠâ€œæµ…ç™½â€çš„æ ·æœ¬å­é›†ï¼Œæœ‰ï¼š

$$Ent(\tilde{D}^1)=-(\frac{2}{4} \log_2 \frac{2}{4} + \frac{2}{4} \log_2 \frac{2}{4})=1.000$$

$$Ent(\tilde{D}^2)=-(\frac{4}{6} \log_2 \frac{4}{6} + \frac{2}{6} \log_2 \frac{2}{6})=0.918$$

$$Ent(\tilde{D}^3)=-(\frac{0}{4} \log_2 \frac{0}{4} + \frac{4}{4} \log_2 \frac{4}{4})=0.000$$

å› æ­¤ï¼Œæ ·æœ¬å­é›†$\tilde{D}$ä¸Šå±æ€§â€œè‰²æ³½â€çš„ä¿¡æ¯å¢ç›Šä¸ºï¼š

$$Gain(\tilde{D},è‰²æ³½)=0.985-(\frac{4}{14} \times 1.000 + \frac{6}{14} \times 0.918 + \frac{4}{14}\times 0.000)=0.306$$

äºæ˜¯ï¼Œæ ·æœ¬é›†Dä¸Šå±æ€§â€œè‰²æ³½â€çš„ä¿¡æ¯å¢ç›Šä¸ºï¼š

$$Gain(D,è‰²æ³½)=\rho \times Gain(\tilde{D},è‰²æ³½) = \frac{14}{17} \times 0.306 = 0.252$$

åŒç†å¯è®¡ç®—å‡ºæ‰€æœ‰å±æ€§åœ¨Dä¸Šçš„ä¿¡æ¯å¢ç›Šï¼š

* $Gain(D,è‰²æ³½)=0.252$
* $Gain(D,æ ¹è’‚)=0.171$
* $Gain(D,æ•²å£°)=0.145$
* $Gain(D,çº¹ç†)=0.424$
* $Gain(D,è„éƒ¨)=0.289$
* $Gain(D,è§¦æ„Ÿ)=0.006$

å› æ­¤ï¼Œé€‰æ‹©å±æ€§â€œçº¹ç†â€å¯¹æ ¹ç»“ç‚¹è¿›è¡Œåˆ’åˆ†ã€‚æ ·ä¾‹1,2,3,4,5,6,15è¿›å…¥â€œçº¹ç†=æ¸…æ™°â€åˆ†æ”¯ï¼Œæ ·ä¾‹7,9,13,14,17è¿›å…¥â€œçº¹ç†=ç¨ç³Šâ€åˆ†æ”¯ï¼Œæ ·ä¾‹11,12,16è¿›å…¥â€œçº¹ç†=æ¨¡ç³Šâ€åˆ†æ”¯ï¼Œä¸”æ ·æœ¬åœ¨å„å­ç»“ç‚¹ä¸­çš„æƒé‡ä¾æ—§ä¿æŒä¸º1ã€‚

âš ï¸æ ·ä¾‹8åœ¨å±æ€§â€œçº¹ç†â€ä¸Šå‡ºç°äº†ç¼ºå¤±å€¼ï¼Œå› æ­¤å®ƒå°†åŒæ—¶è¿›å…¥ä¸‰ä¸ªåˆ†æ”¯ï¼Œä½†æƒé‡åœ¨ä¸‰ä¸ªå­ç»“ç‚¹ä¸­åˆ†åˆ«è°ƒæ•´ä¸º$\frac{7}{15},\frac{5}{15},\frac{3}{15}$ã€‚

æœ€ç»ˆç”Ÿæˆçš„å†³ç­–æ ‘è§ä¸‹ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/MachineLearningSeries/Lesson14/14x3.png)