---
layout:     post
title:      ã€OpenCVåŸºç¡€ã€‘ç¬¬ä¸‰åäºŒè¯¾ï¼šHarrisè§’ç‚¹æ£€æµ‹
subtitle:   å›¾åƒç‰¹å¾ï¼ŒHarrisè§’ç‚¹æ£€æµ‹ï¼Œå®å¯¹ç§°çŸ©é˜µçš„å¯¹è§’åŒ–ï¼Œç›¸ä¼¼çŸ©é˜µçš„å‡ ä½•æ„ä¹‰ï¼Œæ¤­åœ†ï¼Œcv::cornerHarris
date:       2022-05-30
author:     x-jeff
header-img: blogimg/20220530.jpg
catalog: true
tags:
    - OpenCV Series
---
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.å›¾åƒç‰¹å¾

**å›¾åƒç‰¹å¾ï¼š**å¯ä»¥è¡¨è¾¾å›¾åƒä¸­å¯¹è±¡çš„ä¸»è¦ä¿¡æ¯ï¼Œå¹¶ä¸”ä»¥æ­¤ä¸ºä¾æ®å¯ä»¥ä»å…¶ä»–æœªçŸ¥å›¾åƒä¸­æ£€æµ‹å‡ºç›¸ä¼¼æˆ–è€…ç›¸åŒå¯¹è±¡ã€‚

å¸¸è§çš„å›¾åƒç‰¹å¾ï¼šè¾¹ç¼˜ã€è§’ç‚¹ã€çº¹ç†ã€‚

# 2.Harrisè§’ç‚¹æ£€æµ‹

é¦–å…ˆè§£é‡Šä¸‹è§’ç‚¹çš„æ¦‚å¿µã€‚å¦‚æœæˆ‘ä»¬åœ¨å›¾åƒä¸Šæ»‘åŠ¨ä¸€ä¸ªå°çª—å£ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x1.jpg)

* å¦‚æœåœ¨ä»»ä½•æ–¹å‘ä¸Šæ»‘åŠ¨çª—å£ï¼Œçª—å£å†…çš„ç°åº¦éƒ½æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªå‡åŒ€åŒºåŸŸã€‚
* å¦‚æœçª—å£å†…çš„ç°åº¦åªåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šæ»‘åŠ¨æ—¶æ‰ä¼šæœ‰å˜åŒ–ï¼Œåˆ™è¿™å¯èƒ½æ˜¯ä¸€ä¸ªè¾¹ç¼˜ã€‚
* å¦‚æœåœ¨ä»»ä½•æ–¹å‘ä¸Šæ»‘åŠ¨çª—å£ï¼Œçª—å£å†…çš„ç°åº¦éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªè§’ç‚¹ã€‚

è§’ç‚¹æ£€æµ‹çš„ä¸»è¦åº”ç”¨æœ‰ï¼šå›¾åƒå¯¹é½ã€å›¾åƒæ‹¼æ¥ã€ç›®æ ‡è¯†åˆ«ã€3Dé‡å»ºã€è¿åŠ¨è·Ÿè¸ªç­‰ã€‚

æ£€æµ‹è§’ç‚¹çš„ç®—æ³•æœ‰å¾ˆå¤šï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»æœ€ä¸ºåŸºç¡€çš„Harrisè§’ç‚¹æ£€æµ‹ã€‚

é¦–å…ˆæˆ‘ä»¬æ¥å®šä¹‰ç°åº¦çš„å˜åŒ–ã€‚å‡è®¾æ»‘åŠ¨çª—å£çš„ä¸­å¿ƒä½äºå›¾åƒçš„$(x,y)$ä½ç½®ï¼Œè¯¥ä½ç½®çš„ç°åº¦å€¼ä¸º$I(x,y)$ã€‚å°†çª—å£å‘$x$æ–¹å‘å’Œ$y$æ–¹å‘åˆ†åˆ«ä½ç§»$u$ä¸ªå•ä½å’Œ$v$ä¸ªå•ä½ï¼Œæ­¤æ—¶çª—å£ä¸­å¿ƒçš„åæ ‡ä¸º$(x+u,y+v)$ï¼Œè¿™ä¸ªä½ç½®çš„ç°åº¦å€¼ä¸º$I(x+u,y+v)$ã€‚åˆ™å› çª—å£æ»‘åŠ¨è€Œå¯¼è‡´çš„çª—å£ä¸­å¿ƒç‚¹çš„ç°åº¦å˜åŒ–ä¸ºï¼š

$$I(x+u,y+v)-I(x,y) \tag{1}$$

å‡è®¾æˆ‘ä»¬è€ƒè™‘çª—å£å†…çš„æ‰€æœ‰ç‚¹ï¼Œç»™æ¯ä¸ªç‚¹èµ‹äºˆæƒå€¼$w$ï¼Œåˆ™çª—å£æ»‘åŠ¨å¾—åˆ°çš„æ€»çš„ç°åº¦å˜åŒ–ä¸ºï¼š

$$E(u,v)=\sum_{(x,y)} w(x,y) \times [ I(x+u,y+v)-I(x,y) ]^2 \tag{2}$$

æƒé‡çŸ©é˜µé€šå¸¸æˆ‘ä»¬å¯ä»¥é‡‡ç”¨äºŒç»´é«˜æ–¯åˆ†å¸ƒã€‚æˆ‘ä»¬ä½¿ç”¨[äºŒå…ƒå‡½æ•°çš„ä¸€é˜¶æ³°å‹’å±•å¼€](http://shichaoxin.com/2019/07/10/æ•°å­¦åŸºç¡€-ç¬¬å…­è¯¾-æ¢¯åº¦ä¸‹é™æ³•å’Œç‰›é¡¿æ³•/#13äºŒå…ƒå‡½æ•°çš„æ³°å‹’å±•å¼€)è¿›è¡Œå¦‚ä¸‹è¿‘ä¼¼åŒ–ç®€ï¼š

$$I(x+u,y+v) \approx I(x,y) + I_x(x,y)u + I_y (x,y) v \tag{3}$$

å…¶ä¸­$I_x$å’Œ$I_y$æ˜¯$I$çš„åå¾®åˆ†ï¼Œåœ¨å›¾åƒä¸­å°±æ˜¯åœ¨$x$å’Œ$y$æ–¹å‘çš„æ¢¯åº¦å›¾ï¼ˆå¯ä»¥ä½¿ç”¨[Sobelç®—å­](http://shichaoxin.com/2021/03/01/OpenCVåŸºç¡€-ç¬¬åå…­è¯¾-Sobelç®—å­/)å¾—åˆ°ï¼‰ï¼š

$$I_x = \frac{\partial I(x,y)}{\partial x}, I_y=\frac{\partial I(x,y)}{\partial y} \tag{4}$$

æŠŠå¼(3)ä»£å…¥å¼(2)ï¼š

$$\begin{align} E(u,v) &= \sum_{(x,y)} w(x,y) \times [ I(x+u,y+v)-I(x,y) ]^2  \\& \approx \sum_{(x,y)} w(x,y) \times [I(x,y) + I_x u + I_y  v - I(x,y)  ]^2 \\&= \sum_{(x,y)} w(x,y) \times (I_x u + I_y  v) ^2 \\&= \sum_{(x,y)} w(x,y) \times (u^2 I^2_x + v^2 I^2_y + 2uvI_xI_y) \end{align} \tag{5}$$

æŠŠ$u,v$æå‡ºæ¥ï¼š

$$E(u,v) \approx \begin{bmatrix} u & v \end{bmatrix} M \begin{bmatrix} u \\ v \end{bmatrix} \tag{6}$$

å…¶ä¸­ï¼Œ

$$M=\sum_{(x,y)} w(x,y) \begin{bmatrix} I^2_x & I_x I_y \\ I_x I_y & I^2_y \end{bmatrix} = \begin{bmatrix} \sum_{(x,y)} w(x,y) I^2_x & \sum_{(x,y)} w(x,y) I_x I_y \\ \sum_{(x,y)} w(x,y) I_x I_y & \sum_{(x,y)} w(x,y) I^2_y \end{bmatrix} \tag{7}$$

å¯¹çŸ©é˜µ$M$è¿›è¡Œå®å¯¹ç§°çŸ©é˜µçš„æ­£äº¤ç›¸ä¼¼å¯¹è§’åŒ–ï¼ˆè§æœ¬æ–‡ç¬¬2.1éƒ¨åˆ†ï¼‰ï¼š

$$\begin{align} E(u,v) &\approx \begin{bmatrix} u & v \end{bmatrix} M \begin{bmatrix} u \\ v \end{bmatrix} \\&=  \begin{bmatrix} u & v \end{bmatrix} P \begin{bmatrix} \lambda_1 & 0 \\ 0 & \lambda_2 \end{bmatrix} P^T \begin{bmatrix} u \\ v \end{bmatrix} \\&= \begin{bmatrix} u' & v' \end{bmatrix} \begin{bmatrix} \lambda_1 & 0 \\ 0 & \lambda_2 \end{bmatrix} \begin{bmatrix} u' \\ v' \end{bmatrix} \\&= \lambda_1 (u')^2 + \lambda_2 (v')^2 \\&= \frac{(u')^2}{\frac{1}{\lambda_1}} + \frac{(v')^2}{\frac{1}{\lambda_2}} \end{align}\tag{8}$$

å…¶ä¸­ï¼Œ$\lambda_1,\lambda_2$ä¸ºçŸ©é˜µ$M$çš„[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ã€‚æ ¹æ®[ã€æ•°å­¦åŸºç¡€ã€‘ç¬¬åäº”è¯¾ï¼šçŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/)ä¸€æ–‡å’Œæœ¬æ–‡ç¬¬2.2éƒ¨åˆ†ï¼Œæˆ‘ä»¬çŸ¥é“ç›¸ä¼¼çŸ©é˜µçš„å‡ ä½•æ„ä¹‰å°±æ˜¯åŒä¸€ä¸ªçº¿æ€§å˜æ¢åœ¨ä¸åŒçš„åŸºä¸‹çš„è¡¨è¾¾å½¢å¼ã€‚æ‰€ä»¥å¼(8)ç›¸å½“äºæ˜¯æ¢äº†ä¸€ç»„åŸºï¼Œæ­¤æ—¶æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ ‡å‡†çš„æ¤­åœ†æ–¹ç¨‹ï¼ˆæ¤­åœ†ç›¸å…³å†…å®¹è§æœ¬æ–‡ç¬¬2.3éƒ¨åˆ†ï¼‰ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x10.png)

ä¸Šå›¾ä¸­ï¼Œ$\lambda_{max}=\max(\lambda_1,\lambda_2),\lambda_{min}=\min(\lambda_1,\lambda_2)$ã€‚

å¦‚æœ$\lambda_1,\lambda_2$åªæœ‰ä¸€ä¸ªå¾ˆå¤§ï¼Œåˆ™æ„å‘³ç€ï¼ˆåœ¨æ–°åŸºä¸‹ï¼‰åªæ²¿ç€ä¸€ä¸ªæ–¹å‘ï¼Œ$E(u,v)$ä¼šå‘ç”Ÿè¾ƒå¤§å˜åŒ–ï¼Œæ‰€ä»¥è¿™å¾ˆæœ‰å¯èƒ½æ˜¯ä¸ªè¾¹ç¼˜ï¼Œè€Œä¸æ˜¯è§’ç‚¹ã€‚åªæœ‰$\lambda_1,\lambda_2$éƒ½å¾ˆå¤§ï¼Œå³æ— è®ºæ²¿ç€å“ªä¸ªæ–¹å‘ï¼Œ$E(u,v)$éƒ½ä¼šå‘ç”Ÿè¾ƒå¤§å˜åŒ–ï¼Œè¿™æ‰éå¸¸æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªè§’ç‚¹ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x11.png)

è€Œåœ¨å®é™…è®¡ç®—æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸çœŸçš„è®¡ç®—çŸ©é˜µ$M$çš„ç‰¹å¾å€¼ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå“åº”å‡½æ•°$R$ï¼š

$$R=\text{det}(M)-k * (\text{trace}(M))^2$$

å…¶ä¸­ï¼Œ$\text{det}(M)=\lambda_1 \lambda_2$ä¸ºçŸ©é˜µ$M$çš„[è¡Œåˆ—å¼](http://shichaoxin.com/2019/08/27/æ•°å­¦åŸºç¡€-ç¬¬ä¸ƒè¯¾-çŸ©é˜µä¸å‘é‡/#32è¡Œåˆ—å¼)ï¼Œ$\text{trace}(M)=\lambda_1+\lambda_2$æ˜¯çŸ©é˜µ$M$çš„[è¿¹](http://shichaoxin.com/2019/08/27/æ•°å­¦åŸºç¡€-ç¬¬ä¸ƒè¯¾-çŸ©é˜µä¸å‘é‡/#11çŸ©é˜µçš„è¿¹trace)ã€‚

>ç‰¹å¾å€¼å’ŒçŸ©é˜µè¡Œåˆ—å¼ã€è¿¹ä¹‹é—´çš„å…³ç³»ï¼š[ã€æ•°å­¦åŸºç¡€ã€‘ç¬¬åäº”è¯¾ï¼šçŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ã€‚

$k$æ˜¯ä¸€ä¸ªç»éªŒå¸¸æ•°ï¼ŒèŒƒå›´é€šå¸¸åœ¨$(0.04,0.06)$ä¹‹é—´ã€‚Harrisè§’ç‚¹æ£€æµ‹çš„ç»“æœæ˜¯å¸¦æœ‰è¿™äº›åˆ†æ•°$R$çš„ç°åº¦å›¾åƒï¼Œè®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œåˆ†æ•°å¤§äºè¿™ä¸ªé˜ˆå€¼çš„åƒç´ å°±å¯¹åº”è§’ç‚¹ã€‚

âš ï¸Harrisæ£€æµ‹å™¨å…·æœ‰æ—‹è½¬ä¸å˜æ€§ï¼Œä½†ä¸å…·æœ‰å°ºåº¦ä¸å˜æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å°ºåº¦å˜åŒ–å¯èƒ½ä¼šå¯¼è‡´è§’ç‚¹å˜ä¸ºè¾¹ç¼˜ï¼Œä¾‹å¦‚ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x12.png)

>å°ºåº¦ä¸å˜æ€§å¯ä½¿ç”¨SIFTç‰¹å¾ã€‚

## 2.1.å®å¯¹ç§°çŸ©é˜µçš„å¯¹è§’åŒ–

ğŸ‘‰**å®å¯¹ç§°çŸ©é˜µï¼š**å¦‚æœæœ‰$n$é˜¶çŸ©é˜µ$A$ï¼Œå…¶çŸ©é˜µçš„å…ƒç´ éƒ½ä¸ºå®æ•°ï¼Œä¸”çŸ©é˜µ$A$çš„è½¬ç½®ç­‰äºå…¶æœ¬èº«ï¼Œåˆ™ç§°$A$ä¸ºå®å¯¹ç§°çŸ©é˜µã€‚

å®å¯¹ç§°çŸ©é˜µæœ‰ä»¥ä¸‹ä¸»è¦æ€§è´¨ï¼š

* å®å¯¹ç§°çŸ©é˜µ$A$çš„ä¸åŒ[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)å¯¹åº”çš„[ç‰¹å¾å‘é‡](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)æ˜¯æ­£äº¤çš„ã€‚
* å®å¯¹ç§°çŸ©é˜µ$A$çš„[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)éƒ½æ˜¯å®æ•°ã€‚
* $n$é˜¶å®å¯¹ç§°çŸ©é˜µ$A$å¿…å¯ç›¸ä¼¼å¯¹è§’åŒ–ï¼Œä¸”ç›¸ä¼¼å¯¹è§’é˜µä¸Šçš„å…ƒç´ å³ä¸ºçŸ©é˜µæœ¬èº«[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ã€‚
* è‹¥$A$å…·æœ‰$k$é‡[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)$\lambda_0$ï¼Œåˆ™å¿…æœ‰$k$ä¸ªçº¿æ€§æ— å…³çš„[ç‰¹å¾å‘é‡](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ã€‚
* å®å¯¹ç§°çŸ©é˜µ$A$ä¸€å®šå¯ä»¥æ­£äº¤ç›¸ä¼¼å¯¹è§’åŒ–ã€‚

>å¦‚æœæŸä¸€çŸ©é˜µæœ‰$k$ä¸ªç›¸åŒçš„[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ï¼Œåˆ™ç§°è¯¥[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ä¸º$k$é‡[ç‰¹å¾å€¼](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#121çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡)ã€‚

ğŸ‘‰å¯¹è§’åŒ–ï¼Œç›¸ä¼¼å¯¹è§’åŒ–ï¼Œæ­£äº¤ç›¸ä¼¼å¯¹è§’åŒ–ï¼ˆæŸ¥é˜…äº†ä¸€äº›èµ„æ–™ï¼Œå¯¹è¿™ä¸‰ä¸ªæ¦‚å¿µçš„ç†è§£å¦‚ä¸‹ï¼Œå¦‚æœ‰è¯¯ï¼Œæ¬¢è¿å¤§å®¶æŒ‡æ­£ï¼‰ï¼š

æŸ¥é˜…çš„èµ„æ–™ä¸­å¯¹äºå¯¹è§’åŒ–çš„è§£é‡Šæœ‰ä¸¤ç§ã€‚ç¬¬ä¸€ç§ï¼šå¯¹è§’åŒ–æŒ‡çš„å°±æ˜¯ç›¸ä¼¼å¯¹è§’åŒ–ã€‚ç¬¬äºŒç§ï¼šçŸ©é˜µ$A$çš„å¯¹è§’åŒ–æŒ‡çš„æ˜¯å­˜åœ¨[å¯é€†çŸ©é˜µ](http://shichaoxin.com/2019/08/27/æ•°å­¦åŸºç¡€-ç¬¬ä¸ƒè¯¾-çŸ©é˜µä¸å‘é‡/#27é€†çŸ©é˜µ)$P,Q$ï¼Œä½¿å¾—$PAQ$ä¸ºå¯¹è§’çŸ©é˜µã€‚

çŸ©é˜µçš„ç›¸ä¼¼å¯¹è§’åŒ–å°±æ˜¯ï¼Œå¯¹äº[æ–¹é˜µ](http://shichaoxin.com/2019/08/27/æ•°å­¦åŸºç¡€-ç¬¬ä¸ƒè¯¾-çŸ©é˜µä¸å‘é‡/#22æ–¹é˜µ)$A$ï¼Œå­˜åœ¨[ç›¸ä¼¼å˜æ¢](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#1ç›¸ä¼¼çŸ©é˜µ)çŸ©é˜µ$P$ï¼Œä½¿å¾—$P^{-1}AP=\Lambda$ï¼Œ$\Lambda$ä¸º[å¯¹è§’çŸ©é˜µ](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#3æ­£äº¤ç›¸ä¼¼å˜æ¢)ã€‚

æ­£äº¤ç›¸ä¼¼å¯¹è§’åŒ–ï¼šå¯¹äº$n$é˜¶å®å¯¹ç§°çŸ©é˜µï¼Œä¸€å®šä¼šæœ‰[æ­£äº¤çŸ©é˜µ](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#3æ­£äº¤ç›¸ä¼¼å˜æ¢)$Q$ï¼Œä½¿å¾—ï¼š

$$Q^{-1}AQ=Q^TAQ=\Lambda$$

$\Lambda$ä¸º[å¯¹è§’çŸ©é˜µ](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/#3æ­£äº¤ç›¸ä¼¼å˜æ¢)ã€‚

## 2.2.ç›¸ä¼¼çŸ©é˜µçš„å‡ ä½•æ„ä¹‰

>æœ¬äººä¹‹å‰å†™è¿‡çš„ç›¸å…³åšå®¢ï¼š[ã€æ•°å­¦åŸºç¡€ã€‘ç¬¬åäº”è¯¾ï¼šçŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢](http://shichaoxin.com/2020/08/12/æ•°å­¦åŸºç¡€-ç¬¬åäº”è¯¾-çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢å’Œç›¸åˆå˜æ¢/)ã€‚

è®¾$A,B$éƒ½æ˜¯$n$é˜¶æ–¹é˜µï¼Œè‹¥æœ‰å¯é€†çŸ©é˜µ$P$ï¼Œä½¿å¾—ï¼š

$$B=P^{-1}AP$$

åˆ™ç§°$P$ä¸ºç›¸ä¼¼å˜æ¢çŸ©é˜µï¼Œç§°$B$æ˜¯$A$çš„ç›¸ä¼¼çŸ©é˜µï¼Œè®°ä½œï¼š

$$A \simeq B$$

æˆ‘ä»¬çŸ¥é“ï¼Œçº¿æ€§æ˜ å°„æ˜¯å°†ä¸€ä¸ªå‘é‡æ˜ å°„åˆ°å¦ä¸€ä¸ªå‘é‡ï¼Œæ¯”å¦‚è¿™é‡Œå°†$\mathbf{x}$æ˜ å°„æˆ$\mathbf{y}$ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x2.png)

å°†$\mathbf{x}$åœ¨è‡ªç„¶åŸºä¸‹çš„åæ ‡å‘é‡ç”¨$[\mathbf{x}]_{\epsilon}$è¡¨ç¤ºï¼Œ$\mathbf{y}$åœ¨è‡ªç„¶åŸºä¸‹çš„åæ ‡å‘é‡ç”¨$[\mathbf{y}]_{\epsilon}$è¡¨ç¤ºã€‚çŸ©é˜µ$A$å°±æ˜¯å°†åæ ‡å‘é‡$[\mathbf{x}]_{\epsilon}$æ˜ å°„åˆ°åæ ‡å‘é‡$[\mathbf{y}]_{\epsilon}$ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x3.png)

è¿™é‡Œåæ ‡å‘é‡$[\mathbf{x}]_{\epsilon}=\begin{pmatrix} 0 \\ 2 \end{pmatrix}$ï¼Œåæ ‡å‘é‡$[\mathbf{y}]_{\epsilon}=\begin{pmatrix} 3 \\ 1 \end{pmatrix}$ï¼ŒçŸ©é˜µ$A$å°±æ˜¯æŠŠ$\begin{pmatrix} 0 \\ 2 \end{pmatrix}$è½¬æ¢ä¸º$\begin{pmatrix} 3 \\ 1 \end{pmatrix}$ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x4.png)

è¿˜æ˜¯å°†$\mathbf{x}$æ˜ å°„æˆ$\mathbf{y}$ï¼Œç°åœ¨å°†è¿™ä¸ªæ˜ å°„è¡¨ç¤ºåœ¨éè‡ªç„¶åŸºä¸‹ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x5.gif)

å°†$\mathbf{x}$åœ¨éè‡ªç„¶åŸºä¸‹çš„åæ ‡å‘é‡ç”¨$[\mathbf{x}]_{\mathcal{P}}$è¡¨ç¤ºï¼Œ$\mathbf{y}$åœ¨éè‡ªç„¶åŸºä¸‹çš„åæ ‡å‘é‡ç”¨$[\mathbf{y}]_{\mathcal{P}}$è¡¨ç¤ºã€‚çŸ©é˜µ$B$å°±æ˜¯å°†åæ ‡å‘é‡$[\mathbf{x}]_{\mathcal{P}}$æ˜ å°„åˆ°åæ ‡å‘é‡$[\mathbf{y}]_{\mathcal{P}}$ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x6.png)

è¿™é‡Œåæ ‡å‘é‡$[\mathbf{x}]_{\mathcal{P}} = \begin{pmatrix} 1 \\ 2 \end{pmatrix}, [\mathbf{y}]_{\mathcal{P}} = \begin{pmatrix} 2 \\ 1 \end{pmatrix}$ã€‚çŸ©é˜µ$B$å°±æ˜¯æŠŠ$\begin{pmatrix} 1 \\ 2 \end{pmatrix}$è½¬æ¢ä¸º$\begin{pmatrix} 2 \\ 1 \end{pmatrix}$ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x7.png)

ä¹Ÿå°±æ˜¯è¯´çŸ©é˜µ$A$ï¼ŒçŸ©é˜µ$B$ï¼Œéƒ½æ˜¯å°†$\mathbf{x}$æ˜ å°„åˆ°å‘é‡$\mathbf{y}$ï¼Œè€Œå®ƒä»¬åªæ˜¯ä¸åŒåŸºä¸‹çš„ä¸åŒä»£æ•°è¡¨è¾¾ã€‚

å‡å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸçŸ©é˜µ$P$ï¼Œå°†åæ ‡å‘é‡$[\mathbf{x}]_{\mathcal{P}}$å˜æ¢ä¸ºåæ ‡å‘é‡$[\mathbf{x}]_{\epsilon}$ï¼›çŸ©é˜µ$P^{-1}$ï¼Œå°†åæ ‡å‘é‡$[\mathbf{y}]_{\epsilon}$å˜æ¢ä¸ºåæ ‡å‘é‡$[\mathbf{y}]_{\mathcal{P}}$ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x8.png)

è¿™ä¸ªæ—¶å€™$B$å’Œ$P^{-1}AP$éƒ½æ˜¯å°†$[\mathbf{x}]_{\mathcal{P}}$æ˜ å°„ä¸º$[\mathbf{y}]_{\mathcal{P}}$ï¼Œå› æ­¤å®ƒä»¬æ˜¯ç›¸ç­‰çš„ï¼Œå³ï¼š

$$B=P^{-1}AP$$

## 2.3.æ¤­åœ†

æ¤­åœ†çš„ç¬¬ä¸€å®šä¹‰ï¼šå¹³é¢å†…ä¸ä¸¤å®šç‚¹$F_1,F_2$çš„è·ç¦»çš„å’Œç­‰äºå¸¸æ•°$2a$ï¼ˆ$2a > \lvert F_1F_2 \rvert$ï¼‰çš„åŠ¨ç‚¹$P$çš„è½¨è¿¹å«åšæ¤­åœ†ã€‚å³ï¼š

$$\lvert PF_1 \rvert + \lvert PF_2 \rvert = 2a$$

å…¶ä¸­ä¸¤å®šç‚¹$F_1,F_2$å«åšæ¤­åœ†çš„**ç„¦ç‚¹**ï¼Œä¸¤ç„¦ç‚¹çš„è·ç¦»$\lvert F_1F_2 \rvert=2c<2a$å«åšæ¤­åœ†çš„**ç„¦è·**ã€‚$P$ä¸ºæ¤­åœ†çš„**åŠ¨ç‚¹**ã€‚

æ¤­åœ†æˆªä¸ä¸¤ç„¦ç‚¹è¿çº¿é‡åˆçš„ç›´çº¿æ‰€å¾—çš„å¼¦ä¸º**é•¿è½´**ï¼Œé•¿åº¦ä¸º$2a$
ã€‚æ¤­åœ†æˆªå‚ç›´å¹³åˆ†ä¸¤ç„¦ç‚¹è¿çº¿çš„ç›´çº¿æ‰€å¾—å¼¦ä¸º**çŸ­è½´**ï¼Œé•¿åº¦ä¸º$2b$ã€‚

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson32/32x9.png)

æ¤­åœ†çš„æ ‡å‡†æ–¹ç¨‹ï¼ˆè¿™é‡Œçš„â€œæ ‡å‡†â€æŒ‡çš„æ˜¯ä¸­å¿ƒåœ¨åŸç‚¹ï¼Œå¯¹ç§°è½´ä¸ºåæ ‡è½´ï¼‰æœ‰ä¸¤ç§ï¼š

* ç„¦ç‚¹åœ¨$X$è½´æ—¶ï¼Œæ ‡å‡†æ–¹ç¨‹ä¸ºï¼š$\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1(a>b>0)$ã€‚
* ç„¦ç‚¹åœ¨$Y$è½´æ—¶ï¼Œæ ‡å‡†æ–¹ç¨‹ä¸ºï¼š$\frac{y^2}{a^2} + \frac{x^2}{b^2} = 1(a>b>0)$ã€‚

# 3.`cv::cornerHarris`

```c++
void cornerHarris( 
	InputArray src, 
	OutputArray dst, 
	int blockSize,
	int ksize, 
	double k,
	int borderType = BORDER_DEFAULT 
);
```

å‚æ•°è¯¦è§£ï¼š

1. `InputArray src`ï¼šè¾“å…¥å›¾åƒï¼Œä¸ºå•é€šé“8-bitæˆ–floating-pointå›¾åƒã€‚
2. `OutputArray dst`ï¼šè¾“å‡ºå›¾åƒï¼Œå’Œè¾“å…¥å›¾åƒå¤§å°ä¸€æ ·ï¼Œç±»å‹ä¸º`CV_32FC1`ã€‚å›¾åƒå­˜å‚¨çš„æ˜¯å“åº”å€¼$R$ã€‚
3. `int blockSize`ï¼šæ»‘åŠ¨çª—å£çš„å¤§å°ã€‚
4. `int ksize`ï¼šç”¨äºè®¡ç®—æ¢¯åº¦çš„[sobelç®—å­](http://shichaoxin.com/2021/03/01/OpenCVåŸºç¡€-ç¬¬åå…­è¯¾-Sobelç®—å­/#2sobelç®—å­)çš„å°ºå¯¸ã€‚
5. `double k`ï¼šå“åº”å‡½æ•°$R$ä¸­çš„$k$å€¼ã€‚
6. `int borderType`ï¼šè¾¹ç•Œå¡«å……æ–¹å¼ï¼Œè¯¦è§ï¼š[ã€OpenCVåŸºç¡€ã€‘ç¬¬åäº”è¯¾ï¼šè¾¹ç¼˜å¤„ç†](http://shichaoxin.com/2020/12/11/OpenCVåŸºç¡€-ç¬¬åäº”è¯¾-è¾¹ç¼˜å¤„ç†/)ã€‚

# 4.ä»£ç åœ°å€

1. [Harrisè§’ç‚¹æ£€æµ‹](https://github.com/x-jeff/OpenCV_Code_Demo/tree/master/Demo32)

# 5.å‚è€ƒèµ„æ–™

1. [å›¾åƒç‰¹å¾ä¹‹Harrisè§’ç‚¹æ£€æµ‹](https://senitco.github.io/2017/06/18/image-feature-harris/)
2. [è§’ç‚¹æ£€æµ‹ï¼šHarris ä¸ Shi-Tomasi](https://zhuanlan.zhihu.com/p/83064609)
3. [å¯¹è§’åŒ–å’Œç›¸ä¼¼å¯¹è§’åŒ–æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](https://www.zhihu.com/question/25815532)
4. [çŸ©é˜µçš„ç›¸ä¼¼å¯¹è§’åŒ–](https://dezeming.top/wp-content/uploads/2021/07/çŸ©é˜µçš„ç›¸ä¼¼å¯¹è§’åŒ–.pdf)
5. [çŸ©é˜µç›¸ä¼¼çš„å‡ ä½•æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆçŸ¥ä¹ç”¨æˆ·â€œé©¬åŒå­¦â€çš„å›ç­”ï¼‰](https://www.zhihu.com/question/25352258)
6. [æ¤­åœ†ï¼ˆç™¾åº¦ç™¾ç§‘ï¼‰](https://baike.baidu.com/item/æ¤­åœ†/684466?fr=aladdin)