---
layout:     post
title:      【数学基础】第六课：梯度下降法和牛顿法
subtitle:   泰勒公式，梯度，牛顿法，梯度下降法
date:       2019-07-10
author:     x-jeff
header-img: blogimg/20190710.jpg
catalog: true
tags:
    - Mathematics Series
---  
>本文为原创文章，未经本人允许，禁止转载。转载请注明出处。

# 1.泰勒公式

针对一元函数来说（也有针对多元函数的泰勒展开，此处仅讨论针对一元函数的展开）：

如果函数足够光滑的话，在已知函数在**某一点**(假设为$x_0$)的各阶导数值的情况下，泰勒公式可以用这些导数值做系数构建一个多项式来近似函数在这一点的邻域中的值：

$$f(x)=\frac{f(x_0)}{0!}+\frac{f'(x_0)}{1!}(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+...+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+R_n(x)$$

其中，

1. $f(x_0)$为0阶导数，即函数本身代入$x_0$。
2. $0!=1$。
3. $R_n(x)$为余项，即$(x-x_0)^n$的高阶无穷小：$o[(x-x_0)^n]$。

当$x_0=0$时：

$$f(x)=f(0)+f'(0)x+\frac{f''(0)}{2!}x^2+...+\frac{f^{(n)}(0)}{n!}x^n+R_n(x)$$

此时，也称为**麦克劳伦公式**。

# 2.梯度

**梯度**定义：设二元函数$z=f(x,y)$在平面区域$D$上具有一阶连续偏导数，则对于每一个点$P(x,y)$都可定出一个向量：$\{\frac{\partial f}{\partial x},\frac{\partial f}{\partial y}\}=f_x(x,y)\vec i+f_y(x,y)\vec j$，该函数就称为函数$z=f(x,y)$在点$P(x,y)$的梯度，记作$grad f(x,y)$或$\nabla f(x,y)$，即有：

$$grad f(x,y)=\nabla f(x,y)=\{\frac{\partial f}{\partial x},\frac{\partial f}{\partial y}\}=f_x(x,y)\vec i+f_y(x,y)\vec j$$

其中$\nabla=\frac{\partial}{\partial x}\vec i+\frac{\partial}{\partial y}\vec j$称为（二维的）**向量微分算子**或**Nabla算子**，$\nabla f=\frac{\partial f}{\partial x}\vec i+\frac{\partial f}{\partial y}\vec j$。

相关概念的解释：

【📌一阶连续偏导数】对于二元函数来说，在定义域内是处处可微的（对于二元函数来说，所有方向可导，才是可微的）。也就是可以用一个过这个点的平面去近似那个点附近的曲面。（个人理解：存在过该点的切平面。）

【📌$\vec i,\vec j$】可以理解为$(1,0)$和$(0,1)$两个基向量，构成一个二维平面坐标系。

## 2.1.梯度与方向导数

* 方向导数是一个数值，即是一个标量。
* 梯度是一个向量，梯度的方向指向函数值（即上述定义中的$z$值）**增加**最快的方向，梯度的模就是方向导数的最大值。

## 2.2.梯度的证明

2.1部分中有关梯度的性质	是怎么来的呢？有两种证明方法，见下：

### 2.2.1.代数证明

已知[方向导数](http://shichaoxin.com/2019/02/25/数学基础-第四课-导数/)：$\frac{\partial f}{\partial l}=\frac{\partial f}{\partial x}\cos \varphi+\frac{\partial f}{\partial y}\sin \varphi$

如果设$\vec e=\cos \varphi \vec i+\sin \varphi \vec j$是与**方向$l$(即射线$l$的方向)同方向的单位向量**：

![](https://github.com/x-jeff/BlogImage/raw/master/MathematicsSeries/Lesson6/6x1.png)

>**单位向量：**是指模等于1的向量。
>
>$(\sin \varphi)^2+(\cos \varphi)^2=1$

$$\begin{align} \frac{\partial f}{\partial l} & = \frac{\partial f}{\partial x}\cos \varphi +\frac{\partial f}{\partial y}\sin \varphi \tag{1} \\ & = \{ \frac{\partial f}{\partial x},\frac{\partial f}{\partial y} \} \cdot \{ \cos \varphi ,\sin \varphi \} \tag{2} \\&= gradf(x,y) \cdot \vec e \tag{3} \\&= \mid gradf(x,y) \mid \cdot \mid \vec e \mid \cdot \cos <gradf(x,y),\vec e> \tag{4} \\&= \mid gradf(x,y) \mid \cdot \cos <gradf(x,y),\vec e> \tag{5} \end{align}$$

>式(2)中涉及向量的**点积**，即：  
>$\vec a=(a_1,a_2,...,a_n)$   
>$\vec b=(b_1,b_2,...,b_n)$  
>$\vec a \cdot \vec b=a_1b_1+a_2b_2+,...,+a_nb_n$
>
>式(4)中，$\cos <\vec a,\vec b>$表示向量a和向量b夹角的cos值。

当方向$l$与梯度的方向一致时，有$cos <gradf(x,y),\vec e>=1$，$\frac{\partial f}{\partial l}$取得最大值，即$\mid gradf(x,y) \mid$，也就是说梯度的方向是函数$f(x,y)$在这点增长最快（即斜率最大）的方向。

### 2.2.2.几何证明

![](https://github.com/x-jeff/BlogImage/raw/master/MathematicsSeries/Lesson6/6x2.jpg)

（上图出自[参考资料3](https://www.zhihu.com/question/36301367)）

假设点$C(0,0,1)$为二元函数$z=f(x,y)$上的一点，其中点$A(2,0,0)$、点$B(0,1,0)$，平面$ABC$为过点$C$的切平面。

在切平面$ABC$中，从点$C$出发的任意射线，都可求相应的方向导数。

根据2.1部分的描述，那么$C$点的梯度应指向使$z$值增加最快的方向。为了方便，先考虑使$z$值下降最快的方向，即梯度的反方向。

梯度反方向的确定有两个方法：

1. 从点$C$出发，沿着切面$ABC$往下滑，当不同路径的投影在$XOY$平面上长度相同时，沿着最滑的那条路径，我们在$z$方向上下降最多。
2. 从点$C$出发，沿着切面$ABC$往下滑，当都在$z$方向上下降了同样的高度，最滑的那条路径，在$XOY$平面上的投影一定是最短的。

很明显，采用第二种确定方法更为简单。假设$z$值下降高度均为1，$D$为直线$AB$上的一点，当$CD\bot AB$，则$CD$是“最滑的那条路径”（因为$CD$路程最短），在$XOY$平面的投影为$OD$（有$OD\bot AB$），所以需求得$D$点的坐标（此时可在$XOY$平面内进行计算，不必考虑$z$轴）：

![](https://github.com/x-jeff/BlogImage/raw/master/MathematicsSeries/Lesson6/6x3.png)

计算如下：

$\frac{OC}{OA}=-\frac{\partial f}{\partial x};\frac{OC}{OB}=-\frac{\partial f}{\partial y}$

假设$\mid \vec{CO}\mid =n$，

有：$\vec{OA}=n(-\frac{\partial x}{\partial f},0);\vec{OB}=n(0,-\frac{\partial y}{\partial f})$

可求得：$\vec{AB}=n(-\frac{\partial x}{\partial f},\frac{\partial y}{\partial f})$

因为$\vec{OD} \bot \vec{AB}$，所以有：$\vec{OD}\cdot \vec{AB}=\mid \vec{OD}\mid \cdot \mid \vec{AB}\mid \cdot \cos 90^\circ=0$

假设$\vec{OD}=(a,b)$，有：$\vec{OD}\cdot \vec{AB}=na\cdot (-\frac{\partial x}{\partial f})+nb\cdot \frac{\partial y}{\partial f}=0$

即：$a\cdot \frac{\partial x}{\partial f}=b \cdot \frac{\partial y}{\partial f}$

可解得点$D$的坐标为：$(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y})$

当$n>0$时，方向为梯度的方向；当$n<0$时，方向为梯度的反方向。

# X.参考资料

1. [泰勒公式（百度百科）](https://baike.baidu.com/item/泰勒公式/7681487?fr=aladdin)
2. [梯度（百度百科）](https://baike.baidu.com/item/梯度/13014729?fr=aladdin)
3. [如何直观形象的理解方向导数与梯度以及它们之间的关系？(知乎)](https://www.zhihu.com/question/36301367)

