---
layout:     post
title:      ã€PythonåŸºç¡€ã€‘ç¬¬åå››è¯¾ï¼šèµ„æ–™è½¬æ¢
subtitle:   å‘é‡åŒ–è®¡ç®—ï¼ŒApplyï¼ŒMapï¼ŒApplyMap
date:       2020-07-08
author:     x-jeff
header-img: blogimg/20200708.jpg
catalog: true
tags:
    - Python Series
---
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.å‰è¨€

ä½¿ç”¨`numpy`å’Œ`pandas`è¿›è¡Œèµ„æ–™çš„è½¬æ¢ã€‚

# 2.å‘é‡åŒ–è®¡ç®—

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æˆ¿å±‹èµ„æ–™çš„æ•°æ®ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/PythonSeries/Lesson14/14x1.png)

é€šè¿‡`pandas`è¯»å…¥ï¼š

```python
import pandas as pd
df=pd.read_csv("house_price.csv")
```

>å¦‚æœåœ¨æŸ¥çœ‹DataFrameæ—¶è¡Œæˆ–åˆ—æ²¡æ˜¾ç¤ºå…¨ï¼Œå¯æ·»åŠ ä»¥ä¸‹ä»£ç è§£å†³ï¼š
>
>```python
>#æ˜¾ç¤ºæ‰€æœ‰åˆ—
pd.set_option('display.max_columns', None)
#æ˜¾ç¤ºæ‰€æœ‰è¡Œ
pd.set_option('display.max_rows', None)
>```

ğŸ‘‰â€œæ€»ä»·â€ä¸€æ çš„å•ä½æ˜¯ä¸‡å…ƒï¼Œå°†å…¶è½¬æ¢æˆå…ƒï¼š

```python
df["æ€»ä»·"]*10000
```

ğŸ‘‰æŠŠâ€œæœå‘â€å’Œâ€œæˆ·å‹â€ä¸¤æ è¿›è¡Œåˆå¹¶ï¼š

```python
df["æœå‘"]+df["æˆ·å‹"]
```

ğŸ‘‰å»ºç«‹æ–°çš„æ ä½â€œå‡ä»·â€ï¼š

```python
df["å‡ä»·"]=df["æ€»ä»·"] * 10000 / df["å»ºç­‘é¢ç§¯"]
```

# 3.`Apply`ã€`Map`ã€`ApplyMap`

* `Map`ï¼šå°†å‡½æ•°å¥—ç”¨åˆ°Seriesä¸Šçš„æ¯ä¸ªå…ƒç´ ã€‚
* `Apply`ï¼šå°†å‡½æ•°å¥—ç”¨åˆ°DataFrameä¸Šçš„è¡Œä¸åˆ—ã€‚
* `ApplyMap`ï¼šå°†å‡½æ•°å¥—ç”¨åˆ°DataFrameä¸Šçš„æ¯ä¸ªå…ƒç´ ã€‚

## 3.1.`Map`

ğŸ‘‰ç§»é™¤â€œç‰©ä¸šè´¹â€ä¸­çš„å…ƒï¼š

æ–¹æ³•ä¸€ï¼š

```python
def removeDollar(e):
    return e.split('å…ƒ')[0]
df["ç‰©ä¸šè´¹"].map(removeDollar)
```

>`split`ç”¨æ³•ğŸ‘‰ï¼š[`split`](http://shichaoxin.com/2018/12/30/PythonåŸºç¡€-ç¬¬ä¸‰è¯¾-Pythonåº”ç”¨ä¹‹æ–‡æœ¬çš„è¯é¢‘ç»Ÿè®¡/#1è¯é¢‘ç»Ÿè®¡æ–¹æ³•ä¸€)ã€‚  
>ä¸¾ä¾‹å¦‚ä¸‹ï¼š    
>
>```python
>s="1.5å…ƒ/å¹³ç±³.æœˆ"
s.split("å…ƒ")#è¿”å›ä¸€ä¸ªåˆ—è¡¨['1.5', '/å¹³ç±³.æœˆ']
s.split("å…ƒ")[0]#è¿”å›1.5
>```

æ–¹æ³•äºŒï¼ˆä½¿ç”¨[åŒ¿åå‡½æ•°](http://shichaoxin.com/2018/12/02/PythonåŸºç¡€-ç¬¬äºŒè¯¾-forå¾ªç¯-å®šä¹‰å‡½æ•°å’Œæ¨¡å—å¯¼å…¥/#2pythonè¯­æ³•ä¹‹å‡½æ•°)ï¼‰ï¼š

```python
df["ç‰©ä¸šè´¹"].map(lambda e:e.split('å…ƒ')[0])
```

ä¸¤ç§æ–¹æ³•ç»“æœæ˜¯ä¸€æ ·çš„ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/PythonSeries/Lesson14/14x2.png)

## 3.2.`Apply`

æ–°å»ºå¦‚ä¸‹DataFrameï¼š

```python
df2=pd.DataFrame([[60,70,50],[80,79,68],[63,66,82]],columns=["First","Second","Third"])
```

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/PythonSeries/Lesson14/14x3.png)

```python
df2.apply(lambda e:e.max()-e.min(),axis=0)#é»˜è®¤ä¸ºaxis=0
df2.apply(lambda e:e.max()-e.min(),axis=1)
```

`axis=0`æ—¶æŒ‰åˆ—è¾“å‡ºä¸ºï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/PythonSeries/Lesson14/14x4.png)

`axis=1`æ—¶æŒ‰è¡Œè¾“å‡ºä¸ºï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/PythonSeries/Lesson14/14x5.png)

## 3.3.`ApplyMap`

å°†dfä¸­æ‰€æœ‰â€œæš‚æ— èµ„æ–™â€çš„å…ƒç´ æ›¿ä»£æˆç¼ºå¤±å€¼ï¼ˆNaNï¼‰ï¼š

```python
#æ–¹æ³•ä¸€
def convertNaN(e):
    if e == "æš‚æ— èµ„æ–™":
        return np.nan
    else:
        return e
df.applymap(convertNaN)
#æ–¹æ³•äºŒ
df.applymap(lambda e:np.nan if e=="æš‚æ— èµ„æ–™" else e)
```

# 4.ä»£ç åœ°å€

1. [èµ„æ–™è½¬æ¢](https://github.com/x-jeff/Python_Code_Demo/tree/master/Demo14)