---
layout:     post
title:      【第1章：对程序员来说CPU是什么】条件分支和循环机制
subtitle:   条件分支和循环机制，标志寄存器
date:       2023-01-06
author:     x-jeff
header-img: blogimg/20200220.jpg
catalog: true
tags:
    - How Program Works
---
>博客为参考《程序是怎样跑起来的》一书，自己所做的读书笔记。  
>本文为原创文章，未经本人允许，禁止转载。转载请注明出处。

# 1.条件分支和循环机制

程序的流程分为顺序执行、条件分支和循环三种。**顺序执行**是指按照地址内容的顺序执行指令。**条件分支**是指根据条件执行任意地址的指令。**循环**是指重复执行同一地址的指令。顺序执行的情况比较简单，每执行一个指令程序计数器的值就自动加1。但若程序中存在条件分支和循环，机器语言的指令就可以将程序计数器的值设定为任意地址（不是+1）。接下来以条件分支为例。

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/HowProgramWorks/1.4/1.png)

条件分支和循环中使用的**跳转指令**，会参照当前执行的运算结果来判断是否跳转。[表1-1](http://shichaoxin.com/2022/08/28/第1章-对程序员来说CPU是什么-CPU是寄存器的集合体/#1cpu是寄存器的集合体)所列出的寄存器中，我们提到了标志寄存器。无论当前累加寄存器的运算结果是负数、零还是正数，**标志寄存器**都会将其保存（也负责存放溢出$^1$和奇偶校验$^2$的结果）。

>1. 溢出（overflow）是指运算的结果超出了寄存器的长度范围。
>2. 奇偶校验（parity check）是指检查运算结果的值是偶数还是奇数。

CPU在进行运算时，标志寄存器的数值会根据运算结果自动设定。条件分支在跳转指令前会进行比较运算。至于是否执行跳转指令，则由CPU在参考标志寄存器的数值后进行判断。运算结果的正、零、负三种状态由标志寄存器的三个位表示。图1-6是32位CPU（寄存器的长度是32位）的标志寄存器的示例。标志寄存器的第一个字节位、第二个字节位和第三个字节位的值为1时，表示运算结果分别为正数、零和负数。

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/HowProgramWorks/1.4/2.png)

CPU执行比较的机制很有意思。例如，假设要比较累加寄存器中存储的XXX值和通用寄存器中存储的YYY值，执行比较的指令后，CPU的运算装置就会在内部（暗中）进行XXX-YYY的减法运算。而无论减法运算的结果是正数、零还是负数，都会保存到标志寄存器中。结果为正表示XXX比YYY大，零表示XXX和YYY相等，负表示XXX比YYY小。程序中的比较指令，就是在CPU内部做减法运算。