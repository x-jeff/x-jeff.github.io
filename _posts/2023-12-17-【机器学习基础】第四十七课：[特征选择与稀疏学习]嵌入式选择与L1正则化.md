---
layout:     post
title:      ã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘ç¬¬å››åä¸ƒè¯¾ï¼š[ç‰¹å¾é€‰æ‹©ä¸ç¨€ç–å­¦ä¹ ]åµŒå…¥å¼é€‰æ‹©ä¸L1æ­£åˆ™åŒ–
subtitle:   L1æ­£åˆ™åŒ–ï¼ŒL2æ­£åˆ™åŒ–ï¼Œå²­å›å½’ï¼ŒLASSOï¼Œè¿‘ç«¯æ¢¯åº¦ä¸‹é™ï¼ˆPGDï¼‰ï¼Œè¿ç»­å‡½æ•°ï¼Œä¸€è‡´è¿ç»­ï¼ˆå‡åŒ€è¿ç»­ï¼‰ï¼Œåˆ©æ™®å¸ŒèŒ¨è¿ç»­ï¼ˆLipschitz continuityï¼‰ï¼Œåˆ©æ™®å¸ŒèŒ¨å¸¸æ•°
date:       2023-12-17
author:     x-jeff
header-img: blogimg/20191224.jpg
catalog: true
tags:
    - Machine Learning Series
---
>ã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘ç³»åˆ—åšå®¢ä¸ºå‚è€ƒå‘¨å¿—åè€å¸ˆçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ä¸€ä¹¦ï¼Œè‡ªå·±æ‰€åšçš„è¯»ä¹¦ç¬”è®°ã€‚  
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.åµŒå…¥å¼é€‰æ‹©ä¸L1æ­£åˆ™åŒ–

åœ¨[è¿‡æ»¤å¼](http://shichaoxin.com/2023/07/16/æœºå™¨å­¦ä¹ åŸºç¡€-ç¬¬å››åäº”è¯¾-ç‰¹å¾é€‰æ‹©ä¸ç¨€ç–å­¦ä¹ -è¿‡æ»¤å¼é€‰æ‹©/)å’Œ[åŒ…è£¹å¼](http://shichaoxin.com/2023/09/23/æœºå™¨å­¦ä¹ åŸºç¡€-ç¬¬å››åå…­è¯¾-ç‰¹å¾é€‰æ‹©ä¸ç¨€ç–å­¦ä¹ -åŒ…è£¹å¼é€‰æ‹©/)ç‰¹å¾é€‰æ‹©æ–¹æ³•ä¸­ï¼Œç‰¹å¾é€‰æ‹©è¿‡ç¨‹ä¸å­¦ä¹ å™¨è®­ç»ƒè¿‡ç¨‹æœ‰æ˜æ˜¾çš„åˆ†åˆ«ï¼›ä¸æ­¤ä¸åŒï¼ŒåµŒå…¥å¼ç‰¹å¾é€‰æ‹©æ˜¯å°†ç‰¹å¾é€‰æ‹©è¿‡ç¨‹ä¸å­¦ä¹ å™¨è®­ç»ƒè¿‡ç¨‹èä¸ºä¸€ä½“ï¼Œä¸¤è€…åœ¨åŒä¸€ä¸ªä¼˜åŒ–è¿‡ç¨‹ä¸­å®Œæˆï¼Œå³åœ¨å­¦ä¹ å™¨è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨åœ°è¿›è¡Œäº†ç‰¹å¾é€‰æ‹©ã€‚

ç»™å®šæ•°æ®é›†$D = \\{ (\mathbf{x}_1,y_1), (\mathbf{x}_2,y_2), ...,(\mathbf{x}_m,y_m) \\}$ï¼Œå…¶ä¸­$\mathbf{x} \in \mathbb{R}^d, y\in \mathbb{R}$ã€‚æˆ‘ä»¬è€ƒè™‘æœ€ç®€å•çš„çº¿æ€§å›å½’æ¨¡å‹ï¼Œä»¥å¹³æ–¹è¯¯å·®ä¸ºæŸå¤±å‡½æ•°ï¼Œåˆ™ä¼˜åŒ–ç›®æ ‡ä¸ºï¼š

$$\min_{\mathbf{w}} \sum_{i=1}^m (y_i - \mathbf{w}^T \mathbf{x}_i)^2 \tag{1}$$

å½“æ ·æœ¬ç‰¹å¾å¾ˆå¤šï¼Œè€Œæ ·æœ¬æ•°ç›¸å¯¹è¾ƒå°‘æ—¶ï¼Œå¼(1)å¾ˆå®¹æ˜“é™·å…¥è¿‡æ‹Ÿåˆã€‚ä¸ºäº†ç¼“è§£è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œå¯å¯¹å¼(1)å¼•å…¥æ­£åˆ™åŒ–é¡¹ã€‚è‹¥ä½¿ç”¨$L_2$èŒƒæ•°æ­£åˆ™åŒ–ï¼Œåˆ™æœ‰ï¼š

$$\min_{\mathbf{w}} \sum_{i=1}^m (y_i - \mathbf{w}^T \mathbf{x}_i)^2 + \lambda \parallel \mathbf{w} \parallel_2^2 \tag{2}$$

å…¶ä¸­æ­£åˆ™åŒ–å‚æ•°$\lambda > 0$ã€‚å¼(2)ç§°ä¸ºâ€œå²­å›å½’â€ï¼ˆridge regressionï¼‰ï¼Œé€šè¿‡å¼•å…¥$L_2$èŒƒæ•°æ­£åˆ™åŒ–ï¼Œç¡®èƒ½æ˜¾è‘—é™ä½è¿‡æ‹Ÿåˆçš„é£é™©ã€‚

>å²­å›å½’æœ€åˆç”±A.Tikhonovåœ¨1943å¹´å‘è¡¨äºã€Šè‹è”ç§‘å­¦é™¢é™¢åˆŠã€‹ï¼Œå› æ­¤äº¦ç§°â€œTikhonovå›å½’â€ï¼Œè€Œ$L_2$æ­£åˆ™åŒ–äº¦ç§°â€œTikhonovæ­£åˆ™åŒ–â€ã€‚

é‚£ä¹ˆï¼Œèƒ½å¦å°†æ­£åˆ™åŒ–é¡¹ä¸­çš„$L_2$èŒƒæ•°æ›¿æ¢ä¸º$L_p$èŒƒæ•°å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚è‹¥ä»¤$p=1$ï¼Œå³é‡‡ç”¨$L_1$èŒƒæ•°ï¼Œåˆ™æœ‰ï¼š

$$\min_{\mathbf{w}} \sum_{i=1}^m (y_i - \mathbf{w}^T \mathbf{x}_i)^2 + \lambda \parallel \mathbf{w} \parallel_1 \tag{3}$$

å…¶ä¸­æ­£åˆ™åŒ–å‚æ•°$\lambda>0$ã€‚å¼(3)ç§°ä¸ºLASSOã€‚

>LASSOï¼šLeast Absolute Shrinkage and Selection Operatorï¼Œç›´è¯‘ä¸ºâ€œæœ€å°ç»å¯¹æ”¶ç¼©é€‰æ‹©ç®—å­â€ï¼Œç®€ç§°ä¸ºLASSOã€‚

$L_1$èŒƒæ•°å’Œ$L_2$èŒƒæ•°æ­£åˆ™åŒ–éƒ½æœ‰åŠ©äºé™ä½è¿‡æ‹Ÿåˆé£é™©ï¼Œä½†å‰è€…è¿˜ä¼šå¸¦æ¥ä¸€ä¸ªé¢å¤–çš„å¥½å¤„ï¼šå®ƒæ¯”åè€…æ›´æ˜“äºè·å¾—â€œç¨€ç–â€ï¼ˆsparseï¼‰è§£ï¼Œå³å®ƒæ±‚å¾—çš„$\mathbf{w}$ä¼šæœ‰æ›´å°‘çš„éé›¶åˆ†é‡ã€‚

>äº‹å®ä¸Šï¼Œå¯¹$\mathbf{w}$æ–½åŠ â€œç¨€ç–çº¦æŸâ€ï¼ˆå³å¸Œæœ›$\mathbf{w}$çš„éé›¶åˆ†é‡å°½å¯èƒ½å°‘ï¼‰æœ€è‡ªç„¶çš„æ˜¯ä½¿ç”¨$L_0$èŒƒæ•°ï¼Œä½†$L_0$èŒƒæ•°ä¸è¿ç»­ï¼Œéš¾ä»¥ä¼˜åŒ–æ±‚è§£ï¼Œå› æ­¤å¸¸ä½¿ç”¨$L_1$èŒƒæ•°æ¥è¿‘ä¼¼ã€‚

ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç›´è§‚çš„ä¾‹å­ï¼šå‡å®š$\mathbf{x}$ä»…æœ‰ä¸¤ä¸ªå±æ€§ï¼Œäºæ˜¯æ— è®ºå¼(2)è¿˜æ˜¯å¼(3)è§£å‡ºçš„$\mathbf{w}$éƒ½åªæœ‰ä¸¤ä¸ªåˆ†é‡ï¼Œå³$w_1,w_2$ï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºä¸¤ä¸ªåæ ‡è½´ï¼Œç„¶ååœ¨å›¾ä¸­ç»˜åˆ¶å‡ºå¼(2)ä¸(3)çš„ç¬¬ä¸€é¡¹çš„â€œç­‰å€¼çº¿â€ï¼Œå³åœ¨$(w_1,w_2)$ç©ºé—´ä¸­å¹³æ–¹è¯¯å·®é¡¹å–å€¼ç›¸åŒçš„ç‚¹çš„è¿çº¿ï¼Œå†åˆ†åˆ«ç»˜åˆ¶å‡º$L_1$èŒƒæ•°ä¸$L_2$èŒƒæ•°çš„ç­‰å€¼çº¿ï¼Œå³åœ¨$(w_1,w_2)$ç©ºé—´ä¸­$L_1$èŒƒæ•°å–å€¼ç›¸åŒçš„ç‚¹çš„è¿çº¿ï¼Œä»¥åŠ$L_2$èŒƒæ•°å–å€¼ç›¸åŒçš„ç‚¹çš„è¿çº¿ï¼Œå¦‚å›¾11.2æ‰€ç¤ºã€‚å¼(2)ä¸(3)çš„è§£è¦åœ¨å¹³æ–¹è¯¯å·®é¡¹ä¸æ­£åˆ™åŒ–é¡¹ä¹‹é—´æŠ˜ä¸­ï¼Œå³å‡ºç°åœ¨å›¾ä¸­å¹³æ–¹è¯¯å·®é¡¹ç­‰å€¼çº¿ä¸æ­£åˆ™åŒ–é¡¹ç­‰å€¼çº¿ç›¸äº¤å¤„ã€‚ç”±å›¾11.2å¯çœ‹å‡ºï¼Œé‡‡ç”¨$L_1$èŒƒæ•°æ—¶å¹³æ–¹è¯¯å·®é¡¹ç­‰å€¼çº¿ä¸æ­£åˆ™åŒ–é¡¹ç­‰å€¼çº¿çš„äº¤ç‚¹å¸¸å‡ºç°åœ¨åæ ‡è½´ä¸Šï¼Œå³$w_1$æˆ–$w_2$ä¸º0ï¼Œè€Œåœ¨é‡‡ç”¨$L_2$èŒƒæ•°æ—¶ï¼Œä¸¤è€…çš„äº¤ç‚¹å¸¸å‡ºç°åœ¨æŸä¸ªè±¡é™ä¸­ï¼Œå³$w_1$æˆ–$w_2$å‡é0ï¼›æ¢è¨€ä¹‹ï¼Œé‡‡ç”¨$L_1$èŒƒæ•°æ¯”$L_2$èŒƒæ•°æ›´æ˜“äºå¾—åˆ°ç¨€ç–è§£ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/MachineLearningSeries/Lesson47/47x1.png)

æ³¨æ„åˆ°$\mathbf{w}$å–å¾—ç¨€ç–è§£æ„å‘³ç€åˆå§‹çš„$d$ä¸ªç‰¹å¾ä¸­ä»…æœ‰å¯¹åº”ç€$\mathbf{w}$çš„éé›¶åˆ†é‡çš„ç‰¹å¾æ‰ä¼šå‡ºç°åœ¨æœ€ç»ˆæ¨¡å‹ä¸­ï¼Œäºæ˜¯ï¼Œæ±‚è§£$L_1$èŒƒæ•°æ­£åˆ™åŒ–çš„ç»“æœæ˜¯å¾—åˆ°äº†ä»…é‡‡ç”¨ä¸€éƒ¨åˆ†åˆå§‹ç‰¹å¾çš„æ¨¡å‹ï¼›æ¢è¨€ä¹‹ï¼ŒåŸºäº$L_1$æ­£åˆ™åŒ–çš„å­¦ä¹ æ–¹æ³•å°±æ˜¯ä¸€ç§åµŒå…¥å¼ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼Œå…¶ç‰¹å¾é€‰æ‹©è¿‡ç¨‹ä¸å­¦ä¹ å™¨è®­ç»ƒè¿‡ç¨‹èä¸ºä¸€ä½“ï¼ŒåŒæ—¶å®Œæˆã€‚

$L_1$æ­£åˆ™åŒ–é—®é¢˜çš„æ±‚è§£å¯ä½¿ç”¨è¿‘ç«¯æ¢¯åº¦ä¸‹é™ï¼ˆProximal Gradient Descentï¼Œç®€ç§°PGDï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œä»¤$\nabla$è¡¨ç¤ºå¾®åˆ†ç®—å­ï¼Œå¯¹ä¼˜åŒ–ç›®æ ‡ï¼š

$$\min_{\mathbf{x}} f(\mathbf{x}) + \lambda \parallel \mathbf{x} \parallel _1 \tag{4}$$

è‹¥$f(\mathbf{x})$å¯å¯¼ï¼Œä¸”$\nabla f$æ»¡è¶³L-Lipschitzæ¡ä»¶ï¼ˆè§æœ¬æ–‡ç¬¬2éƒ¨åˆ†ï¼‰ï¼Œå³å­˜åœ¨å¸¸æ•°$L>0$ä½¿å¾—ï¼š

$$\parallel \nabla f(\mathbf{x}') - \nabla f(\mathbf{x}) \parallel ^2_2 \leqslant L \parallel \mathbf{x}' - \mathbf{x} \parallel ^2_2 \   (\forall \mathbf{x}, \mathbf{x'}) \tag{5}$$

åˆ™åœ¨$\mathbf{x}_k$é™„è¿‘å¯å°†$f(\mathbf{x})$é€šè¿‡äºŒé˜¶æ³°å‹’å±•å¼è¿‘ä¼¼ä¸ºï¼š

$$\begin{align} \hat{f} (\mathbf{x}) & \simeq f(\mathbf{x}_k) + \langle \nabla f(\mathbf{x}_k), \mathbf{x}-\mathbf{x}_k \rangle + \frac{L}{2} \parallel \mathbf{x} - \mathbf{x}_k \parallel ^2 \\ &=  \frac{L}{2} \parallel \mathbf{x} - ( \mathbf{x}_k - \frac{1}{L} \nabla f(\mathbf{x}_k) ) \parallel _2^2 + \text{const} \end{align} \tag{6}$$

å…¶ä¸­$\text{const}$æ˜¯ä¸$\mathbf{x}$æ— å…³çš„å¸¸æ•°ï¼Œ$\langle \cdot, \cdot \rangle$è¡¨ç¤ºå†…ç§¯ã€‚æ˜¾ç„¶ï¼Œå¼(6)çš„æœ€å°å€¼åœ¨å¦‚ä¸‹$\mathbf{x}_{k+1}$è·å¾—ï¼š

$$\mathbf{x}_{k+1} = \mathbf{x}_k - \frac{1}{L} \nabla f(\mathbf{x}_k) \tag{7}$$

äºæ˜¯ï¼Œè‹¥é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•å¯¹$f(\mathbf{x})$è¿›è¡Œæœ€å°åŒ–ï¼Œåˆ™æ¯ä¸€æ­¥æ¢¯åº¦ä¸‹é™è¿­ä»£å®é™…ä¸Šç­‰ä»·äºæœ€å°åŒ–äºŒæ¬¡å‡½æ•°$\hat{f}(\mathbf{x})$ã€‚å°†è¿™ä¸ªæ€æƒ³æ¨å¹¿åˆ°å¼(4)ï¼Œåˆ™èƒ½ç±»ä¼¼åœ°å¾—åˆ°å…¶æ¯ä¸€æ­¥è¿­ä»£åº”ä¸ºï¼š

$$\mathbf{x}_{k+1} = \arg \min_{\mathbf{x}} \frac{L}{2} \left \| \mathbf{x} - \left( \mathbf{x}_k - \frac{1}{L} \nabla f(\mathbf{x}_k) \right) \right \|_2^2 + \lambda \left \| \mathbf{x} \right \|_1 \tag{8}$$

å³åœ¨æ¯ä¸€æ­¥å¯¹$f(\mathbf{x})$è¿›è¡Œæ¢¯åº¦ä¸‹é™è¿­ä»£çš„åŒæ—¶è€ƒè™‘$L_1$èŒƒæ•°æœ€å°åŒ–ã€‚

å¯¹äºå¼(8)ï¼Œå¯å…ˆè®¡ç®—$\mathbf{z} = \mathbf{x}_k - \frac{1}{L} \nabla f (\mathbf{x}_k)$ï¼Œç„¶åæ±‚è§£ã€‚

$$\mathbf{x}_{k+1} = \arg \min_{\mathbf{x}} \frac{L}{2} \left \| \mathbf{x} - \mathbf{z} \right \|_2^2 + \lambda \left \| \mathbf{x} \right \| _1 \tag{9}$$

ä»¤$x^i$è¡¨ç¤º$\mathbf{x}$çš„ç¬¬$i$ä¸ªåˆ†é‡ï¼Œå°†å¼(9)æŒ‰åˆ†é‡å±•å¼€å¯çœ‹å‡ºï¼Œå…¶ä¸­ä¸å­˜åœ¨$x^ix^j$ï¼ˆ$i \neq j$ï¼‰è¿™æ ·çš„é¡¹ï¼Œå³$\mathbf{x}$çš„å„åˆ†é‡äº’ä¸å½±å“ï¼Œäºæ˜¯å¼(9)æœ‰é—­å¼è§£ã€‚

$$x_{k+1}^i =
\begin{cases} 
z^i - \lambda / L,  & \lambda/L < z^i; \\
0, & \lvert z^i \rvert \leqslant \lambda/L; \\
z^i + \lambda / L, & z^i < -\lambda / L,
\end{cases} \tag{10}$$

å…¶ä¸­$x_{k+1}^i$ä¸$z^i$åˆ†åˆ«æ˜¯$\mathbf{x}_{k+1}$ä¸$\mathbf{z}$çš„ç¬¬$i$ä¸ªåˆ†é‡ã€‚å› æ­¤ï¼Œé€šè¿‡PGDèƒ½ä½¿LASSOå’Œå…¶ä»–åŸºäº$L_1$èŒƒæ•°æœ€å°åŒ–çš„æ–¹æ³•å¾—ä»¥å¿«é€Ÿæ±‚è§£ã€‚

# 2.åˆ©æ™®å¸ŒèŒ¨è¿ç»­

## 2.1.è¿ç»­å‡½æ•°

**è¿ç»­å‡½æ•°**ï¼ˆcontinuous functionï¼‰æ˜¯æŒ‡å‡½æ•°åœ¨æ•°å­¦ä¸Šçš„å±æ€§ä¸ºè¿ç»­ã€‚ç›´è§‚ä¸Šæ¥è¯´ï¼Œè¿ç»­çš„å‡½æ•°å°±æ˜¯å½“è¾“å…¥å€¼çš„å˜åŒ–è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œè¾“å‡ºçš„å˜åŒ–ä¹Ÿä¼šéšä¹‹è¶³å¤Ÿå°çš„å‡½æ•°ã€‚

å¦‚æœè¾“å…¥å€¼çš„æŸç§å¾®å°çš„å˜åŒ–ä¼šäº§ç”Ÿè¾“å‡ºå€¼çš„ä¸€ä¸ªçªç„¶çš„è·³è·ƒç”šè‡³æ— æ³•å®šä¹‰ï¼Œåˆ™è¿™ä¸ªå‡½æ•°è¢«ç§°ä¸ºæ˜¯ä¸è¿ç»­å‡½æ•°ï¼Œæˆ–è€…è¯´å…·æœ‰ä¸è¿ç»­æ€§ã€‚éè¿ç»­å‡½æ•°ä¸€å®šå­˜åœ¨é—´æ–­ç‚¹ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/MachineLearningSeries/Lesson47/47x2.png)

## 2.2.ä¸€è‡´è¿ç»­

**ä¸€è‡´è¿ç»­**åˆç§°**å‡åŒ€è¿ç»­**ï¼ˆuniformly continuousï¼‰ï¼Œæ˜¯æ¯”è¿ç»­æ›´è‹›åˆ»çš„æ¡ä»¶ã€‚

è®¾å‡½æ•°$f(x)$åœ¨åŒºé—´$I$ä¸Šæœ‰å®šä¹‰ï¼Œ$\forall \epsilon > 0, \exists \delta > 0$ï¼Œä½¿å¾—å¯¹äºåŒºé—´$I$ä¸Šçš„ä»»æ„ä¸¤ç‚¹$x_1,x_2$ï¼Œå½“$\lvert x_1-x_2 \rvert < \delta$æ—¶ï¼Œæœ‰$\lvert f(x_1) - f(x_2) \rvert < \epsilon$ã€‚é‚£ä¹ˆç§°å‡½æ•°$f(x)$åœ¨åŒºé—´$I$ä¸Šä¸€è‡´è¿ç»­ã€‚

ä¸€è‡´è¿ç»­å¯¹æ¯”è¿ç»­å®é™…ä¸Šå¤šäº†ä¸€ä¸ªæ¡ä»¶ï¼š

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/MachineLearningSeries/Lesson47/47x3.png)

## 2.3.åˆ©æ™®å¸ŒèŒ¨è¿ç»­

åœ¨æ•°å­¦ä¸­ï¼Œç‰¹åˆ«æ˜¯å®åˆ†æï¼Œ**åˆ©æ™®å¸ŒèŒ¨è¿ç»­**ï¼ˆLipschitz continuityï¼‰ä»¥å¾·å›½æ•°å­¦å®¶é²é“å¤«Â·åˆ©æ™®å¸ŒèŒ¨å‘½åï¼Œæ˜¯ä¸€ä¸ªæ¯”ä¸€è‡´è¿ç»­æ›´å¼ºçš„å…‰æ»‘æ€§æ¡ä»¶ã€‚ç›´è§‰ä¸Šï¼Œåˆ©æ™®å¸ŒèŒ¨è¿ç»­å‡½æ•°é™åˆ¶äº†å‡½æ•°æ”¹å˜çš„é€Ÿåº¦ï¼Œç¬¦åˆåˆ©æ™®å¸ŒèŒ¨æ¡ä»¶çš„å‡½æ•°çš„æ–œç‡ï¼Œå¿…å°äºä¸€ä¸ªç§°ä¸ºåˆ©æ™®å¸ŒèŒ¨å¸¸æ•°çš„å®æ•°ï¼ˆè¯¥å¸¸æ•°ä¾å‡½æ•°è€Œå®šï¼‰ã€‚

ğŸ‘‰å®šä¹‰ï¼šå¯¹äºåœ¨å®æ•°é›†çš„å­é›†çš„å‡½æ•°$f : D \subseteq \mathbb{R} \to \mathbb{R}$ï¼Œè‹¥å­˜åœ¨å¸¸æ•°$K$ï¼Œä½¿å¾—$\lvert f(a) - f(b) \rvert \leqslant K \lvert a - b \rvert \quad \forall a,b \in D$ï¼Œåˆ™ç§°$f$ç¬¦åˆåˆ©æ™®å¸ŒèŒ¨æ¡ä»¶ï¼Œå¯¹äº$f$æœ€å°çš„å¸¸æ•°$K$ç§°ä¸º$f$çš„**åˆ©æ™®å¸ŒèŒ¨å¸¸æ•°**ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/MachineLearningSeries/Lesson47/47x4.png)

å¯¹äºåˆ©æ™®å¸ŒèŒ¨è¿ç»­å‡½æ•°ï¼Œå­˜åœ¨ä¸€ä¸ªåŒåœ†é”¥ï¼ˆç™½è‰²ï¼‰å…¶é¡¶ç‚¹å¯ä»¥æ²¿ç€æ›²çº¿å¹³ç§»ï¼Œä½¿å¾—æ›²çº¿æ€»æ˜¯å®Œå…¨åœ¨è¿™ä¸¤ä¸ªåœ†é”¥å¤–ã€‚

# 3.å¼(6)çš„æ¨å¯¼

æ ¹æ®æˆ‘ä»¬åœ¨wikiç™¾ç§‘ä¸­æŸ¥åˆ°çš„åˆ©æ™®å¸ŒèŒ¨è¿ç»­çš„å®šä¹‰ï¼ˆè§ç¬¬2.3éƒ¨åˆ†ï¼‰ï¼Œå¼(5)åº”è¯¥å†™æˆï¼š

$$\lvert \nabla f(\mathbf{x}') - \nabla f(\mathbf{x}) \rvert \leqslant L \lvert \mathbf{x}' - \mathbf{x} \rvert \quad (\forall \mathbf{x},\mathbf{x}')$$

ç§»é¡¹å¾—ï¼š

$$\frac{\lvert \nabla f(\mathbf{x}') - \nabla f(\mathbf{x}) \rvert }{\lvert \mathbf{x}' - \mathbf{x} \rvert} \leqslant L \quad (\forall \mathbf{x},\mathbf{x}')$$

ç”±äºä¸Šå¼å¯¹æ‰€æœ‰çš„$\mathbf{x},\mathbf{x}'$éƒ½æˆç«‹ï¼Œç”±å¯¼æ•°çš„å®šä¹‰ï¼Œä¸Šå¼å¯ä»¥çœ‹æˆæ˜¯$f(\mathbf{x})$çš„äºŒé˜¶å¯¼æ•°æ’ä¸å¤§äº$L$ã€‚å³ï¼š

$$\nabla ^2 f(\mathbf{x}) \leqslant L$$

ç”±[æ³°å‹’å…¬å¼](http://shichaoxin.com/2019/07/10/æ•°å­¦åŸºç¡€-ç¬¬å…­è¯¾-æ¢¯åº¦ä¸‹é™æ³•å’Œç‰›é¡¿æ³•/#1æ³°å‹’å…¬å¼)ï¼Œ$\mathbf{x}_k$é™„è¿‘çš„$f(\mathbf{x})$é€šè¿‡äºŒé˜¶æ³°å‹’å±•å¼€å¼å¯è¿‘ä¼¼ä¸ºï¼š

$$\begin{align} 
\hat{f} (\mathbf{x}) 
& \simeq f(\mathbf{x}_k) + \langle \nabla f(\mathbf{x}_k), \mathbf{x}-\mathbf{x}_k \rangle + \frac{\nabla ^2 f(\mathbf{x}_k)}{2} \parallel \mathbf{x} - \mathbf{x}_k \parallel ^2
\\& \leqslant f(\mathbf{x}_k) + \langle \nabla f(\mathbf{x}_k), \mathbf{x}-\mathbf{x}_k \rangle + \frac{L}{2} \parallel \mathbf{x} - \mathbf{x}_k \parallel ^2
\\&= f(\mathbf{x}_k) + \nabla f(\mathbf{x}_k)^{\top} (\mathbf{x} - \mathbf{x}_k) + \frac{L}{2} (\mathbf{x} - \mathbf{x}_k)^{\top} (\mathbf{x} - \mathbf{x}_k)
\\&= f(\mathbf{x}_k) + \frac{L}{2} \left( (\mathbf{x} - \mathbf{x}_k)^{\top} (\mathbf{x} - \mathbf{x}_k) + \frac{2}{L} \nabla f(\mathbf{x}_k)^{\top} (\mathbf{x} - \mathbf{x}_k) \right)
\\&= f(\mathbf{x}_k) + \frac{L}{2} \left( (\mathbf{x} - \mathbf{x}_k)^{\top} (\mathbf{x} - \mathbf{x}_k) + \frac{2}{L} \nabla f(\mathbf{x}_k)^{\top} (\mathbf{x} - \mathbf{x}_k) + \frac{1}{L^2} \nabla f(\mathbf{x}_k)^{\top} \nabla f(\mathbf{x}_k) \right) - \frac{1}{2L} \nabla f(\mathbf{x}_k)^{\top} \nabla f(\mathbf{x}_k)
\\&= f(\mathbf{x}_k) +\frac{L}{2} \left( (\mathbf{x} - \mathbf{x}_k) + \frac{1}{L} \nabla f (\mathbf{x}_k) \right)^{\top} \left( (\mathbf{x} - \mathbf{x}_k) + \frac{1}{L} \nabla f (\mathbf{x}_k) \right) - \frac{1}{2L} \nabla f(\mathbf{x}_k)^{\top} \nabla f(\mathbf{x}_k)
\\&= \frac{L}{2} \left \| \mathbf{x} - \left( \mathbf{x}_k - \frac{1}{L} \nabla f(\mathbf{x}_k) \right) \right \|_2^2 + \text{const}
\end{align}$$

>$\langle ... \rangle$ä¸º[çŸ©é˜µå†…ç§¯](http://shichaoxin.com/2022/10/19/æœºå™¨å­¦ä¹ åŸºç¡€-ç¬¬å››åè¯¾-é™ç»´ä¸åº¦é‡å­¦ä¹ -ä¸»æˆåˆ†åˆ†æ/#2çŸ©é˜µçš„å†…ç§¯)ã€‚

å…¶ä¸­ï¼Œ

$$\text{const} = f(\mathbf{x}_k) - \frac{1}{2L} \nabla f(\mathbf{x}_k)^{\top} \nabla f(\mathbf{x}_k)$$

# 4.å¼(10)çš„æ¨å¯¼

ä»¤ä¼˜åŒ–å‡½æ•°ï¼š

$$\begin{align}
g(\mathbf{x})
&= \frac{L}{2} \left \| \mathbf{x} - \mathbf{z} \right \| _2^2 + \lambda \left \| \mathbf{x} \right \| _1
\\&= \frac{L}{2} \sum_{i=1}^d \left \| x^i - z^i \right \| _2^2 + \lambda \sum_{i=1}^d \left \| x^i \right \|_1
\\&= \sum_{i=1}^d \left( \frac{L}{2} (x^i - z^i)^2 + \lambda \lvert x^i \rvert \right)
\end{align}$$

è¿™ä¸ªå¼å­è¡¨æ˜ä¼˜åŒ–$g(\mathbf{x})$å¯ä»¥è¢«æ‹†è§£æˆä¼˜åŒ–$\mathbf{x}$çš„å„ä¸ªåˆ†é‡çš„å½¢å¼ï¼Œå¯¹åˆ†é‡$x^i$ï¼Œå…¶ä¼˜åŒ–å‡½æ•°ï¼š

$$g(x^i) = \frac{L}{2} (x^i - z^i)^2 + \lambda \lvert x^i \rvert$$

æ±‚å¯¼å¾—ï¼š

$$\frac{dg(x^i)}{dx^i} = L(x^i - z^i) + \lambda \text{sign} (x^i)$$

å…¶ä¸­ï¼š

$$\text{sign} (x^i) =
\begin{cases} 
1,  & x^i > 0 \\
-1, & x^i < 0
\end{cases}$$

ç§°ä¸ºç¬¦å·å‡½æ•°ï¼Œå¯¹äº$x^i = 0$çš„ç‰¹æ®Šæƒ…å†µï¼Œç”±äº$\lvert x^i \rvert$åœ¨$x^i = 0$å¤„ä¸å…‰æ»‘ï¼Œæ‰€ä»¥å…¶ä¸å¯å¯¼ï¼Œéœ€å•ç‹¬è®¨è®ºã€‚ä»¤$\frac{dg(x^i)}{dx^i}=0$æœ‰ï¼š

$$x^i = z^i - \frac{\lambda}{L} \text{sign} (x^i)$$

æ­¤å¼çš„è§£å³ä¸ºä¼˜åŒ–ç›®æ ‡$g(x^i)$çš„æå€¼ç‚¹ï¼Œå› ä¸ºç­‰å¼ä¸¤ç«¯å‡å«æœ‰æœªçŸ¥å˜é‡$x^i$ï¼Œæ•…åˆ†æƒ…å†µè®¨è®ºã€‚

1ï¸âƒ£å½“$z^i >\frac{\lambda}{L}$æ—¶ï¼š

ğŸ‘‰å‡è®¾$x^i<0$ï¼Œåˆ™$\text{sign}(x^i)=-1$ï¼Œé‚£ä¹ˆæœ‰$x^i = z^i + \frac{\lambda}{L} > 0$ä¸å‡è®¾çŸ›ç›¾ã€‚

ğŸ‘‰å‡è®¾$x^i>0$ï¼Œåˆ™$\text{sign}(x^i)=1$ï¼Œé‚£ä¹ˆæœ‰$x^i = z^i - \frac{\lambda}{L} > 0$å’Œå‡è®¾ç›¸ç¬¦åˆï¼Œä¸‹é¢æ¥æ£€éªŒ$x^i = z^i - \frac{\lambda}{L}$èƒ½å¦ä½¿å‡½æ•°$g(x^i)$å–å¾—æœ€å°å€¼ã€‚å½“$x^i > 0$æ—¶ï¼Œ

$$\frac{dg(x^i)}{dx^i} = L(x^i - z^i) + \lambda$$

åœ¨å®šä¹‰åŸŸå†…è¿ç»­å¯å¯¼ï¼Œåˆ™$g(x^i)$çš„äºŒé˜¶å¯¼æ•°ï¼š

$$\frac{d^2 g(x^i)}{d{x^i}^2} = L$$

ç”±äº$L$æ˜¯Lipschitzå¸¸æ•°æ’å¤§äº0ï¼ˆæ­¤æ—¶ä¸º[å‡¸å‡½æ•°](http://shichaoxin.com/2019/02/25/æ•°å­¦åŸºç¡€-ç¬¬å››è¯¾-å¯¼æ•°/#12é«˜é˜¶å¯¼æ•°)ï¼‰ï¼Œå› æ­¤$x^i = z^i - \frac{\lambda}{L}$æ˜¯å‡½æ•°$g(x^i)$çš„æœ€å°å€¼ã€‚

ğŸ‘‰å‡è®¾$x^i=0$ï¼Œæ­¤æ—¶$g(x^i) = \frac{L}{2} (z^i)^2$ï¼Œæˆ‘ä»¬æ¥æ¯”è¾ƒä¸‹$x^i=0$æ—¶çš„$g(x^i)$å’Œä¸Šé¢æ±‚å¾—çš„æœ€å°å€¼ç›¸æ¯”å“ªä¸ªæ›´å°ã€‚

$$\begin{align}
g(x^i) \mid _{x^i = 0} - g(x^i) \mid _{x^i = z^i - \frac{\lambda}{L}}
&= \frac{L}{2} (z^i)^2 - \left( \lambda z^i - \frac{\lambda^2}{2L} \right)
\\& = \frac{L}{2} \left( z^i - \frac{\lambda}{L} \right)^2
\\& > 0
 \end{align}$$
 
è¯´æ˜$x^i = 0$å¹¶æ²¡æœ‰å–å¾—æ›´å°çš„å€¼ã€‚

2ï¸âƒ£å½“$z^i < - \frac{\lambda}{L}$æ—¶ï¼š

ğŸ‘‰å‡è®¾$x^i > 0$ï¼Œåˆ™$\text{sign} (x^i) = 1$ï¼Œé‚£ä¹ˆæœ‰$x^i = z^i - \frac{\lambda}{L}<0$ä¸å‡è®¾çŸ›ç›¾ã€‚

ğŸ‘‰å‡è®¾$x^i < 0$ï¼Œåˆ™$\text{sign} (x^i) = -1$ï¼Œé‚£ä¹ˆæœ‰$x^i = z^i + \frac{\lambda}{L} < 0$ä¸å‡è®¾ç›¸ç¬¦ï¼Œç”±ä¸Šè¿°äºŒé˜¶å¯¼æ•°æ’å¤§äº0å¯çŸ¥ï¼Œ$x^i = z^i + \frac{\lambda}{L}$æ˜¯å‡½æ•°$g(x^i)$çš„æœ€å°å€¼ã€‚

ğŸ‘‰å‡è®¾$x^i = 0$ï¼Œæ­¤æ—¶$g(x^i) = \frac{L}{2} (z^i)^2$ï¼ŒåŒæ ·å’Œä¸Šé¢æ±‚å¾—çš„æœ€å°å€¼è¿›è¡Œæ¯”è¾ƒã€‚

$$\begin{align}
g(x^i) \mid _{x^i = 0} - g(x^i) \mid _{x^i = z^i + \frac{\lambda}{L}}
&= \frac{L}{2} (z^i)^2 - \left( -\lambda z^i - \frac{\lambda^2}{2L} \right)
\\& = \frac{L}{2} \left( z^i + \frac{\lambda}{L} \right)^2
\\& > 0
 \end{align}$$
 
è¯´æ˜$x^i = 0$å¹¶æ²¡æœ‰å–å¾—æ›´å°çš„å€¼ã€‚

3ï¸âƒ£å½“$-\frac{\lambda}{L} \leqslant z^i \leqslant \frac{\lambda}{L}$æ—¶ï¼š

ğŸ‘‰å‡è®¾$x^i > 0$ï¼Œåˆ™$\text{sign} (x^i) = 1$ï¼Œé‚£ä¹ˆæœ‰$x^i = z^i - \frac{\lambda}{L} \leqslant 0$ä¸å‡è®¾çŸ›ç›¾ã€‚

ğŸ‘‰å‡è®¾$x^i < 0$ï¼Œåˆ™$\text{sign} (x^i) = -1$ï¼Œé‚£ä¹ˆæœ‰$x^i = z^i + \frac{\lambda}{L} \geqslant 0$ä¸å‡è®¾çŸ›ç›¾ã€‚

ğŸ‘‰å‡è®¾$x^i = 0$ï¼Œå¯¹äºä»»ä½•$\Delta x \neq 0$æœ‰ï¼š

$\Delta x > 0$æ—¶ï¼š

$$\begin{align}
g(\Delta x)
&= \frac{L}{2} (\Delta x -z^i)^2 + \lambda \lvert \Delta x \rvert
\\&= \frac{L}{2} \left( (\Delta x)^2 - 2\Delta x \cdot z^i + \frac{2\lambda}{L} \lvert \Delta x \rvert \right) + \frac{L}{2} (z^i)^2
\\&= \frac{L}{2} \left( (\Delta x)^2 - 2\Delta x \cdot z^i + \frac{2\lambda}{L} \Delta x \right) + \frac{L}{2} (z^i)^2
\\&= \frac{L}{2} \left( (\Delta x)^2 + 2\Delta x (\frac{\lambda}{L} - z^i) \right) + \frac{L}{2} (z^i)^2
\\& \geqslant \frac{L}{2} (\Delta x)^2 + \frac{L}{2} (z^i)^2
\\& > g(x^i) \mid _{x^i = 0}
\end{align}$$

$\Delta x < 0$æ—¶ï¼š

$$\begin{align}
g(\Delta x)
&= \frac{L}{2} (\Delta x -z^i)^2 + \lambda \lvert \Delta x \rvert
\\&= \frac{L}{2} \left( (\Delta x)^2 - 2\Delta x \cdot z^i + \frac{2\lambda}{L} \lvert \Delta x \rvert \right) + \frac{L}{2} (z^i)^2
\\&= \frac{L}{2} \left( (\Delta x)^2 - 2\Delta x \cdot z^i - \frac{2\lambda}{L} \Delta x \right) + \frac{L}{2} (z^i)^2
\\&= \frac{L}{2} \left( (\Delta x)^2 - 2\Delta x (\frac{\lambda}{L} + z^i) \right) + \frac{L}{2} (z^i)^2
\\& \geqslant \frac{L}{2} (\Delta x)^2 + \frac{L}{2} (z^i)^2
\\& > g(x^i) \mid _{x^i = 0}
\end{align}$$

å› æ­¤ï¼Œ$x^i = 0$æ˜¯$g(x^i)$çš„æœ€å°å€¼ç‚¹ã€‚

# 5.å‚è€ƒèµ„æ–™

1. [å—ç“œä¹¦PumpkinBook](https://datawhalechina.github.io/pumpkin-book/#/chapter11/chapter11?id=_1110)
2. [åˆ©æ™®å¸ŒèŒ¨è¿ç»­ï¼ˆwikiç™¾ç§‘ï¼‰](https://zh.wikipedia.org/wiki/åˆ©æ™®å¸ŒèŒ¨é€£çºŒ)
3. [è¿ç»­å‡½æ•°ï¼ˆwikiç™¾ç§‘ï¼‰](https://zh.wikipedia.org/wiki/è¿ç»­å‡½æ•°)
4. [å‡½æ•°è¿ç»­å’Œä¸€è‡´è¿ç»­æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¼€åŒºé—´ä¸Šçš„è¿ç»­å‡½æ•°ä¸ä¸€å®šæ˜¯ä¸€è‡´è¿ç»­çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ](https://www.zhihu.com/tardis/bd/ans/132985572?source_id=1001)