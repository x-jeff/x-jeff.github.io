---
layout:     post
title:      ã€è®ºæ–‡é˜…è¯»ã€‘FlowNetï¼šLearning Optical Flow with Convolutional Networks
subtitle:   FlowNet
date:       2023-07-03
author:     x-jeff
header-img: blogimg/20220411.jpg
catalog: true
tags:
    - Optical Flow Estimation
---  
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.Introduction

CNNåœ¨CVçš„è®¸å¤šé¢†åŸŸå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚å…¶è¢«åº”ç”¨äºå›¾åƒåˆ†ç±»ã€è¯­ä¹‰åˆ†å‰²ã€åŸºäºå•å¼ å›¾åƒçš„æ·±åº¦ä¼°è®¡ç­‰ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è®­ç»ƒäº†ä¸€ä¸ªç«¯åˆ°ç«¯çš„CNNç½‘ç»œï¼Œä»¥ä»ä¸€å¯¹å›¾åƒä¸­é¢„æµ‹å‡ºå…‰æµåœºã€‚

å…‰æµä¼°è®¡å³éœ€è¦ç²¾ç¡®å®šä½æ¯ä¸ªåƒç´ ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦æ‰¾åˆ°ä¸¤å¼ è¾“å…¥å›¾åƒä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚è¿™ä¸ä»…æ¶‰åŠå¯¹å›¾åƒè¡¨å¾çš„å­¦ä¹ ï¼Œè¿˜æ¶‰åŠå­¦ä¹ åœ¨ä¸¤å¹…å›¾åƒä¸­çš„ä¸åŒä½ç½®å»åŒ¹é…è¿™äº›ç‰¹å¾ã€‚åœ¨è¿™æ–¹é¢ï¼Œå…‰æµä¼°è®¡å’Œä¹‹å‰çš„é‚£äº›åŸºäºCNNçš„åº”ç”¨æœ‰ç€æœ¬è´¨çš„ä¸åŒã€‚

ç”±äºå°šä¸æ¸…æ¥šè¿™é¡¹ä»»åŠ¡æ˜¯å¦å¯ä»¥ç”¨æ ‡å‡†çš„CNNæ¡†æ¶æ¥å®Œæˆï¼Œæˆ‘ä»¬è¿˜å¼€å‘äº†ä¸€ä¸ªå¸¦æœ‰ç›¸å…³å±‚ï¼ˆcorrelation layerï¼‰çš„æ¡†æ¶ï¼Œå…¶å¯ä»¥æ˜ç¡®æä¾›åŒ¹é…èƒ½åŠ›ã€‚è¯¥æ¡†æ¶çš„è®­ç»ƒæ˜¯ç«¯åˆ°ç«¯çš„ã€‚æƒ³æ³•æ˜¯åˆ©ç”¨CNNåœ¨å¤šå°ºåº¦å’Œå¤šæŠ½è±¡çº§åˆ«ä¸Šå­¦ä¹ å¼ºç‰¹å¾çš„èƒ½åŠ›ï¼Œä»¥å¸®åŠ©å¯»æ‰¾åŸºäºè¿™äº›ç‰¹å¾çš„å®é™…å¯¹åº”å…³ç³»ã€‚ç›¸å…³å±‚åç»­çš„å±‚ç”¨äºå­¦ä¹ ä»è¿™äº›åŒ¹é…ä¸­é¢„æµ‹æµã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå³ä½¿ä¸ä½¿ç”¨ç›¸å…³å±‚ï¼ŒåŸå§‹çš„ç½‘ç»œä¹Ÿèƒ½å¾—åˆ°å…·æœ‰ç«äº‰åŠ›çš„å‡†ç¡®ç‡ã€‚

è®­ç»ƒè¿™æ ·çš„ç½‘ç»œé€šå¸¸éœ€è¦ä¸€ä¸ªå¾ˆå¤§çš„è®­ç»ƒé›†ã€‚å°½ç®¡æœ‰æ•°æ®æ‰©å±•çš„å¸®åŠ©ï¼Œä½†ç°æœ‰çš„å…‰æµæ•°æ®é›†ä»ç„¶å¤ªå°ï¼Œæ— æ³•è®­ç»ƒå‡ºä¸€ä¸ªSOTAçš„ç½‘ç»œã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œä»çœŸå®è§†é¢‘ä¸­è·å–å…‰æµçš„GTæ˜¯éå¸¸å›°éš¾çš„ã€‚å› æ­¤æˆ‘ä»¬ä»¥çœŸå®æ¢å–æ•°é‡ï¼Œæˆ‘ä»¬åˆæˆäº†ä¸€ä¸ªé£è¡Œæ¤…å­çš„æ•°æ®é›†ï¼Œå‰æ™¯æ˜¯æ¤…å­ï¼ŒèƒŒæ™¯æ˜¯å„ç§å„æ ·çš„éšæœºèƒŒæ™¯å›¾åƒã€‚ä»…åœ¨è¿™æ ·ä¸€ä¸ªåˆæˆçš„æ•°æ®é›†ä¸Šè®­ç»ƒçš„CNNæ¨¡å‹ï¼Œå³ä½¿ä¸è¿›è¡Œfine-tuneï¼Œä¹Ÿèƒ½å¾ˆå¥½çš„æ¨å¹¿åˆ°çœŸå®æ•°æ®é›†ã€‚

åˆ©ç”¨CNNåœ¨GPUä¸Šçš„é«˜æ•ˆå®ç°ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ¯”å¤§å¤šæ•°ç«äº‰å¯¹æ‰‹éƒ½å¿«ã€‚åœ¨Sintelæ•°æ®é›†çš„å…¨åˆ†è¾¨ç‡ä¸‹ï¼Œæˆ‘ä»¬çš„ç½‘ç»œæ¯ç§’å¯ä»¥é¢„æµ‹å¤šè¾¾10ä¸ªå›¾åƒå¯¹çš„å…‰æµï¼Œåœ¨å®æ—¶æ–¹æ³•ä¸­ç²¾åº¦æ˜¯æœ€é«˜çš„ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/1.png)

# 2.Related Work

ğŸ‘‰**Optical Flow.**

è‡ªâ€B. K. P. Horn and B. G. Schunck. Determining optical flow. Artificial Intelligence, 17:185â€“203, 1981.â€ä»¥æ¥ï¼Œå˜åˆ†æ–¹æ³•ï¼ˆvariational approachesï¼‰ä¸€ç›´ä¸»å¯¼ç€å…‰æµä¼°è®¡ã€‚åç»­å¾ˆå¤šç ”ç©¶éƒ½å¯¹å…¶è¿›è¡Œäº†æ”¹è¿›ã€‚æˆ‘ä»¬åªæ˜¯ç”¨å˜åˆ†æ–¹æ³•å¯¹CNNé¢„æµ‹çš„å…‰æµåœºè¿›è¡Œå¯é€‰çš„refinementï¼Œè€Œä¸éœ€è¦ä»»ä½•æ‰‹å·¥è®¾è®¡çš„èšåˆã€åŒ¹é…å’Œæ’å€¼æ–¹æ³•ã€‚

ä¹Ÿæœ‰ä¸€äº›ç ”ç©¶å°†æœºå™¨å­¦ä¹ æŠ€æœ¯åº”ç”¨äºå…‰æµä¼°è®¡ã€‚

ç›®å‰å·²ç»æœ‰ä¸€äº›æ— ç›‘ç£å­¦ä¹ çš„å·¥ä½œï¼Œä½¿ç”¨ç¥ç»ç½‘ç»œæ¨¡å‹å¯¹è§†é¢‘å¸§ä¹‹é—´çš„ä½ç§»ï¼ˆdisparityï¼‰è¿›è¡Œå­¦ä¹ ã€‚ä½†åœ¨çœŸå®è§†é¢‘ä¸Šï¼Œå…¶æ²¡æœ‰æ˜æ˜¾å¥½äºä¼ ç»Ÿç®—æ³•ã€‚

# 3.Network Architectures

ğŸ‘‰**Convolutional Networks.**

CNNåœ¨å¤§è§„æ¨¡å›¾åƒåˆ†ç±»æ–¹é¢è¡¨ç°è‰¯å¥½ã€‚è¿™ä¸ºCNNåœ¨CVé¢†åŸŸä¸­å„é¡¹ä»»åŠ¡ä¸Šçš„åº”ç”¨å¥ å®šäº†åŸºç¡€ã€‚

è™½ç„¶ç›®å‰è¿˜æ²¡æœ‰å°†CNNç”¨äºå…‰æµä¼°è®¡çš„ç›¸å…³å·¥ä½œï¼Œä½†æ˜¯å·²ç»æœ‰ä»CNNè¿›è¡ŒåŒ¹é…çš„ä¸€äº›ç ”ç©¶ã€‚â€P. Fischer, A. Dosovitskiy, and T. Brox. Descriptor matching with convolutional neural networks: a comparison to SIFT. 2014. pre-print, arXiv:1405.5769v1 [cs.CV].â€ä»ä»¥æœ‰ç›‘ç£æˆ–æ— ç›‘ç£æ–¹å¼è®­ç»ƒçš„CNNç½‘ç»œä¸­æå–è¡¨å¾ï¼Œå¹¶åŸºäºæ¬§æ°è·ç¦»åŒ¹é…è¿™äº›ç‰¹å¾ã€‚â€J. Zbontar and Y. LeCun. Computing the stereo matching cost with a convolutional neural network. CoRR, abs/1409.4326, 2014.â€è®­ç»ƒå…·æœ‰Siameseæ¡†æ¶çš„CNNæ¥é¢„æµ‹å›¾åƒpatchä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚è¿™äº›æ–¹æ³•ä¸æˆ‘ä»¬æ–¹æ³•çš„ä¸€ä¸ªæ˜¾è‘—åŒºåˆ«æ˜¯ï¼Œå®ƒä»¬æ˜¯åŸºäºpatchçš„ï¼Œå¹¶å°†ç©ºé—´èšåˆç•™ç»™åå¤„ç†ï¼Œè€Œæœ¬æ–‡ä¸­çš„ç½‘ç»œåˆ™ç›´æ¥é¢„æµ‹å®Œæ•´çš„å…‰æµåœºã€‚

æœ€è¿‘CNNçš„åº”ç”¨åŒ…æ‹¬è¯­ä¹‰åˆ†å‰²ã€æ·±åº¦é¢„æµ‹ã€å…³é”®ç‚¹æ£€æµ‹å’Œè¾¹ç¼˜æ£€æµ‹ç­‰ã€‚è¿™äº›ä»»åŠ¡ç±»ä¼¼äºå…‰æµä¼°è®¡ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ¶‰åŠå¯¹æ¯ä¸ªåƒç´ è¿›è¡Œé¢„æµ‹ã€‚å› ä¸ºæˆ‘ä»¬çš„æ¨¡å‹æ¡†æ¶åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ°äº†è¿™äº›é’ˆå¯¹æ¯ä¸ªåƒç´ éƒ½è¿›è¡Œé¢„æµ‹çš„ä»»åŠ¡çš„å¯å‘ï¼Œæˆ‘ä»¬ç®€è¦å›é¡¾äº†ä¸€äº›ä¸åŒçš„æ–¹æ³•ã€‚

æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä»¥æ»‘åŠ¨çª—å£çš„æ–¹å¼åº”ç”¨ä¼ ç»ŸCNNï¼Œä»è€Œä¸ºæ¯ä¸ªå›¾åƒpatchè®¡ç®—ä¸€ä¸ªé¢„æµ‹ç»“æœï¼ˆæ¯”å¦‚ç±»æ ‡ç­¾ï¼‰ã€‚è¿™ä¸€æ–¹æ³•åœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½èƒ½å¾ˆå¥½çš„å·¥ä½œï¼Œä½†å…¶ä¹Ÿæœ‰ç¼ºç‚¹ï¼šä¸€æ˜¯è®¡ç®—æˆæœ¬é«˜ï¼›äºŒæ˜¯é’ˆå¯¹patchè¿›è¡Œè®¡ç®—ï¼Œæ²¡æœ‰è€ƒè™‘å…¨å±€ç‰¹æ€§ã€‚å¦ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯å°†æ‰€æœ‰çš„feature mapéƒ½ä¸Šé‡‡æ ·è‡³æƒ³è¦çš„å…¨åˆ†è¾¨ç‡ï¼Œå¹¶å°†å®ƒä»¬å †å åœ¨ä¸€èµ·ï¼Œä»è€Œäº§ç”Ÿå¯¹æ¯ä¸ªåƒç´ çš„é¢„æµ‹ã€‚

Eigenç­‰äººï¼ˆD. Eigen, C. Puhrsch, and R. Fergus. Depth map prediction from a single image using a multi-scale deep network. NIPS, 2014.ï¼‰é€šè¿‡è®­ç»ƒä¸€ä¸ªè¾“å…¥ä¸ºcoarse predictionå’Œè¾“å…¥å›¾åƒçš„é¢å¤–ç½‘ç»œæ¥å¯¹coarse depth mapè¿›è¡Œrefineã€‚[Longç­‰äºº](http://shichaoxin.com/2022/01/31/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB-Fully-Convolutional-Networks-for-Semantic-Segmentation/)å’ŒDosovitskiyç­‰äººï¼ˆA. Dosovitskiy, J. T. Springenberg, and T. Brox. Learning to generate chairs with convolutional neural networks. In CVPR, 2015.ï¼‰ä½¿ç”¨[ä¸Šå·ç§¯å±‚](http://shichaoxin.com/2022/01/31/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB-Fully-Convolutional-Networks-for-Semantic-Segmentation/#33upsampling-is-backwards-strided-convolution)ï¼ˆupconvolutional layersï¼Œé€šå¸¸ä¹Ÿè¢«ç§°ä¸ºdeconvolutional layersï¼Œå°½ç®¡å…¶åœ¨æ“ä½œæŠ€æœ¯ä¸Šä»æ˜¯å·ç§¯ï¼Œè€Œä¸æ˜¯åå·ç§¯ï¼‰æ¥å¯¹coarse feature mapsè¿›è¡Œè¿­ä»£refineã€‚æˆ‘ä»¬çš„æ–¹æ³•ç»¼åˆäº†ä»¥ä¸Šå·¥ä½œçš„æ€æƒ³ã€‚ä¸[Longç­‰äºº](http://shichaoxin.com/2022/01/31/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB-Fully-Convolutional-Networks-for-Semantic-Segmentation/)çš„å·¥ä½œä¸åŒï¼Œæˆ‘ä»¬ä¸ä»…[åå·ç§¯](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/#33upsampling-is-backwards-strided-convolution)äº†coarse predictionï¼Œè¿˜å¯¹æ•´ä¸ªcoarse feature mapsè¿›è¡Œäº†[åå·ç§¯](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/#33upsampling-is-backwards-strided-convolution)ï¼Œä»è€Œå°†æ›´high-levelçš„ä¿¡æ¯ä¼ é€’ç»™fine predictionã€‚ä¸Dosovitskiyç­‰äººçš„å·¥ä½œä¸åŒï¼Œæˆ‘ä»¬å°†[åå·ç§¯](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/#33upsampling-is-backwards-strided-convolution)çš„ç»“æœå’Œç½‘ç»œæ”¶ç¼©éƒ¨åˆ†ï¼ˆâ€˜contractiveâ€™ partï¼‰çš„ç‰¹å¾concatåœ¨ä¸€èµ·ã€‚

ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ç»™å®šè¶³å¤Ÿå¤šçš„æ ‡æ³¨æ•°æ®çš„æƒ…å†µä¸‹ï¼ŒCNNéå¸¸æ“…é•¿å­¦ä¹ è¾“å…¥-è¾“å‡ºä¹‹é—´çš„å…³ç³»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨ç«¯åˆ°ç«¯çš„æ–¹å¼æ¥é¢„æµ‹å…‰æµï¼šè¾“å…¥ä¸ºå›¾åƒå¯¹å’ŒçœŸå®çš„å…‰æµï¼ˆGTï¼‰ï¼Œè¾“å‡ºä¸ºé¢„æµ‹çš„x-yå…‰æµåœºã€‚

ä¸€ä¸ªç®€å•çš„è§£å†³åŠæ³•æ˜¯æŠŠä¸¤ä¸ªè¾“å…¥å›¾åƒç›´æ¥å †å åœ¨ä¸€èµ·å–‚ç»™ä¸€ä¸ªé€šç”¨çš„ç½‘ç»œï¼Œè®©ç½‘ç»œè‡ªå·±å­¦ä¹ å¦‚ä½•å¤„ç†å›¾åƒå¯¹å¹¶ä»ä¸­æå–è¿åŠ¨ä¿¡æ¯ã€‚è§Fig2ä¸Šã€‚æˆ‘ä»¬å°†è¿™ä¸ªåªåŒ…å«å·ç§¯å±‚çš„æ¡†æ¶ç§°ä¸ºFlowNetSimpleã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/2.png)

åŸåˆ™ä¸Šï¼Œåªè¦è¿™ä¸ªç½‘ç»œè¶³å¤Ÿå¤§ï¼Œå…¶å°±èƒ½å­¦ä¼šé¢„æµ‹å…‰æµã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ°¸è¿œä¸èƒ½ç¡®å®šåƒéšæœºæ¢¯åº¦ä¸‹é™æ³•è¿™æ ·çš„å±€éƒ¨æ¢¯åº¦ä¼˜åŒ–æ˜¯å¦èƒ½è®©ç½‘ç»œè¾¾åˆ°è¿™ä¸€ç‚¹ã€‚å› æ­¤ï¼Œæ‰‹å·¥è®¾è®¡ä¸€ç§ä¸å¤ªé€šç”¨çš„æ¡†æ¶å¯èƒ½æ˜¯æœ‰ç›Šçš„ï¼Œåœ¨ç»™å®šæ•°æ®å’Œä¼˜åŒ–æŠ€æœ¯ä¸‹å¯èƒ½ä¼šè¡¨ç°çš„æ›´å¥½ã€‚

ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ˜¯ä¸ºè¿™ä¸¤å¼ å›¾åƒåˆ›å»ºä¸¤ä¸ªç‹¬ç«‹ä½†ç›¸åŒçš„å¤„ç†æµï¼Œå¹¶åœ¨åé¢çš„é˜¶æ®µå°†å…¶ç»„åˆï¼Œè§Fig2ä¸‹ã€‚åœ¨è¿™ä¸ªæ¡†æ¶ä¸­ï¼Œç½‘ç»œå…ˆåˆ†åˆ«ä¸ºä¸¤å¼ å›¾åƒç”Ÿæˆæœ‰æ„ä¹‰çš„è¡¨å¾ï¼Œå¹¶åœ¨higher levelä¸Šç»„åˆå®ƒä»¬ã€‚è¿™ç±»ä¼¼äºæ ‡å‡†åŒ¹é…æ–¹æ³•ï¼Œå³å…ˆåˆ†åˆ«ä»ä¸¤å¼ å›¾åƒçš„patchä¸­æå–ç‰¹å¾ï¼Œç„¶åå†æ¯”è¾ƒè¿™äº›ç‰¹å¾å‘é‡ã€‚ç„¶è€Œï¼Œç»™å®šä¸¤å¹…å›¾åƒçš„è¡¨å¾ï¼Œç½‘ç»œè¯¥å¦‚ä½•æ‰¾åˆ°å¯¹åº”å…³ç³»ï¼Ÿ

ä¸ºäº†å¸®åŠ©ç½‘ç»œè¿›è¡ŒåŒ¹é…ï¼Œæˆ‘ä»¬å¼•å…¥äº†ç›¸å…³å±‚ï¼Œç”¨äºåœ¨ä¸¤ä¸ªfeature mapä¹‹é—´è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬å°†åŒ…å«ç›¸å…³å±‚çš„æ¡†æ¶ç§°ä¸ºFlowNetCorrï¼Œè§Fig2ä¸‹ã€‚ç»™å®šä¸¤ä¸ªå¤šé€šé“feature map $\mathbf{f}_1,\mathbf{f}_2 : \mathbb{R}^2 \to \mathbb{R}^c$ï¼Œå¹¶ä¸”$w,h,c$åˆ†åˆ«è¡¨ç¤ºå®½ã€é«˜å’Œé€šé“æ•°ï¼Œç›¸å…³å±‚ä¼šå°†$\mathbf{f}_1$ä¸­çš„æ¯ä¸ªpatchä¸$\mathbf{f}_2$ä¸­çš„æ¯ä¸€ä¸ªpatchè¿›è¡Œæ¯”è¾ƒã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåªè€ƒè™‘ä¸¤ä¸ªpatchä¹‹é—´çš„æ¯”è¾ƒã€‚ç¬¬ä¸€ä¸ªmapçš„patchçš„ä¸­å¿ƒç‚¹ä¸º$\mathbf{x}_1$ï¼Œç¬¬äºŒä¸ªmapçš„patchçš„ä¸­å¿ƒç‚¹ä¸º$\mathbf{x}_2$ï¼Œå…¶ä¹‹é—´çš„ç›¸å…³æ€§ï¼ˆcorrelationï¼‰å®šä¹‰ä¸ºï¼š

$$c(\mathbf{x}_1,\mathbf{x}_2) = \sum_{\mathbf{o} \in [-k,k]\times [-k,k]} \langle \mathbf{f}_1 (\mathbf{x}_1 + \mathbf{o}), \mathbf{f}_2(\mathbf{x}_2 + \mathbf{o}) \rangle \tag{1}$$

å…¶ä¸­æ–¹å½¢patchçš„å¤§å°ä¸º$K:=2k+1$ã€‚å¼(1)çš„è®¡ç®—æ–¹å¼ç±»ä¼¼äºå·ç§¯ï¼Œä½†ä¸æ˜¯æ•°æ®å’Œå·ç§¯æ ¸è¿›è¡Œå·ç§¯ï¼Œè€Œæ˜¯æ•°æ®å’Œæ•°æ®è¿›è¡Œå·ç§¯ã€‚æ‰€ä»¥å…¶æ²¡æœ‰å¯è®­ç»ƒçš„æƒé‡å‚æ•°ã€‚

$c(\mathbf{x}_1,\mathbf{x}_2)$çš„è®¡ç®—åŒ…å«$c \cdot K^2$æ¬¡ä¹˜æ³•è¿ç®—ï¼ˆä¸ªäººç†è§£ï¼š$c$æ˜¯feature mapçš„é€šé“æ•°ï¼Œåœ¨æ¯ä¸ªé€šé“ä¸Šï¼Œä¸¤ä¸ªå¤§å°ä¸º$K$çš„patchä¹‹é—´è¿›è¡Œé€å…ƒç´ çš„æ¯”è¾ƒï¼Œè¿™é‡Œæ¯”è¾ƒç”¨çš„æ˜¯ä¹˜æ³•è¿ç®—ï¼Œé‚£ä¹ˆå°±æ˜¯$K^2$æ¬¡ä¹˜æ³•ï¼Œæ‰€ä»¥å¦‚æœè€ƒè™‘æ‰€æœ‰é€šé“ï¼Œé‚£ä¹ˆä¹˜æ³•è¿ç®—çš„æ€»æ¬¡æ•°ä¸º$c \cdot K^2$ï¼‰ã€‚$\mathbf{f}_1$ä¸­çš„ä¸€ä¸ªpatchéœ€è¦å’Œ$\mathbf{f}_2$ä¸­çš„æ‰€æœ‰patchè¿›è¡Œæ¯”è¾ƒï¼Œé‚£å°±æ˜¯$c \cdot K^2 \cdot w \cdot h$æ¬¡ä¹˜æ³•ï¼Œå¦‚æœè€ƒè™‘$\mathbf{f}_1$ä¸­çš„æ‰€æœ‰patchï¼Œé‚£ä¹ˆå°±éœ€è¦$c \cdot K^2 \cdot w^2 \cdot h^2$æ¬¡ä¹˜æ³•ï¼Œå·¨å¤§çš„è®¡ç®—é‡ä½¿å¾—æ¨¡å‹è®­ç»ƒå’Œæ¨ç†å˜å¾—å›°éš¾ã€‚å› æ­¤ï¼Œç”±äºè®¡ç®—é‡çš„åŸå› ï¼Œæˆ‘ä»¬é™åˆ¶äº†æ¯”è¾ƒçš„æœ€å¤§ä½ç§»ï¼Œå¹¶åœ¨ä¸¤ä¸ªfeature mapä¸­å¼•å…¥äº†è·¨æ­¥ã€‚

>ä¸ªäººç†è§£ï¼šå°†ä¸¤ä¸ªpatchçš„ç›¸å…³æ€§ä½œä¸ºè¿™ä¸¤ä¸ªpatchä¸­å¿ƒç‚¹çš„ç›¸å…³æ€§ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/3.png)

ä¸Šå›¾æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œ$\mathbf{f}_1$ä¸­çš„25ä¸ªå…ƒç´ ä¼šä¾æ¬¡å’Œ$\mathbf{f}_2$ä¸­çš„25ä¸ªå…ƒç´ ä»¥åŸºäºpatchï¼ˆ$3\times 3$å¤§å°ï¼‰çš„å½¢å¼è®¡ç®—ç›¸å…³æ€§ã€‚

å› ä¸ºè¿™æ ·åšè®¡ç®—é‡å¤ªå¤§ï¼Œæˆ‘ä»¬ä¸æƒ³è®©$\mathbf{f}_1$ä¸­çš„25ä¸ªå…ƒç´ ä¾æ¬¡å’Œ$\mathbf{f}_2$ä¸­çš„25ä¸ªå…ƒç´ è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é™åˆ¶åªå’Œ$\mathbf{f}_2$ä¸­çš„éƒ¨åˆ†å…ƒç´ è¿›è¡Œè®¡ç®—ï¼Œè¿™äº›å…ƒç´ éƒ½åœ¨$\mathbf{f}_1$ç›®æ ‡å…ƒç´ çš„é™„è¿‘ã€‚æˆ‘ä»¬å‡è®¾è¿™ä¸ªèŒƒå›´ä¸º$D:=2d+1$ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/4.png)

ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦è®¡ç®—$\mathbf{f}_1$ä¸­$(1,1)$ï¼ˆæ•°å€¼ä¸º7ï¼‰è¿™ä¸ªå…ƒç´ çš„ç›¸å…³æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè€ƒè™‘$\mathbf{f}_2$ä¸­$(0,0),(0,1),(0,2),(1,0),(1,1),(1,2),(2,0),(2,1),(2,2)$è¿™9ä¸ªå…ƒç´ ï¼ˆå³$d=1$ï¼Œä¸€å…±è®¡ç®—$D^2$æ¬¡ï¼‰ã€‚ä¾æ—§æ˜¯åŸºäºpatchè¿›è¡Œè®¡ç®—ï¼ˆè¿™ä¸ªpatchçš„å¤§å°ç”±kæ§åˆ¶ï¼‰ã€‚$\mathbf{f}_1$ä¸­åŒä¸€ä¸ªå…ƒç´ å’Œ$\mathbf{f}_2$ä¸­ä¸åŒå…ƒç´ çš„ç›¸å…³æ€§æŒ‰channelæ–¹å‘æ’åˆ—ï¼Œå› æ­¤é€šè¿‡ç›¸å…³å±‚åå¾—åˆ°çš„feature mapå¤§å°åº”è¯¥æ˜¯$D^2 \times w \times h$ï¼Œå…¶ä¸­$w,h$ä¸ºfeature mapçš„å®½å’Œé«˜ï¼Œ$D^2$ä¸ºchannelæ•°é‡ã€‚æ­¤å¤–ï¼Œå¯¹äº$\mathbf{x}_1$å’Œ$\mathbf{x}_2$ï¼Œæˆ‘ä»¬è¿˜åˆ†åˆ«ä½¿ç”¨äº†$s_1$å’Œ$s_2$çš„æ­¥é•¿ã€‚

>ä½œè€…ä½¿ç”¨k=0ï¼Œå³K=1ï¼Œè¿™æ ·å°±ä¸ç”¨è€ƒè™‘paddingæ“ä½œäº†ï¼Œå¹¶ä¸”è®¡ç®—é‡ä¹Ÿå°äº†å¾ˆå¤šã€‚
>
>$D^2$å¤ªå¤§æ—¶ï¼Œä½œè€…ä½¿ç”¨äº†strideæ“ä½œæ¥é™ä½é€šé“æ•°é‡ã€‚åœ¨FlowNetCorrä¸­ï¼Œä½œè€…å–d=20ï¼Œé‚£ä¹ˆDå°±æ˜¯41ï¼Œè¾“å‡ºçš„feature mapå¤§å°ç†åº”æ˜¯$1681 \times h \times w$ï¼Œä½†è¿™æ ·ç»´åº¦å°±å¤ªå¤§äº†ï¼Œå› æ­¤ä½œè€…ä½¿ç”¨äº†strideæ“ä½œï¼Œä½¿$D=21$ï¼Œå°†ç»´åº¦é™ä¸º$441 \times h \times w$ã€‚è¿™ä¸ªå¯ä»¥ä»Fig2ä¸­å¯ä»¥çœ‹åˆ°ã€‚
>
>æ­¤å¤–ï¼ŒFlowNetCorrä¸­è¿˜æœ‰ä¸€ä¸ª`conv_redir`ï¼Œè¿™ä¸ªå°±æ˜¯å·ç§¯å±‚+[BatchNorm](http://shichaoxin.com/2021/11/02/è®ºæ–‡é˜…è¯»-Batch-Normalization-Accelerating-Deep-Network-Training-by-Reducing-Internal-Covariate-Shift/)+[LeakyReLU](http://shichaoxin.com/2019/12/11/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬ä¸ƒè¯¾-æ¿€æ´»å‡½æ•°/#23leaky-reluå‡½æ•°)è¿™ä¸€å¥—æ“ä½œã€‚

ğŸ‘‰**Refinement.**

CNNæ“…é•¿é€šè¿‡å·ç§¯å±‚å’Œæ± åŒ–å±‚æ¥æå–å›¾åƒhigh-levelçš„æŠ½è±¡ç‰¹å¾ã€‚æ± åŒ–æ“ä½œä½¿å¾—è®­ç»ƒç½‘ç»œå˜å¾—å¯è¡Œï¼Œå…¶å¯ä»¥åœ¨è¾“å…¥å›¾åƒçš„å¤§èŒƒå›´åŒºåŸŸå†…èšåˆä¿¡æ¯ã€‚ç„¶è€Œï¼Œæ± åŒ–ä¼šå¯¼è‡´åˆ†è¾¨ç‡é™ä½ï¼Œå› æ­¤ä¸ºäº†å¾—åˆ°åŸºäºæ¯ä¸ªåƒç´ çš„dense predictionï¼Œæˆ‘ä»¬éœ€è¦refineè¿™äº›ç»è¿‡æ± åŒ–çš„ç²—ç³™è¡¨å¾ä¿¡æ¯ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/5.png)

refinementçš„æµç¨‹è§Fig3ã€‚ä¸»è¦ç»“æ„å°±æ˜¯åå·ç§¯å±‚ï¼Œå…¶ç”±unpoolingå’Œå·ç§¯ç»„æˆã€‚åå·ç§¯å±‚åœ¨ä¹‹å‰çš„ç ”ç©¶ä¸­éƒ½æœ‰ä½¿ç”¨ï¼Œæ¯”å¦‚[ZFNet](http://shichaoxin.com/2021/05/02/è®ºæ–‡é˜…è¯»-Visualizing-and-Understanding-Convolutional-Networks/)ã€[GAN](http://shichaoxin.com/2021/10/30/è®ºæ–‡é˜…è¯»-Generative-Adversarial-Nets/)ã€[FCN](http://shichaoxin.com/2022/01/31/è®ºæ–‡é˜…è¯»-Fully-Convolutional-Networks-for-Semantic-Segmentation/)ç­‰ã€‚ä¸ºäº†æ‰§è¡Œrefinementï¼Œæˆ‘ä»¬å°†åå·ç§¯åº”ç”¨äºfeature mapï¼Œå¹¶å°†å…¶ä¸ç½‘ç»œâ€œæ”¶ç¼©â€é˜¶æ®µå¯¹åº”å¤§å°çš„feature map concatåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”ä¼šå¯¹å¾—åˆ°çš„ç²—ç³™å…‰æµé¢„æµ‹ç»“æœè¿›è¡Œä¸Šé‡‡æ ·ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ï¼Œå¹¶ä¸”ä¼šå°†ä¸Šé‡‡æ ·å¾—åˆ°çš„ç²—ç³™é¢„æµ‹ç»“æœä¹Ÿconcatåœ¨ä¸€èµ·ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ—¢ä¿ç•™äº†ä»ç²—ç³™feature mapæ¥çš„high-levelçš„ä¿¡æ¯ï¼Œä¹Ÿä¿ç•™äº†åœ¨ç½‘ç»œæµ…å±‚çš„feature mapæä¾›çš„è¾ƒç²¾ç»†çš„å±€éƒ¨ä¿¡æ¯ã€‚æ¯ä¸€æ­¥ä¼šå¢åŠ ä¸¤æ¬¡åˆ†è¾¨ç‡ã€‚æˆ‘ä»¬é‡å¤äº†4æ¬¡è¯¥æ“ä½œï¼Œå¾—åˆ°çš„é¢„æµ‹å…‰æµåœºçš„åˆ†è¾¨ç‡ä»ç„¶æ¯”è¾“å…¥åˆ†è¾¨ç‡å°äº†4å€ã€‚ç›¸æ¯”ä½¿ç”¨è®¡ç®—æˆæœ¬è¾ƒä½çš„åŒçº¿æ€§ä¸Šé‡‡æ ·å°†å…¶æ¢å¤è‡³åŸå§‹è¾“å…¥åˆ†è¾¨ç‡ï¼Œè¿›ä¸€æ­¥å¯¹è¯¥åˆ†è¾¨ç‡è¿›è¡Œrefinementå¹¶ä¸èƒ½æ˜¾è‘—æ”¹å–„ç»“æœã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒçº¿æ€§ä¸Šé‡‡æ ·æ¥å¾—åˆ°æœ€ç»ˆé¢„æµ‹çš„å…‰æµåœºã€‚

è¿˜æœ‰å¦ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨â€œT. Brox and J. Malik. Large displacement optical flow: descriptor matching in variational motion estimation. PAMI, 33(3):500â€“513, 2011.â€ä¸€æ–‡ä¸­æä¾›çš„å˜åˆ†æ–¹æ³•æ¥ä»£æ›¿åŒçº¿æ€§ä¸Šé‡‡æ ·ï¼Œä½œè€…ä½¿ç”¨å…‰æµçš„äº®åº¦çº¦æŸå’Œå¹³æ»‘çº¦æŸæ„å»ºäº†ä¸€ä¸ªèƒ½é‡å‡½æ•°ï¼Œç„¶åé€šè¿‡è¿­ä»£çš„æ–¹æ³•æ¥æœ€å°åŒ–èƒ½é‡å‡½æ•°ï¼Œä»ç²—ç³™åˆ°ç²¾ç»†ä¸€å…±è¿­ä»£äº†20æ¬¡ï¼Œä»è€Œå¾—åˆ°åŸå§‹åˆ†è¾¨ç‡çš„å…‰æµé¢„æµ‹ç»“æœã€‚å¹¶ä¸”æˆ‘ä»¬åœ¨åŸå§‹åˆ†è¾¨ç‡ä¸Šå¤šè¿è¡Œäº†5æ¬¡è¿­ä»£ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨è®ºæ–‡â€œM. Leordeanu, R. Sukthankar, and C. Sminchisescu. Efficient closed-form solution to generalized boundary detection. In Proceedings of the 12th European Conference on Computer Vision - Volume Part IV, ECCVâ€™12, pages 516â€“529, Berlin, Heidelberg, 2012. Springer-Verlag.â€ä¸­çš„æ–¹æ³•æ¥è®¡ç®—å›¾åƒè¾¹ç•Œï¼Œå¹¶ä½¿ç”¨$\alpha = \text{exp} (-\lambda b(x,y)^{\kappa})$æ›¿æ¢å¹³æ»‘é¡¹ç³»æ•°ä»¥é‡è§†æ£€æµ‹åˆ°çš„è¾¹ç•Œã€‚ç›¸æ¯”ç®€å•çš„åŒçº¿æ€§ä¸Šé‡‡æ ·ï¼Œè¿™ç§æ–¹æ³•è®¡ç®—æˆæœ¬æ›´é«˜ï¼Œä½†ä¹Ÿå¼•å…¥äº†å˜åˆ†çš„ä¼˜ç‚¹ï¼Œå¾—åˆ°çš„å…‰æµç»“æœæ›´ä¸ºå¹³æ»‘å’Œå‡†ç¡®ã€‚åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨åç¼€â€œ+vâ€æ¥è¡¨ç¤ºè¿™ç§æ–¹æ³•ã€‚æ–¹æ³•ä¹‹é—´çš„æ¯”è¾ƒè§Fig4ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/6.png)

ä»Fig4å¯ä»¥çœ‹å‡ºï¼Œå˜åˆ†æ–¹æ³•çš„ä½¿ç”¨åŠ å¼ºäº†å¯¹å°è¿åŠ¨çš„æ£€æµ‹èƒ½åŠ›ï¼ˆFig4ç¬¬ä¸€è¡Œï¼‰ã€‚è€Œå¯¹äºè¾ƒå¤§çš„è¿åŠ¨ï¼ˆFig4ç¬¬äºŒè¡Œï¼‰ï¼Œå˜åˆ†æ–¹æ³•å¹¶ä¸èƒ½æ ¡æ­£è¾ƒå¤§çš„è¯¯å·®ï¼Œä½†æ˜¯å¯ä»¥å¹³æ»‘å…‰æµåœºï¼Œä»è€Œé™ä½EPEã€‚

# 4.Training Data

å¯¹äºå…‰æµä¼°è®¡ä»»åŠ¡æ¥è¯´ï¼ŒGTçš„è·å¾—æ˜¯å¾ˆå›°éš¾çš„ï¼Œå› ä¸ºå¾ˆéš¾ç¡®å®šåƒç´ ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚ç›®å‰å¯è·å¾—çš„æ•°æ®é›†è§è¡¨1ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/7.png)

## 4.1.Existing Datasets

Middleburyæ•°æ®é›†åªæœ‰8ä¸ªå›¾åƒå¯¹æœ‰GTï¼Œå¯ä»¥ç”¨äºè®­ç»ƒã€‚æ•°æ®é›†çš„ä½ç§»å¾ˆå°ï¼ŒåŸºæœ¬åœ¨10ä¸ªåƒç´ ä»¥å†…ã€‚

KITTIæ•°æ®é›†ä¼šæ›´å¤§ä¸€äº›ï¼Œæœ‰194ä¸ªå¸¦æ ‡æ³¨çš„å›¾åƒå¯¹å¯ä»¥ç”¨äºè®­ç»ƒï¼Œå¹¶ä¸”æœ‰å¤§ä½ç§»ï¼Œä½†æ˜¯è¯¥æ•°æ®é›†åªåŒ…å«ä¸€ç§éå¸¸ç‰¹æ®Šçš„è¿åŠ¨ç±»å‹ã€‚è¯¥æ•°æ®é›†é€šè¿‡ç›¸æœºå’Œ3Dæ¿€å…‰æ‰«æä»ªåŒæ—¶è®°å½•åœºæ™¯ï¼Œæ¥è·å¾—çœŸå®ä¸–ç•Œåœºæ™¯çš„GTã€‚ä½†å…¶æ— æ³•æ•æ‰åˆ°é¥è¿œç‰©ä½“ï¼ˆå¦‚å¤©ç©ºï¼‰çš„è¿åŠ¨ï¼Œä»è€Œå¯¼è‡´GTæ˜¯ç¨€ç–çš„ã€‚

MPI Sintelæ•°æ®é›†ä»äººå·¥æ¸²æŸ“çš„åœºæ™¯ä¸­è·å¾—GTã€‚æ•°æ®é›†æä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬ï¼šFinalç‰ˆæœ¬åŒ…å«è¿åŠ¨æ¨¡ç³Šå’Œå¤§æ°”æ•ˆæœï¼ˆå¦‚é›¾ï¼‰ï¼›Cleanç‰ˆæœ¬åˆ™ä¸åŒ…å«è¿™äº›æ•ˆæœã€‚Sintelæ•°æ®é›†æ˜¯ç›®å‰å¯ç”¨çš„æœ€å¤§æ•°æ®é›†ï¼ˆæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰1041ä¸ªå¸¦æœ‰æ ‡æ³¨çš„å›¾åƒå¯¹å¯ç”¨äºè®­ç»ƒï¼‰ï¼Œå¹¶ä¸”GTæ˜¯denseçš„ã€‚

## 4.2.Flying Chairs

Sintelæ•°æ®é›†å¯¹äºè®­ç»ƒCNNæ¥è¯´è¿˜æ˜¯å¤ªå°äº†ã€‚ä¸ºäº†å¾—åˆ°å……è¶³çš„è®­ç»ƒæ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç»„å…¬å¼€çš„3Dæ¤…å­æ¨¡å‹ï¼Œé€šè¿‡ä»¿å°„å˜æ¢ï¼Œåˆæˆäº†ä¸€ä¸ªé£æ¤…æ•°æ®é›†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä»Flickrä¸­æ£€ç´¢äº†964å¼ åˆ†è¾¨ç‡ä¸º$1024 \times 768$çš„å›¾ç‰‡ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼šâ€œcityâ€ï¼ˆ321å¼ ï¼‰ã€â€œlandscapeâ€ï¼ˆ129å¼ ï¼‰ã€â€œmountainâ€ï¼ˆ514å¼ ï¼‰ã€‚æˆ‘ä»¬å°†å›¾åƒåˆ‡æˆ4å—ï¼Œä½¿ç”¨å¾—åˆ°çš„$512 \times 384$å¤§å°çš„å›¾åƒä½œä¸ºèƒŒæ™¯ã€‚æˆ‘ä»¬å°†æ¤…å­ä½œä¸ºå‰æ™¯æ·»åŠ è¿›å»ã€‚ä»åŸå§‹æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬åˆ æ‰äº†éå¸¸ç›¸ä¼¼çš„æ¤…å­ï¼Œå¾—åˆ°äº†809ç§æ¤…å­ç±»å‹å’Œæ¯æŠŠæ¤…å­çš„62ä¸ªè§†å›¾ã€‚ä¸€äº›ä¾‹å­è§Fig5ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/8.png)

Fig5ä¸­å‰ä¸‰åˆ—æ˜¯æ­£å¸¸çš„å›¾åƒï¼Œåä¸‰åˆ—æ˜¯æ•°æ®æ‰©å±•å¾—åˆ°çš„å›¾åƒã€‚

ä¸ºäº†ç”Ÿæˆè¿åŠ¨ï¼Œæˆ‘ä»¬å¯¹èƒŒæ™¯å’Œæ¤…å­è¿›è¡Œäº†éšæœºçš„ä»¿å°„å˜æ¢ã€‚

ä»¿å°„å˜æ¢ï¼ˆAffine Transformationï¼‰æ˜¯çº¿æ€§å˜æ¢å’Œå¹³ç§»å˜æ¢çš„å åŠ ã€‚ä»¿å°„å˜æ¢åŒ…æ‹¬ç¼©æ”¾ï¼ˆscaleï¼‰ã€å¹³ç§»ï¼ˆtransformï¼‰ã€æ—‹è½¬ï¼ˆrotateï¼‰ã€åå°„ï¼ˆreflectionï¼‰ã€é”™åˆ‡ï¼ˆshear mappingï¼‰ã€‚

ä»¿å°„å˜æ¢è¿‡ç¨‹ä¸­ä¸€äº›æ€§è´¨ä¿æŒä¸å˜ï¼š

1. å‡¸æ€§ã€‚
2. å…±çº¿æ€§ï¼šè‹¥å‡ ä¸ªç‚¹å˜æ¢å‰åœ¨ä¸€æ¡çº¿ä¸Šï¼Œåˆ™ä»¿å°„å˜æ¢åä»ç„¶åœ¨ä¸€æ¡çº¿ä¸Šã€‚
3. å¹³è¡Œæ€§ï¼šè‹¥ä¸¤æ¡çº¿å˜æ¢å‰å¹³è¡Œï¼Œåˆ™å˜æ¢åä»ç„¶å¹³è¡Œã€‚
4. å…±çº¿æ¯”ä¾‹ä¸å˜æ€§ï¼šå˜æ¢å‰ä¸€æ¡çº¿ä¸Šä¸¤æ¡çº¿æ®µçš„æ¯”ä¾‹ï¼Œåœ¨å˜æ¢åæ¯”ä¾‹ä¸å˜ã€‚

åœ¨äºŒç»´å›¾åƒä¸­ï¼Œä»¿å°„å˜æ¢ä¸€èˆ¬è¡¨ç¤ºä¸ºï¼š

$$\begin{bmatrix} x' \\ y' \\ 1 \end{bmatrix} = \begin{bmatrix} R_{00} & R_{01} & T_x \\ R_{10} & R_{11} & T_y \\ 0 & 0 & 1 \\ \end{bmatrix} \begin{bmatrix} x \\ y \\ 1 \\ \end{bmatrix}$$

å¯è§†ä¸ºçº¿æ€§å˜æ¢Rå’Œå¹³ç§»å˜æ¢Tçš„å åŠ ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/9.png)

ä½¿ç”¨è®¡ç®—æœºå›¾å½¢å­¦æŠ€æœ¯ï¼Œå°†ç”Ÿæˆçš„æ¤…å­ä»¥é€è§†æŠ•å½±çš„æ–¹å¼æ¸²æŸ“åˆ°èƒŒæ™¯å›¾åƒä¸Šï¼Œå½¢æˆåˆæˆå›¾åƒã€‚åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œè¿˜ä¼šè€ƒè™‘å…‰ç…§ã€é˜´å½±ç­‰å› ç´ ï¼Œä½¿å¾—åˆæˆå›¾åƒçœ‹èµ·æ¥æ›´åŠ çœŸå®ã€‚é€šè¿‡åˆæˆå›¾åƒçš„å‰ä¸€å¸§å’Œå½“å‰å¸§ä¹‹é—´çš„åƒç´ ä½ç§»ï¼Œè®¡ç®—å‡ºå¯¹åº”çš„å…‰æµåœºã€‚å…‰æµåœºè¡¨ç¤ºäº†åƒç´ åœ¨ä¸¤ä¸ªå¸§ä¹‹é—´çš„è¿åŠ¨æƒ…å†µã€‚

æ¯ä¸ªå›¾åƒå¯¹çš„å‚æ•°éƒ½æ˜¯éšæœºçš„ï¼Œè¿™äº›å‚æ•°åŒ…æ‹¬ï¼š1ï¼‰æ¤…å­çš„æ•°é‡ã€ç±»å‹ã€å°ºå¯¸å’Œåˆå§‹ä½ç½®ï¼›2ï¼‰ä»¿å°„å˜æ¢å‚æ•°ã€‚æˆ‘ä»¬éšæœºè°ƒæ•´è¿™äº›å‚æ•°çš„åˆ†å¸ƒï¼Œä»¥ä½¿å¾—åˆ°çš„ä½ç§»ç›´æ–¹å›¾å’ŒSintelæ•°æ®é›†çš„ä½ç§»ç›´æ–¹å›¾ç›¸ä¼¼ï¼ˆç»†èŠ‚è§è¡¥å……ææ–™ï¼‰ã€‚é€šè¿‡è¿™ä¸€æ–¹æ³•ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªåŒ…å«22872ä¸ªå›¾åƒå¯¹åŠå…¶å¯¹åº”å…‰æµåœºçš„æ•°æ®é›†ï¼ˆæ¯å¼ èƒŒæ™¯å›¾åƒä¼šè¢«ä½¿ç”¨å¤šæ¬¡ï¼‰ã€‚è¿™ä¸ªæ•°æ®é›†çš„å¤§å°æ˜¯ä»»æ„é€‰æ‹©çš„ï¼ŒåŸåˆ™ä¸Šå¯ä»¥æ›´å¤§ã€‚

## 4.3.Data Augmentation

ç”¨äºå¢å¼ºç½‘ç»œæ³›åŒ–æ€§çš„ä¸€ä¸ªå¸¸ç”¨ç­–ç•¥å°±æ˜¯data augmentationã€‚å°½ç®¡é£æ¤…æ•°æ®é›†å·²ç»ç›¸å½“å¤§äº†ï¼Œæˆ‘ä»¬ä»ç„¶å‘ç°data augmentationå¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿‡æ‹Ÿåˆã€‚æˆ‘ä»¬ä½¿ç”¨çš„data augmentationæ–¹æ³•æœ‰ï¼šå‡ ä½•å½¢å˜ï¼ˆå¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ï¼‰ã€é«˜æ–¯å™ªå£°ã€äº®åº¦ï¼Œå¯¹æ¯”åº¦ï¼Œgammaä»¥åŠé¢œè‰²çš„æ”¹å˜ã€‚æ‰€æœ‰è¿™äº›æ“ä½œéƒ½åœ¨GPUä¸Šè¿›è¡Œã€‚ä¸€äº›augmentationçš„ä¾‹å­è§Fig5ã€‚

æˆ‘ä»¬ä¸ä½†æƒ³å¢åŠ å›¾åƒçš„ç§ç±»ï¼Œè¿˜æƒ³å¢åŠ å…‰æµåœºçš„ç§ç±»ã€‚å› æ­¤ï¼Œå‡è®¾æœ‰å›¾åƒå¯¹Aå’ŒBï¼Œæˆ‘ä»¬å¯¹Aå’ŒBæ–½åŠ ç›¸åŒçš„å¼ºå‡ ä½•å˜æ¢ï¼Œç„¶åä¿æŒAä¸å˜ï¼Œå¯¹Bæ–½åŠ è¾ƒå°çš„å˜æ¢ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªå…‰æµåœºï¼›åè¿‡æ¥ï¼Œä¿æŒBä¸å˜ï¼Œå¯¹Aæ–½åŠ è¾ƒå°çš„å˜æ¢ï¼Œåˆèƒ½å¾—åˆ°ä¸€ä¸ªå…‰æµåœºã€‚

æˆ‘ä»¬å¹³ç§»çš„èŒƒå›´æ˜¯$[-20\%,20\%]$ï¼Œæ—‹è½¬èŒƒå›´æ˜¯$[-17Â°,17Â°]$ï¼Œç¼©æ”¾èŒƒå›´ä¸º$[0.9,2.0]$ã€‚é«˜æ–¯å™ªå£°çš„sigmaåœ¨$[0,0.04]$èŒƒå›´å†…å‡åŒ€å–å€¼ã€‚å¯¹æ¯”åº¦å–å€¼èŒƒå›´ä¸º$[-0.8,0.4]$ã€‚RGBæ¯ä¸ªé€šé“çš„ç›¸ä¹˜ç³»æ•°å–å€¼èŒƒå›´ä¸º$[0.5,2]$ã€‚gammaçš„å–å€¼èŒƒå›´ä¸º$[0.7,1.5]$ã€‚ä½¿ç”¨sigmaä¸º0.2çš„é«˜æ–¯å‡½æ•°è¿›è¡Œäº®åº¦çš„æ”¹å˜ã€‚

# 5.Experiments

æˆ‘ä»¬åœ¨Sintelã€KITTIã€Middleburyå’Œé£æ¤…æ•°æ®é›†ä¸Šæ±‡æŠ¥äº†æˆ‘ä»¬ç½‘ç»œçš„ç»“æœã€‚æˆ‘ä»¬è¿˜å®éªŒäº†åœ¨Sintelæ•°æ®ä¸Šè¿›è¡Œfine-tuneï¼Œå¹¶ä½¿ç”¨äº†å˜åˆ†refinementã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æ¯”è¾ƒäº†æˆ‘ä»¬çš„ç½‘ç»œå’Œå…¶ä»–æ–¹æ³•çš„runtimeã€‚

## 5.1.Network and Training Details

æˆ‘ä»¬è®­ç»ƒæ‰€ç”¨çš„ç½‘ç»œæ¡†æ¶è§Fig2ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å°½é‡ä¿æŒä¸åŒç½‘ç»œçš„æ¡†æ¶ä¸€è‡´ï¼šåœ¨Fig2ä¸­ï¼Œä¸¤ç§ç½‘ç»œéƒ½æœ‰9ä¸ªå·ç§¯å±‚ï¼Œå…¶ä¸­æœ‰6ä¸ªå·ç§¯å±‚çš„æ­¥é•¿ä¸º2ï¼ˆæœ€ç®€å•çš„poolingæ–¹å¼ï¼‰ï¼Œæ¯ä¸€å±‚åé¢éƒ½è·Ÿäº†ä¸€ä¸ªReLUå‡½æ•°ã€‚æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å…¨è¿æ¥å±‚ï¼Œå› æ­¤è¾“å…¥å¯ä»¥æ˜¯ä»»æ„å¤§å°çš„ã€‚å·ç§¯æ ¸çš„å¤§å°éšç€ç½‘ç»œçš„æ·±å…¥è€Œå‡å°ï¼šç¬¬ä¸€å±‚å·ç§¯æ ¸å¤§å°ä¸º$7 \times 7$ï¼Œæ¥ä¸‹æ¥ä¸¤å±‚çš„å·ç§¯æ ¸å¤§å°ä¸º$5 \times 5$ï¼Œä»ç¬¬å››å±‚å¼€å§‹å·ç§¯æ ¸å¤§å°ä¸º$3 \times 3$ã€‚feature mapåŸºæœ¬ä¸Šåœ¨æ¯æ¬¡ä¸‹é‡‡æ ·åé€šé“æ•°ç¿»å€ã€‚é’ˆå¯¹FlowNetCä¸­çš„ç›¸å…³å±‚ï¼Œæˆ‘ä»¬è®¾$k=0,d=20,s_1=1,s_2=2$ã€‚æˆ‘ä»¬ä½¿ç”¨EPEï¼ˆendpoint errorï¼‰ä½œä¸ºtraining lossï¼Œè¿™æ˜¯å…‰æµä¼°è®¡çš„æ ‡å‡†è¯¯å·®åº¦é‡ã€‚EPEå°±æ˜¯ä¼°è®¡çš„å…‰æµå‘é‡ä¸çœŸå®å…‰æµå‘é‡ä¹‹é—´çš„æ¬§æ°è·ç¦»ï¼Œæ‰€æœ‰åƒç´ ç‚¹çš„è¯¯å·®ä¼šåšä¸€ä¸ªå¹³å‡ã€‚

ä½¿ç”¨caffeè®­ç»ƒç½‘ç»œã€‚ä½¿ç”¨[Adamä¼˜åŒ–å™¨](http://shichaoxin.com/2020/03/19/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬åä¹è¯¾-Adamä¼˜åŒ–ç®—æ³•/)ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬çš„ä»»åŠ¡ä¸Šï¼Œå®ƒæ¯”[momentum](http://shichaoxin.com/2020/03/05/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬åä¸ƒè¯¾-Momentumæ¢¯åº¦ä¸‹é™æ³•/)æ”¶æ•›çš„æ›´å¿«ã€‚[Adamä¼˜åŒ–å™¨](http://shichaoxin.com/2020/03/19/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬åä¹è¯¾-Adamä¼˜åŒ–ç®—æ³•/)çš„å‚æ•°è®¾ç½®ä¸º$\beta_1 = 0.9, \beta_2 = 0.999$ã€‚ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œç”±äºæ¯ä¸ªåƒç´ éƒ½æ˜¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨äº†ç›¸å½“å°çš„batch sizeï¼Œæ¯ä¸ªbatchåªæœ‰8ä¸ªå›¾åƒå¯¹ã€‚å‰300kæ¬¡è¿­ä»£çš„å­¦ä¹ ç‡ä¸º$\lambda = 1e-4$ï¼Œä¹‹åæ¯100kæ¬¡è¿­ä»£ï¼Œå­¦ä¹ ç‡ç¼©å°2å€ã€‚å¯¹äºFlowNetCorrï¼Œæˆ‘ä»¬å‘ç°$\lambda = 1e-4$çš„å­¦ä¹ ç‡ä¼šå¯¼è‡´[æ¢¯åº¦çˆ†ç‚¸](http://shichaoxin.com/2020/02/07/æ·±åº¦å­¦ä¹ åŸºç¡€-ç¬¬åä¸‰è¯¾-æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸/)ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åˆšå¼€å§‹ä½¿ç”¨ä¸€ä¸ªå¾ˆä½çš„å­¦ä¹ ç‡$\lambda = 1e-6$ï¼Œåœ¨10kæ¬¡è¿­ä»£åï¼Œå­¦ä¹ ç‡ç¼“æ…¢ä¸Šå‡è‡³$\lambda = 1e-4$ï¼Œç„¶åå†éµå¾ªä¹‹å‰æåˆ°çš„å­¦ä¹ ç‡è¡°å‡ç­–ç•¥ã€‚

ä¸ºäº†é˜²æ­¢åœ¨è®­ç»ƒå’Œfine-tuneæ—¶å‡ºç°è¿‡æ‹Ÿåˆï¼Œæˆ‘ä»¬å°†é£æ¤…æ•°æ®é›†åˆ†ä¸º22232ä¸ªè®­ç»ƒæ ·ä¾‹å’Œ640ä¸ªæµ‹è¯•æ ·ä¾‹ï¼Œå°†Sintelä¸­çš„908ä¸ªå›¾åƒå¯¹ç”¨äºè®­ç»ƒï¼Œ133ä¸ªå›¾åƒå¯¹ç”¨äºéªŒè¯ã€‚

æˆ‘ä»¬å‘ç°åœ¨æ¨ç†é˜¶æ®µæ”¾å¤§è¾“å…¥å›¾åƒå¯ä»¥æé«˜æ€§èƒ½ã€‚å°½ç®¡æ”¾å¤§çš„å€æ•°å–å†³äºæ•°æ®é›†ï¼Œä½†æˆ‘ä»¬ä¸ç®¡ä»€ä¹ˆä»»åŠ¡ï¼Œåªæ˜¯ä¸ºæ¯ä¸ªç½‘ç»œå›ºå®šäº†ä¸€ä¸ªæ”¾å¤§å€æ•°ã€‚å¯¹äºFlowNetSï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨æ”¾å¤§ï¼Œå¯¹äºFlowNetCï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ”¾å¤§å€æ•°ä¸º1.25ã€‚

ğŸ‘‰**Fine-tuning.**

ä½¿ç”¨çš„æ•°æ®é›†åœ¨ç›®æ ‡ç±»å‹å’Œè¿åŠ¨æ–¹å¼ä¸Šéƒ½å„æœ‰ä¸åŒã€‚ä¸€ä¸ªæ ‡å‡†çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨ç›®æ ‡æ•°æ®é›†ä¸Šè¿›è¡Œfine-tuneã€‚KITTIæ•°æ®é›†æ¯”è¾ƒå°ï¼Œä¸”åªæœ‰ç¨€ç–çš„æ ‡æ³¨ã€‚å› æ­¤æˆ‘ä»¬åœ¨Sintelè®­ç»ƒé›†ä¸Šè¿›è¡Œfine-tuneã€‚æˆ‘ä»¬ä½¿ç”¨çš„å›¾åƒæ¥è‡ªSintelçš„Cleanå’ŒFinalç‰ˆæœ¬ï¼Œä½¿ç”¨è¾ƒä½çš„å­¦ä¹ ç‡$\lambda = 1e-6$ fine-tuneäº†å‡ åƒæ¬¡è¿­ä»£ã€‚ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨éªŒè¯é›†ç¡®å®šæœ€ä½³è¿­ä»£æ¬¡æ•°ï¼Œç„¶ååœ¨è®­ç»ƒé›†ä¸Šfine-tuneç›¸åŒçš„è¿­ä»£æ¬¡æ•°ã€‚æˆ‘ä»¬ç”¨åç¼€â€+ftâ€è¡¨ç¤ºfine-tuneè¿‡çš„ç½‘ç»œã€‚

## 5.2.Results

åœ¨è¡¨2ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†æˆ‘ä»¬çš„æ–¹æ³•å’Œå…¶ä»–ä¸€äº›è¡¨ç°ä¼˜ç§€çš„æ–¹æ³•åœ¨å…¬å¼€æ•°æ®é›†ï¼ˆSintelã€KITTIã€Middleburyï¼‰å’Œé£æ¤…æ•°æ®é›†ä¸Šçš„EPEã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨Sintelä¸Šçš„runtimeã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/10.png)

è¡¨2ä¸­å¸¦æ‹¬å·çš„æ•°æ®æŒ‡çš„æ˜¯è¿™äº›ç½‘ç»œåœ¨å…¶è®­ç»ƒæ•°æ®ä¸Šçš„æµ‹è¯•ç»“æœï¼Œå› æ­¤æ— æ³•ä¸å…¶ä»–ç»“æœç›´æ¥æ¯”è¾ƒã€‚

ä»…åœ¨é£æ¤…è¿™æ ·ä¸€ä¸ªéçœŸå®æ•°æ®é›†ä¸Šè®­ç»ƒå¾—åˆ°çš„ç½‘ç»œï¼Œåœ¨çœŸå®å…‰æµæ•°æ®é›†ä¸Šè¡¨ç°éå¸¸å¥½ï¼Œæ¯”å¦‚å‡»è´¥äº†è‘—åçš„LDOFç®—æ³•ã€‚åœ¨Sintel Finalå’ŒKITTIæ•°æ®é›†ä¸Šï¼Œç»è¿‡åœ¨Sintelä¸Šfine-tuneè¿‡çš„FlowNetçš„è¡¨ç°ä¼˜äºåŒä¸ºå®æ—¶æ£€æµ‹çš„EPPMï¼Œå¹¶ä¸”é€Ÿåº¦æ˜¯EPPMçš„ä¸¤å€ã€‚

ğŸ‘‰**Sintel.**

ä»è¡¨2ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨Sintel Cleanæ•°æ®é›†ä¸Šï¼ŒFlowNetCä¼˜äºFlowNetSï¼Œä½†æ˜¯åœ¨Sintel Finalæ•°æ®é›†ä¸Šï¼Œæƒ…å†µå´åˆšå¥½ç›¸åã€‚åœ¨ä¸€äº›å›°éš¾æ•°æ®é›†ä¸Šï¼ŒFlowNetS+ft+vçš„è¡¨ç°å’ŒDeepFlowä¸ç›¸ä¸Šä¸‹ã€‚ç”±äºEPEæ›´å€¾å‘äºè¿‡åº¦å¹³æ»‘çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬è¿˜è¿›è¡Œäº†å®šæ€§åˆ†æã€‚Fig7å±•ç¤ºäº†æˆ‘ä»¬çš„æ–¹æ³•ï¼ˆæ— fine-tuneï¼‰å’ŒEpicFlowçš„æ¯”è¾ƒã€‚åœ¨Fig7ä¸­ï¼Œæˆ‘ä»¬çš„æ–¹æ³•è™½ç„¶EPEæ›´é«˜ï¼Œä½†æ˜¯åœ¨è§†è§‰ä¸Šï¼Œæˆ‘ä»¬çš„ç»“æœæ˜¯æ›´å¥½çš„ã€‚å…¶ä¸­ä¸€ä¸ªåŸå› å°±æ˜¯æˆ‘ä»¬çš„è¾“å‡ºä¸å¹³æ»‘ã€‚è¿™ä¸€ç‚¹æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å˜åˆ†çš„æ”¹è¿›ï¼ˆè§ç¬¬3éƒ¨åˆ†Refinementï¼‰æ¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/11.png)

ğŸ‘‰**KITTI.**

KITTIåŒ…å«å¼ºæŠ•å½±å˜æ¢ï¼ˆstrong projective transformationsï¼‰ï¼Œè¿™å’Œé£æ¤…æ•°æ®é›†ä¸­ç”¨åˆ°çš„å˜æ¢éå¸¸ä¸åŒã€‚ä½†å³ä½¿è¿™æ ·ï¼Œä»…åœ¨é£æ¤…æ•°æ®é›†ä¸Šè®­ç»ƒå¾—åˆ°çš„ç½‘ç»œçš„æ•ˆæœä¾ç„¶ç›¸å½“çš„ä¸é”™ï¼Œå†åŠ ä¸Šfine-tuneå’Œvariational refinementï¼ˆè§ç¬¬3éƒ¨åˆ†Refinementï¼‰ï¼Œç½‘ç»œæ€§èƒ½å¾—åˆ°è¿›ä¸€æ­¥çš„æå‡ã€‚æœ‰è¶£çš„æ˜¯ï¼Œåœ¨Sintelä¸Šè¿›è¡Œfine-tuneä¹‹åæå‡äº†å…¶åœ¨KITTIæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºç›¸æ¯”é£æ¤…æ•°æ®é›†ï¼ŒSintelæ•°æ®é›†çš„å›¾åƒå’Œè¿åŠ¨æ›´ä¸ºè‡ªç„¶ã€‚åœ¨KITTIæ•°æ®é›†ä¸Šï¼ŒFlowNetSçš„è¡¨ç°ä¼˜äºFlowNetCã€‚

ğŸ‘‰**Flying Chairs.**

æˆ‘ä»¬çš„ç½‘ç»œæ˜¯åœ¨é£æ¤…æ•°æ®é›†ä¸Šè®­ç»ƒçš„ï¼Œå› æ­¤å…¶ç†åº”åœ¨è¯¥æ•°æ®é›†ä¸Šè¡¨ç°æœ€å¥½ã€‚æˆ‘ä»¬ç•™å‡º640å¼ å›¾åƒç”¨äºæµ‹è¯•ã€‚ä¸åŒæ–¹æ³•åœ¨é£æ¤…æ•°æ®é›†ä¸Šçš„é¢„æµ‹ç»“æœè§Fig6ã€‚ä»Fig6ä¸­å¯ä»¥çœ‹å‡ºï¼ŒFlowNetCæ˜¯è¡¨ç°æœ€å¥½çš„ã€‚å¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„å‘ç°ï¼šåªæœ‰åœ¨è¿™ä¸ªæ•°æ®é›†ä¸Šï¼Œvariational refinementä¸èƒ½æå‡æ€§èƒ½ï¼Œåè€Œä½¿å…¶å˜å¾—æ›´ç³Ÿç³•ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/12.png)

ğŸ‘‰**Timings.**

åœ¨è¡¨2ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸åŒæ–¹æ³•å¤„ç†ä¸€å¸§éœ€è¦çš„ç§’æ•°ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè®¸å¤šæ–¹æ³•åªæä¾›äº†åœ¨å•ä¸ªCPUä¸Šçš„runtimeï¼Œè€Œæˆ‘ä»¬çš„æ–¹æ³•åªæä¾›äº†åœ¨GPUä¸Šçš„runtimeã€‚è™½ç„¶æˆ‘ä»¬çš„æ–¹æ³•åœ¨å‡†ç¡®ç‡æ–¹é¢å¯èƒ½ä¸å¦‚ä¸€äº›ä¹‹å‰çš„SOTAæ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ–¹æ³•åœ¨å…·æœ‰å®æ—¶æ€§çš„æ–¹æ³•ä¸­æ˜¯æœ€å¥½çš„ã€‚è®­ç»ƒå’Œæ¨ç†æˆ‘ä»¬éƒ½ä½¿ç”¨äº†NVIDIA GTX Titan GPUã€‚DeepFlowå’ŒEpicFlowåœ¨CPUä¸Šçš„è¿è¡Œæ—¶é—´æ•°æ®æ¥è‡ªè®ºæ–‡â€œJ. Revaud, P. Weinzaepfel, Z. Harchaoui, and C. Schmid. EpicFlow: Edge-Preserving Interpolation of Correspondences for Optical Flow. In CVPR, Boston, United States, June 2015.â€ï¼ŒLDOFçš„runtimeåœ¨å•ä¸ª2.66GHz coreä¸Šæµ‹å¾—ã€‚

## 5.3.Analysis

ğŸ‘‰**Training data.**

ä¸ºäº†éªŒè¯æˆ‘ä»¬çš„æ–¹æ³•æ˜¯ä»é£æ¤…æ•°æ®é›†è·ç›Šè€Œä¸æ˜¯Sintelæ•°æ®é›†ï¼Œæˆ‘ä»¬ä»…åœ¨Sintelæ•°æ®é›†ä¸Šä¹Ÿè®­ç»ƒäº†ä¸€ä¸ªç½‘ç»œï¼Œå¹¶ä¸”é¢„ç•™äº†ä¸€ä¸ªéªŒè¯é›†ç”¨äºæ§åˆ¶æ€§èƒ½ã€‚å¾—ç›Šäºæœ‰æ•ˆçš„data augmentationï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªSintelæ•°æ®é›†ä¹Ÿè¶³ä»¥å¾ˆå¥½çš„å­¦ä¹ å…‰æµã€‚ç›¸æ¯”åœ¨é£æ¤…æ•°æ®é›†ä¸Šè®­ç»ƒå¹¶åœ¨Sintelä¸Šfine-tuneçš„æ¨¡å‹ï¼Œåªåœ¨Sintelä¸Šè®­ç»ƒçš„æ¨¡å‹åœ¨Sintelæ•°æ®é›†ä¸Šçš„EPEè¦é«˜å‡º1ä¸ªåƒç´ å·¦å³ã€‚

é£æ¤…æ•°æ®é›†å·²ç»ç›¸å½“å¤§äº†ï¼Œé‚£ä¹ˆdata augmentationè¿˜æ˜¯å¿…é¡»çš„å—ï¼Ÿç­”æ¡ˆæ˜¯å¿…é¡»çš„ï¼šåœ¨é£æ¤…æ•°æ®é›†ä¸Šè®­ç»ƒï¼Œå¦‚æœä¸ä½¿ç”¨data augmentationï¼Œåœ¨Sintelä¸Šæµ‹è¯•å¾—åˆ°çš„EPEä¼šå‡é«˜2ä¸ªåƒç´ å·¦å³ã€‚

ğŸ‘‰**Comparing the architectures.**

FlowNetSå’ŒFlowNetCçš„æ¯”è¾ƒç»“æœè§è¡¨2ã€‚

é¦–å…ˆï¼ŒFlowNetSåœ¨Sintel Finalä¸Šçš„ç»“æœå¥½äºFlowNetCã€‚ä½†åœ¨é£æ¤…æ•°æ®é›†å’ŒSintel Cleanä¸Šï¼ŒFlowNetCä¼˜äºFlowNetSã€‚å’ŒSintel Finalæ•°æ®é›†ä¸åŒï¼Œé£æ¤…æ•°æ®é›†ä¸åŒ…å«è¿åŠ¨æ¨¡ç³Šæˆ–è€…é›¾ã€‚è¿™äº›ç»“æœå…±åŒè¡¨æ˜ï¼Œå°½ç®¡ä¸¤ä¸ªæ¨¡å‹çš„å‚æ•°é‡å‡ ä¹ç›¸åŒï¼Œä½†FlowNetCæ›´å®¹æ˜“å¯¹è®­ç»ƒæ•°æ®äº§ç”Ÿè¿‡æ‹Ÿåˆã€‚è™½ç„¶ç›®å‰æ¥çœ‹è¿™æ˜¯ä¸€ä¸ªå¼±ç‚¹ï¼Œä½†å¦‚æœæœ‰æ›´å¥½çš„è®­ç»ƒæ•°æ®ï¼Œè¿™ä¹Ÿå¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªä¼˜åŠ¿ã€‚

å…¶æ¬¡ï¼ŒFlowNetCçœ‹èµ·æ¥ä¸æ“…é•¿å¤„ç†å¤§ä½ç§»ã€‚ä»å…¶åœ¨KITTIæ•°æ®é›†ä¸Šçš„è¡¨ç°å¯ä»¥çœ‹å‡ºè¿™ä¸€ç‚¹ï¼Œç›¸åŒçš„ç»“è®ºä¹Ÿå¯ä»¥ä»Sintel Finalæ•°æ®é›†ä¸­è·å¾—ã€‚åœ¨ä½ç§»è‡³å°‘ä¸º40ä¸ªåƒç´ ï¼ˆs40+ï¼‰çš„æ•°æ®ä¸Šï¼ŒFlowNetS+ftçš„EPEä¸º43.3ä¸ªåƒç´ ï¼ŒFlowNetC+ftçš„EPEä¸º48ä¸ªåƒç´ ã€‚ä¸€ä¸ªè§£é‡Šå°±æ˜¯ç›¸å…³æ€§è®¡ç®—æ—¶è®¾ç½®çš„å„ç§èŒƒå›´é™åˆ¶äº†å…¶å¯¹å¤§ä½ç§»çš„é¢„æµ‹èƒ½åŠ›ã€‚å¦‚æœå¢å¤§èŒƒå›´ï¼ˆè®¡ç®—æˆæœ¬ä¹Ÿä¼šç›¸åº”å¢åŠ ï¼‰ï¼Œå¯¹å¤§ä½ç§»çš„é¢„æµ‹èƒ½åŠ›ä¹Ÿä¼šæœ‰æ‰€æå‡ã€‚

# 6.Conclusion

æˆ‘ä»¬è¯æ˜äº†ä½¿ç”¨CNNä»ä¸¤ä¸ªè¾“å…¥å›¾åƒä¸­ç›´æ¥é¢„æµ‹å…‰æµæ˜¯å¯è¡Œçš„ã€‚å¹¶ä¸”è®­ç»ƒæ•°æ®ä¸éœ€è¦æ˜¯çœŸå®çš„ã€‚åœ¨é£æ¤…æ•°æ®é›†è®­ç»ƒå¾—åˆ°çš„æ¨¡å‹è¶³ä»¥é¢„æµ‹è‡ªç„¶åœºæ™¯ä¸­çš„å…‰æµï¼Œå¹¶å–å¾—ä¸é”™çš„æ•ˆæœã€‚è¿™è¯æ˜äº†æˆ‘ä»¬æ‰€æå‡ºçš„ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›ã€‚åœ¨é£æ¤…æµ‹è¯•é›†ä¸Šï¼Œæˆ‘ä»¬çš„æ–¹æ³•ç”šè‡³ä¼˜äºSOTAçš„DeepFlowå’ŒEpicFlowã€‚

# 7.Supplementary Material

## 7.1.Flow field color coding

ä¸ºäº†å¯è§†åŒ–å…‰æµåœºï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Sintelæä¾›çš„å·¥å…·ã€‚ä½¿ç”¨å½©è‰²åƒç´ å€¼æ¥è¡¨ç¤ºæµçš„æ–¹å‘å’Œå¤§å°ã€‚ç™½è‰²è¡¨ç¤ºæ²¡æœ‰è¿åŠ¨ã€‚å…‰æµçš„é¢œè‰²ç¼–ç è§Fig1ï¼šå°†æŸä¸€åƒç´ ç‚¹çš„å…‰æµå‘é‡çš„èµ·ç‚¹ç§»è‡³Fig1æ–¹å—çš„ä¸­å¿ƒä½ç½®ï¼Œå³å¯å¾—åˆ°è¯¥å…‰æµå‘é‡çš„é¢œè‰²ç¼–ç ã€‚å› ä¸ºä¸åŒå›¾åƒå¯¹çš„å…‰æµå¤§å°å·®å¼‚å¾ˆå¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬ç‹¬ç«‹çš„å¯¹æ¯ä¸ªå›¾åƒå¯¹çš„æœ€å¤§é¢œè‰²å¼ºåº¦éƒ½è¿›è¡Œäº†å½’ä¸€åŒ–ï¼Œä½†åœ¨åŒä¸€ä¸ªå›¾åƒå¯¹ä¸Šçš„ä¸åŒæ–¹æ³•é‡‡ç”¨ç›¸åŒçš„æ–¹å¼ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/13.png)

## 7.2.Details of generating Flying Chairs

æ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸‹é£æ¤…æ•°æ®é›†çš„ç”Ÿæˆè¿‡ç¨‹ã€‚èƒŒæ™¯æ˜¯æ¥è‡ªFlickrçš„964å¼ åˆ†è¾¨ç‡ä¸º$1024 \times 768$çš„å›¾åƒã€‚å‰æ™¯æˆ‘ä»¬ä½¿ç”¨äº†809ä¸ªæ¤…å­æ¨¡å‹ï¼Œå…±æœ‰62ä¸ªè§†å›¾ï¼š31ä¸ªæ–¹ä½è§’ï¼ˆazimuth angleï¼‰å’Œ2ä¸ªä»°è§’ï¼ˆelevation angleï¼‰ã€‚æˆ‘ä»¬é€‰å–ä¸€ä¸ªèƒŒæ™¯ï¼Œç„¶åéšæœºæ”¾ç½®ä¸€ç»„æ¤…å­ï¼Œä½œä¸ºå›¾åƒå¯¹ä¸­çš„ç¬¬ä¸€å¼ å›¾åƒã€‚æ¤…å­çš„æ•°é‡åœ¨[16;24]ä¹‹é—´å‡åŒ€å–æ ·ï¼Œå¯¹æ¤…å­çš„ç±»å‹ã€è§†å›¾å’Œä½ç½®ä¹Ÿè¿›è¡Œå‡åŒ€é‡‡æ ·ã€‚æ¤…å­çš„å¤§å°ï¼ˆå³åƒç´ ä¸ªæ•°ï¼‰ä½¿ç”¨å‡å€¼ä¸º200ï¼Œæ ‡å‡†å·®ä¹Ÿä¸º200çš„é«˜æ–¯é‡‡æ ·ï¼ŒåŒºé—´æ§åˆ¶åœ¨50åˆ°640ä¹‹é—´ã€‚

ä¸ºäº†ç”Ÿæˆå›¾åƒå¯¹ä¸­çš„ç¬¬äºŒå¼ å›¾åƒå’Œå…‰æµåœºï¼Œæˆ‘ä»¬å¯¹æ¤…å­å’ŒèƒŒæ™¯æ–½åŠ éšæœºçš„å˜æ¢ã€‚æ¯ä¸€ç§å˜æ¢éƒ½æ˜¯ç¼©æ”¾ã€æ—‹è½¬å’Œå¹³ç§»çš„ç»„åˆã€‚æˆ‘ä»¬éœ€è¦é‡‡æ ·çš„æ˜¯ç¼©æ”¾ç³»æ•°ã€æ—‹è½¬è§’åº¦å’Œå¹³ç§»çŸ¢é‡ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¤§è‡´åŒ¹é…Sintelæ•°æ®é›†çš„ä½ç§»åˆ†å¸ƒï¼Œè§Fig2å·¦ã€‚ç®€å•çš„æŒ‰ç…§é«˜æ–¯åˆ†å¸ƒå¯¹å˜æ¢å‚æ•°è¿›è¡Œé‡‡æ ·ä¼šå¯¼è‡´å¤ªå°‘çš„å°ä½ç§»ï¼Œå› æ­¤æˆ‘ä»¬ä½¿å˜æ¢å‚æ•°çš„åˆ†å¸ƒæ›´å¤šçš„é›†ä¸­åœ¨0é™„è¿‘ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/14.png)

å®é™…æˆ‘ä»¬é‡‡æ ·æ‰€ç”¨çš„åˆ†å¸ƒæ˜¯ä¸¤ä¸ªåˆ†å¸ƒçš„æ··åˆã€‚é‡‡æ ·æ‰€ç”¨çš„åˆ†å¸ƒè§ä¸‹ï¼š

$$\xi = \beta \cdot \max(\min(\text{sign}(\gamma) \cdot \lvert \gamma \rvert ^k,b),a) + (1-\beta) \cdot \mu$$

å…¶ä¸­ï¼Œ$\gamma \sim \mathcal{N}(\mu,\sigma)$æ˜¯å•å˜é‡é«˜æ–¯åˆ†å¸ƒï¼Œ$\beta$æ˜¯ä¼¯åŠªåˆ©éšæœºå˜é‡ï¼ˆè¡¨1ä¸­$p$å°±æ˜¯$\beta$çš„å–å€¼ï¼‰ã€‚å‰©ä½™å‚æ•°çš„å–å€¼è§è¡¨1ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/15.png)

ç»™å®šå˜æ¢å‚æ•°ï¼Œå°±å¯ä»¥ç›´æ¥ç”Ÿæˆå›¾åƒå¯¹ä¸­çš„ç¬¬äºŒå¼ å›¾åƒï¼Œä»¥åŠå…‰æµåœºå’Œocclusion mapã€‚ç„¶åæˆ‘ä»¬å°†å›¾åƒåˆ‡æˆ4ä»½ï¼Œå°±ç›¸å½“äºæ‰©å±•åˆ°4ä¸ªå›¾åƒå¯¹ï¼Œæ¯ä¸ªå›¾è±¡çš„å¤§å°ä¸º$512 \times 384$ã€‚é£æ¤…æ•°æ®é›†çš„ä½ç§»åˆ†å¸ƒè§Fig2å³ã€‚

æˆ‘ä»¬æ²¡æœ‰è¯¦ç»†ç ”ç©¶æ•°æ®é›†å‚æ•°å¯¹FlowNetæ€§èƒ½çš„å½±å“ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œç›´æ¥ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒå¯¹å˜æ¢å‚æ•°è¿›è¡Œé‡‡æ ·ï¼Œè®­ç»ƒå‡ºæ¥çš„ç½‘ç»œä¾ç„¶æœ‰æ•ˆï¼Œä½†æ˜¯ä¸å¦‚ä¸Šè¿°é‡‡æ ·ç­–ç•¥å¾—åˆ°çš„ç½‘ç»œå‡†ç¡®ã€‚

## 7.3.Convolutional Filters

å½“ä»”ç»†è§‚å¯ŸFlowNetçš„filteræ—¶ï¼Œæˆ‘ä»¬å‘ç°ç½‘ç»œä½å±‚çš„filterç»“æ„æ€§æ›´å·®ï¼Œè€Œç½‘ç»œé«˜å±‚çš„filterç»“æ„æ€§æ›´å¥½ã€‚Fig3æ˜¯ç½‘ç»œç¬¬ä¸€å±‚filterçš„å¯è§†åŒ–ã€‚åº”ç”¨äºç›¸å…³å±‚è¾“å‡ºçš„filteråˆ™å…·æœ‰éå¸¸æ˜æ˜¾çš„ç»“æ„ï¼Œè§Fig5ã€‚å¯¹äºä¸åŒå¤§å°å’Œæ–¹å‘çš„å…‰æµé€‰æ‹©ä¸åŒçš„filterã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/16.png)

Fig3æ˜¯FlowNetCorrç¬¬ä¸€å±‚çš„filterã€‚filteræœ‰å¾ˆå¤šå™ªéŸ³ï¼Œä½†ä»èƒ½çœ‹åˆ°ä¸€äº›ç»“æ„ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/17.png)

Fig5æ˜¯åº”ç”¨åœ¨FlowNetCorrç›¸å…³å±‚è¾“å‡ºçš„filterçš„å¯è§†åŒ–ã€‚ä¸€å…±æœ‰256ä¸ªfilterï¼Œå¯¹äºæ¯ä¸ªfilterï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ª$21 \times 21$åƒç´ å¤§å°çš„patchæ¥è¡¨ç¤ºå…¶æƒé‡ï¼Œpatchä¸­çš„æ¯ä¸ªåƒç´ è¡¨ç¤ºä½ç§»çŸ¢é‡ã€‚æ¯ä¸ªpatchçš„ä¸­å¿ƒè¡¨ç¤º0ä½ç§»ã€‚æ¯ä¸ªfilteréƒ½æ”¯æŒä¸€ç§ç‰¹å®šçš„è¿åŠ¨æ¨¡å¼ã€‚

>filterå¯è§†åŒ–è¿™é‡Œä½œè€…å¹¶æ²¡æœ‰æåŠå¯è§†åŒ–çš„æ–¹æ³•ã€‚

## 7.4.Video

åœ¨è¡¥å……è§†é¢‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¸¦æœ‰GeForce GTX 980M GPUçš„ç¬”è®°æœ¬ç”µè„‘æ¼”ç¤ºäº†FlowNetçš„å®æ—¶æ“ä½œã€‚å›¾åƒåˆ†è¾¨ç‡ä¸º$640 \times 480$ã€‚æˆ‘ä»¬å±•ç¤ºäº†FlowNetSimpleå’ŒFlowNetCorråœ¨å®¤å†…å’Œå®¤å¤–åœºæ™¯ä¸­çš„æ£€æµ‹ã€‚è§†é¢‘æ”¾åœ¨äº†[http://goo.gl/YmMOkR](http://goo.gl/YmMOkR)ã€‚ç¤ºä¾‹å¯è§Fig4ã€‚

![](https://xjeffblogimg.oss-cn-beijing.aliyuncs.com/BLOGIMG/BlogImage/AIPapers/FlowNet/18.png)

# 8.åŸæ–‡é“¾æ¥

ğŸ‘½[FlowNetï¼šLearning Optical Flow with Convolutional Networks](https://github.com/x-jeff/AI_Papers/blob/master/FlowNetï¼šLearning%20Optical%20Flow%20with%20Convolutional%20Networks.pdf)

# 9.å‚è€ƒèµ„æ–™
1. [åŸºäºFlowNetçš„å…‰æµä¼°è®¡](https://zhuanlan.zhihu.com/p/124400267)
2. [å…‰æµ \| flownet \| CVPR2015 \| è®ºæ–‡+pytorchä»£ç ](https://blog.csdn.net/qq_34107425/article/details/115731591)
3. [ä»¿å°„å˜æ¢ï¼ˆAffine Transformationï¼‰åŸç†åŠåº”ç”¨ï¼ˆ1ï¼‰](https://blog.csdn.net/u011681952/article/details/98942207)