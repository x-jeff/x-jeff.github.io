---
layout:     post
title:      ã€OpenCVåŸºç¡€ã€‘ç¬¬åå…­è¯¾ï¼šSobelç®—å­
subtitle:   å›¾åƒè¾¹ç¼˜æå–ï¼ŒSobelç®—å­ï¼ŒScharrç®—å­
date:       2021-03-01
author:     x-jeff
header-img: blogimg/20210301.jpg
catalog: true
tags:
    - OpenCV Series
---
>æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œç¦æ­¢è½¬è½½ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# 1.å·ç§¯åº”ç”¨ï¼šå›¾åƒè¾¹ç¼˜æå–

**å›¾åƒçš„è¾¹ç¼˜**æ˜¯åƒç´ å€¼å‘ç”Ÿè·ƒè¿çš„åœ°æ–¹ï¼Œæ˜¯å›¾åƒçš„æ˜¾è‘—ç‰¹å¾ä¹‹ä¸€ï¼Œåœ¨å›¾åƒç‰¹å¾æå–ã€å¯¹è±¡æ£€æµ‹ã€æ¨¡å¼è¯†åˆ«ç­‰æ–¹é¢éƒ½æœ‰é‡è¦çš„ä½œç”¨ã€‚å¦‚ä¸‹å›¾çº¢åœˆå¤„æ‰€ç¤ºï¼Œå³ä¸ºå›¾åƒçš„ä¸€ä¸ªè¾¹ç¼˜ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson16/16x1.png)

å¦‚ä½•æ•æ‰/æå–è¾¹ç¼˜ï¼šå¯¹å›¾åƒæ±‚å®ƒçš„ä¸€é˜¶å¯¼æ•°ã€‚$\delta=f(x)-f(x-1)$ï¼Œ$\delta$è¶Šå¤§ï¼Œè¯´æ˜åƒç´ åœ¨Xæ–¹å‘å˜åŒ–è¶Šå¤§ï¼Œè¾¹ç¼˜ä¿¡å·è¶Šå¼ºã€‚ä¾‹å¦‚ä¸Šå›¾çº¢åœˆå¤„çš„åƒç´ å˜åŒ–ä»¥åŠå…¶ä¸€é˜¶å¯¼æ•°å˜åŒ–ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson16/16x2.png)

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson16/16x3.png)

Sobelç®—å­ä¾¿å¯ç”¨äºå›¾åƒè¾¹ç¼˜æå–ã€‚

# 2.Sobelç®—å­

Sobelç®—å­æ˜¯ç¦»æ•£å¾®åˆ†ç®—å­ï¼ˆdiscrete differentiation operatorï¼‰ï¼Œç”¨æ¥è®¡ç®—å›¾åƒç°åº¦çš„è¿‘ä¼¼æ¢¯åº¦ã€‚

Sobelç®—å­åŠŸèƒ½é›†åˆé«˜æ–¯å¹³æ»‘å’Œå¾®åˆ†æ±‚å¯¼ã€‚å…¶åˆè¢«ç§°ä¸ºä¸€é˜¶å¾®åˆ†ç®—å­ï¼Œæ±‚å¯¼ç®—å­ï¼ˆæ‹‰æ™®æ‹‰æ–¯æ˜¯äºŒé˜¶æ±‚å¯¼ç®—å­ï¼‰ï¼Œåœ¨æ°´å¹³å’Œå‚ç›´ä¸¤ä¸ªæ–¹å‘ä¸Šæ±‚å¯¼ï¼Œå¾—åˆ°å›¾åƒXæ–¹å‘ä¸Yæ–¹å‘æ¢¯åº¦å›¾åƒã€‚

Sobelç®—å­åŒ…å«ä¸¤ç»„$3\times 3$çš„çŸ©é˜µï¼Œåˆ†åˆ«ä¸ºæ¨ªå‘åŠçºµå‘ï¼Œå°†ä¹‹ä¸å›¾åƒä½œå¹³é¢å·ç§¯ï¼Œå³å¯åˆ†åˆ«å¾—å‡ºæ¨ªå‘åŠçºµå‘çš„äº®åº¦å·®åˆ†è¿‘ä¼¼å€¼ã€‚å¦‚æœä»¥$\mathbf {A}$ä»£è¡¨åŸå§‹å›¾åƒï¼Œ$\mathbf  {G_x}$åŠ
$\mathbf  {G_y}$åˆ†åˆ«ä»£è¡¨ç»æ¨ªå‘åŠçºµå‘è¾¹ç¼˜æ£€æµ‹çš„å›¾åƒï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š

$$\mathbf  {G_x}=\begin{bmatrix} -1 & 0 & +1 \\ -2 & 0 & +2 \\ -1 & 0 & +1 \\ \end{bmatrix} * \mathbf A$$

$$\mathbf  {G_y}=\begin{bmatrix} -1 & -2 & -1 \\ 0 & 0 & 0 \\ +1 & +2 & +1 \\ \end{bmatrix} * \mathbf A$$

å›¾åƒçš„æ¯ä¸€ä¸ªåƒç´ çš„æ¨ªå‘åŠçºµå‘æ¢¯åº¦è¿‘ä¼¼å€¼å¯ç”¨ä»¥ä¸‹çš„å…¬å¼ç»“åˆï¼Œæ¥è®¡ç®—æ¢¯åº¦çš„å¤§å°ã€‚

$$\mathbf G = \sqrt {\mathbf {G_x}^2 + \mathbf {G_y}^2 }$$

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†åŠ å¿«è®¡ç®—é€Ÿåº¦ï¼Œä¸Šå¼å¯ç®€åŒ–ä¸ºï¼š

$$\mathbf G =\lvert \mathbf {G_x} \rvert + \lvert \mathbf {G_y} \rvert$$

# 3.Scharrç®—å­

è™½ç„¶Sobelç®—å­å¯ä»¥æœ‰æ•ˆçš„æå–å›¾åƒè¾¹ç¼˜ï¼Œä½†æ˜¯å¯¹å›¾åƒä¸­è¾ƒå¼±çš„è¾¹ç¼˜æå–æ•ˆæœè¾ƒå·®ã€‚å› æ­¤ä¸ºäº†èƒ½å¤Ÿæœ‰æ•ˆçš„æå–å‡ºè¾ƒå¼±çš„è¾¹ç¼˜ï¼Œéœ€è¦å°†åƒç´ å€¼é—´çš„å·®è·å¢å¤§ï¼Œå› æ­¤å¼•å…¥Scharrç®—å­ã€‚Scharrç®—å­æ˜¯å¯¹Sobelç®—å­å·®å¼‚æ€§çš„å¢å¼ºï¼Œå› æ­¤ä¸¤è€…åœ¨æ£€æµ‹å›¾åƒè¾¹ç¼˜çš„åŸç†å’Œä½¿ç”¨æ–¹å¼ä¸Šç›¸åŒã€‚

$$\mathbf  {G_x}=\begin{bmatrix} -3 & 0 & +3 \\ -10 & 0 & +10 \\ -3 & 0 & +3 \\ \end{bmatrix} * \mathbf A$$

$$\mathbf  {G_y}=\begin{bmatrix} -3 & -10 & -3 \\ 0 & 0 & 0 \\ +3 & +10 & +3 \\ \end{bmatrix} * \mathbf A$$

# 4.API

ğŸ‘‰Sobelç®—å­ï¼š

```cpp
cv::Sobel(
	InputArray Src,//è¾“å…¥å›¾åƒ
	OutputArray dst,//è¾“å‡ºå›¾åƒï¼Œå¤§å°ä¸è¾“å…¥å›¾åƒä¸€è‡´
	int depth,//è¾“å‡ºå›¾åƒæ·±åº¦ã€‚å¦‚æœè¾“å…¥å›¾åƒçš„æ·±åº¦æ˜¯CV_8Uçš„ç°åº¦å›¾åƒï¼Œç»è¿‡Sobelç®—å­è®¡ç®—ä¹‹åï¼Œè¾“å‡ºçš„å€¼å¯èƒ½åœ¨0-255çš„èŒƒå›´ä¹‹å¤–ï¼Œæ‰€ä»¥ï¼Œè¾“å‡ºå›¾åƒçš„æ·±åº¦å¯èƒ½è¦æ¯”è¾“å…¥å›¾åƒçš„æ·±åº¦æ›´å¤§ã€‚
	int dx,//Xæ–¹å‘ï¼Œå‡ é˜¶å¯¼æ•°
	int dy,//Yæ–¹å‘ï¼Œå‡ é˜¶å¯¼æ•°
	int ksize,//Sobelç®—å­kernelå¤§å°ï¼Œå¿…é¡»æ˜¯1ï¼Œ3ï¼Œ5ï¼Œ7
	double scale=1,//kernelä¸­çš„å€¼æ”¾å¤§æˆ–ç¼©å°çš„å€æ•°
	double delta=0,//ç®—å‡ºæ¥çš„åƒç´ å€¼å†åŠ ä¸Šdelta
	int borderType=BORDER_DEFAULT
)
```

ğŸ‘‰Scharrç®—å­ï¼š

```cpp
cv::Scharr(
	InputArray Src,//è¾“å…¥å›¾åƒ
	OutputArray dst,//è¾“å‡ºå›¾åƒï¼Œå¤§å°ä¸è¾“å…¥å›¾åƒä¸€è‡´
	int depth,//è¾“å‡ºå›¾åƒæ·±åº¦
	int dx,//Xæ–¹å‘ï¼Œå‡ é˜¶å¯¼æ•°
	int dy,//Yæ–¹å‘ï¼Œå‡ é˜¶å¯¼æ•°
	double scale=1,
	double delta=0,
	int borderType=BORDER_DEFAULT
)
```

`cv::Scharr`å’Œ`cv::Sobel`å‚æ•°åŸºæœ¬ä¸€æ ·ã€‚âš ï¸æ³¨æ„ï¼šä¸¤ä¸ªå‡½æ•°çš„è¾“å‡ºå›¾åƒæ·±åº¦åªèƒ½å¤§äºç­‰äºåŸæ¥çš„å›¾åƒï¼Œä¸èƒ½æ¯”åŸæ¥çš„å›¾åƒå°ï¼

ä¸¤ä¸ªå‡½æ•°çš„ç¬¬å››ä¸ªå‚æ•°`dx`å’Œç¬¬äº”ä¸ªå‚æ•°`dy`æ˜¯æå–Xæ–¹å‘è¾¹ç¼˜è¿˜æ˜¯Yæ–¹å‘è¾¹ç¼˜çš„æ ‡å¿—ï¼Œè¯¥å‡½æ•°è¦æ±‚è¿™ä¸¤ä¸ªå‚æ•°åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°ä¸º1ï¼Œå¹¶ä¸”ä¸èƒ½åŒæ—¶ä¸º0ï¼Œå¦åˆ™å‡½æ•°å°†æ— æ³•æå–å›¾åƒè¾¹ç¼˜ã€‚

æ­¤å¤–ï¼Œ`cv::Scharr`å‡½æ•°é»˜è®¤çš„æ»¤æ³¢å™¨å°ºå¯¸ä¸º$3\times 3$ï¼Œå¹¶ä¸”æ— æ³•ä¿®æ”¹ã€‚

# 5.ä¸åŒå°ºå¯¸çš„Sobelç®—å­

è¾¹ç¼˜æ£€æµ‹ç±»ä¼¼å¾®åˆ†è¿ç®—ï¼Œå…¶æœ¬è´¨å°±æ˜¯æ£€æµ‹å›¾åƒäº®åº¦çš„å˜åŒ–ï¼Œå› æ­¤å™ªå£°å¿…ç„¶ä¼šå¯¹æ£€æµ‹æ•ˆæœäº§ç”Ÿä¸€å®šå½±å“ã€‚ä¸ºäº†é¿å…å™ªå£°çš„å½±å“ï¼Œåœ¨æ„é€ è¾¹ç¼˜æ£€æµ‹ç®—å­æ—¶ä¸ä»…è¦è€ƒè™‘å·®åˆ†å¤„ç†ï¼Œè¿˜å¾—è¦è€ƒè™‘å¹³æ»‘å¤„ç†ã€‚è¿™æ ·æ—¢èƒ½æ»¤é™¤å™ªå£°è¿˜èƒ½æ£€æµ‹è¾¹ç¼˜ã€‚åœ¨åŒæ—¶æœŸçš„è¾¹ç¼˜æ£€æµ‹ç®—æ³•ä¸­ï¼ŒSobelç®—å­è¢«è®¤ä¸ºæ˜¯æœ€å¥½çš„æ£€æµ‹æ¨¡æ¿ï¼Œå®ƒé™¤äº†è€ƒè™‘å·®åˆ†å› ç´ è¿˜å…¼é¡¾äº†æœ€ä¼˜çš„å¹³æ»‘ç³»æ•°ã€‚

æ„é€ Sobelç®—å­çš„ç†è®ºåŸºç¡€æ˜¯å¸•æ–¯å¡ä¸‰è§’å½¢ï¼ˆPascal's triangleï¼‰ï¼š

![](https://github.com/x-jeff/BlogImage/raw/master/OpenCVSeries/Lesson16/16x4.jpg)

å¸•æ–¯å¡ä¸‰è§’å½¢çš„æ„å»ºå…¬å¼ä¸ºï¼ˆ$n$ä¸ºè¡Œæ•°ï¼Œ$k$ä¸ºåˆ—æ•°ï¼‰ï¼š

$$P(k,n)=\frac{n!}{[(n-k)! * k!]},\ if \ k \geqslant 0 \ and \ k \leqslant n$$

$$P(k,n)=0,\ otherwise$$

å‡è®¾Sobelç®—å­çš„å¤§å°ä¸º$w\times w$ã€‚é¦–å…ˆè®¡ç®—ç®—å­çš„å¹³æ»‘ç³»æ•°ï¼š

$$S_k=P(k,w-1)$$

ç„¶åè®¡ç®—ç®—å­çš„å·®åˆ†ç³»æ•°ï¼š

$$D_k=P(k,w-2)-P(k-1,w-2)$$

åˆ™Sobelç®—å­çš„æ¨ªå‘æ¨¡æ¿ï¼š

$$Sobel(x,y)=S_y D_x$$

Sobelç®—å­çš„çºµå‘æ¨¡æ¿ï¼š

$$Sobel(x,y)=S_x D_y$$

ä»¥$5\times 5$çš„Sobelç®—å­çš„è®¡ç®—ä¸ºä¾‹ï¼š

$$S_0=P(0,4)=1$$

$$S_1=P(1,4)=4$$

$$S_2=P(2,4)=6$$

$$S_3=P(3,4)=4$$

$$S_4=P(4,4)=1$$

$$D_0=P(0,3)-P(-1,3)=1-0=1$$

$$D_1=P(1,3)-P(0,3)=3-1=2$$

$$D_2=P(2,3)-P(1,3)=3-3=0$$

$$D_3=P(3,3)-P(2,3)=1-3=-2$$

$$D_4=P(4,3)-P(3,3)=0-1=-1$$

æœ€ç»ˆå¾—åˆ°çš„$5\times 5$çš„Sobelç®—å­ï¼ˆçºµå‘ï¼‰ä¸ºï¼š

$$\begin{bmatrix} 1 & 2 & 0 & -2 & -1 \\ 4 & 8 & 0 & -8 & -4 \\ 6 & 12 & 0 & -12 & -6 \\ 4 & 8 & 0 & -8 & -4 \\ 1 & 2 & 0 & -2 & -1 \\ \end{bmatrix}$$

>æ¨ªå‘ä¸ºå…¶è½¬ç½®ï¼Œä¸å†èµ˜è¿°ã€‚

# 6.ä»£ç åœ°å€

1. [Sobelç®—å­](https://github.com/x-jeff/OpenCV_Code_Demo/tree/master/Demo16)

# 7.å‚è€ƒèµ„æ–™

1. [ç´¢ä¼¯ç®—å­ï¼ˆwikiç™¾ç§‘ï¼‰](https://zh.wikipedia.org/wiki/ç´¢è²çˆ¾ç®—å­)
2. [ã€OpenCV 4å¼€å‘è¯¦è§£ã€‘Scharrç®—å­](https://zhuanlan.zhihu.com/p/101260400)
3. [ä¸åŒå°ºå¯¸çš„Sobelæ¨¡æ¿](https://blog.csdn.net/qingzhuyuxian/article/details/84024667)